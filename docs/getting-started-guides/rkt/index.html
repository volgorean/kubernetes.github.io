

<!Doctype html>
<html id="docs" class="Guides">


<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="canonical" href="http://kubernetes.io/docs/getting-started-guides/rkt/" />
	<link rel="shortcut icon" type="image/png" href="/images/favicon.png">
	<link href='https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href='https://fonts.googleapis.com/css?family=Roboto+Mono' type='text/css'>
	<link rel="stylesheet" href="/css/styles.css"/>
        <link rel="stylesheet" href="/css/jquery-ui.min.css">
        <link rel="stylesheet" href="/css/sweetalert.css">
	<script src="/js/jquery-2.2.0.min.js"></script>
        <script src="/js/jquery-ui.min.js"></script>
	<script src="/js/script.js"></script>
        <script src="/js/sweetalert.min.js"></script>
	<title>Kubernetes - Running Kubernetes with rkt</title>
</head>
<body>
<div id="cellophane" onclick="kub.toggleMenu()"></div>
<header>
	<a href="/" class="logo"></a>
	<div class="nav-buttons" data-auto-burger="primary">
		<a href="/docs/" class="button" id="viewDocs" data-auto-burger-exclude>View Documentation</a>
		<a href="/docs/hellonode/" class="button" id="tryKubernetes" data-auto-burger-exclude>Try Kubernetes</a>
		<button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
	</div>

	<nav id="mainNav">
		<main data-auto-burger="primary">
			<div class="nav-box">
				<h3><a href="/docs/hellonode/">Get Started</a></h3>
				<p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>
			</div>
			<div class="nav-box">
				<h3><a href="/docs/">Documentation</a></h3>
				<p>Learn how to use Kubernetes with the use of walkthroughs, samples, and reference documentation. You can even <a href="/editdocs/" data-auto-burger-exclude>help contribute to the docs</a>!</p>
			</div>
			<div class="nav-box">
				<h3><a href="/community/">Community</a></h3>
				<p>If you need help, you can connect with other Kubernetes users and the Kubernetes authors, attend community events, and watch video presentations from around the web.</p>
			</div>
			<div class="nav-box">
				<h3><a href="http://blog.kubernetes.io">Blog</a></h3>
				<p>Read the latest news for Kubernetes and the containers space in general, and get technical how-tos hot off the presses.</p>
			</div>
		</main>
		<main data-auto-burger="primary">
			<div class="left">
				<h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
				<a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>View On Github</a>
			</div>

			<div class="right">
				<h5 class="github-invite">Explore the community</h5>
				<div class="social">
					<a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
					<a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
					<a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
					<a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
					<a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
					<a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
				</div>
			</div>
			<div class="clear" style="clear: both"></div>
		</main>
	</nav>
</header>


<!--  HERO  -->
<section id="hero" class="light-text">
	<h1>Guides</h1>
	<h5>How to get started, and achieve tasks, using Kubernetes</h5>
	<div id="vendorStrip" class="light-text">
		<ul>
			<li><a href="/docs/" class="YAH">GUIDES</a></li>
			<li><a href="/docs/reference" >REFERENCE</a></li>
			<li><a href="/docs/samples" >SAMPLES</a></li>
			<li><a href="/docs/troubleshooting/" >SUPPORT</a></li>
		</ul>
		<div id="searchBox">
			<input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)">
		</div>
	</div>
</section>

<section id="encyclopedia">
	<div id="docsToc">
        <div class="pi-accordion">
        
    <a class="item" data-title="Guides" href="/docs/"></a>
<div class="item" data-title="Getting Started">
  <div class="container">
    <a class="item" data-title="What is Kubernetes?" href="/docs/whatisk8s/"></a>
    <a class="item" data-title="Downloading or Building Kubernetes" href="/docs/getting-started-guides/binary_release/"></a>
    <a class="item" data-title="Hello World Walkthrough" href="/docs/hellonode/"></a>
    <a class="item" data-title="Online Training Course" href="https://www.udacity.com/course/scalable-microservices-with-kubernetes--ud615" target='_blank'></a>
  </div>
</div>
<div class="item" data-title="Accessing the Cluster">
  <div class="container">
    <a class="item" data-title="Installing and Setting up kubectl" href="/docs/user-guide/prereqs/"></a>
    <a class="item" data-title="Accessing Clusters" href="/docs/user-guide/accessing-the-cluster/"></a>
    <a class="item" data-title="Sharing Cluster Access with kubeconfig" href="/docs/user-guide/sharing-clusters/"></a>
    <a class="item" data-title="Authenticating Across Clusters with kubeconfig" href="/docs/user-guide/kubeconfig-file/"></a>
  </div>
</div>
    <a class="item" data-title="User Guide" href="/docs/user-guide/"></a>
    <a class="item" data-title="Web UI (Dashboard)" href="/docs/user-guide/ui/"></a>
<div class="item" data-title="Workload Deployment and Management">
  <div class="container">
    <a class="item" data-title="Launching, Exposing, and Killing Applications" href="/docs/user-guide/quick-start/"></a>
    <a class="item" data-title="Deploying Applications" href="/docs/user-guide/deploying-applications/"></a>
    <a class="item" data-title="Managing Resources" href="/docs/user-guide/managing-deployments/"></a>
    <a class="item" data-title="Replication Controller Operations" href="/docs/user-guide/replication-controller/operations/"></a>
    <a class="item" data-title="Resizing a Replication Controller" href="/docs/user-guide/resizing-a-replication-controller/"></a>
    <a class="item" data-title="Rolling Updates" href="/docs/user-guide/rolling-updates/"></a>
    <a class="item" data-title="Rolling Update Demo" href="/docs/user-guide/update-demo/"></a>
    <a class="item" data-title="Secrets Walkthrough" href="/docs/user-guide/secrets/walkthrough/"></a>
    <a class="item" data-title="Using ConfigMap" href="/docs/user-guide/configmap/"></a>
    <a class="item" data-title="Horizontal Pod Autoscaling" href="/docs/user-guide/horizontal-pod-autoscaling/walkthrough/"></a>
    <a class="item" data-title="Best Practices for Configuration" href="/docs/user-guide/config-best-practices/"></a>
    <a class="item" data-title="Using kubectl to Manage Resources" href="/docs/user-guide/working-with-resources/"></a>
    <a class="item" data-title="Garbage collection" href="/docs/user-guide/garbage-collector/"></a>
  </div>
</div>
<div class="item" data-title="Batch Jobs">
  <div class="container">
    <a class="item" data-title="Jobs" href="/docs/user-guide/jobs/"></a>
    <a class="item" data-title="Parallel Processing using Expansions" href="/docs/user-guide/jobs/expansions/"></a>
    <a class="item" data-title="Coarse Parallel Processing using a Work Queue" href="/docs/user-guide/jobs/work-queue-1/"></a>
    <a class="item" data-title="Fine Parallel Processing using a Work Queue" href="/docs/user-guide/jobs/work-queue-2/"></a>
  </div>
</div>
<div class="item" data-title="Service Discovery and Load Balancing">
  <div class="container">
    <a class="item" data-title="Connecting Applications with Services" href="/docs/user-guide/connecting-applications/"></a>
    <a class="item" data-title="Service Operations" href="/docs/user-guide/services/operations/"></a>
    <a class="item" data-title="Creating an External Load Balancer" href="/docs/user-guide/load-balancer/"></a>
    <a class="item" data-title="Configuring Your Cloud Provider's Firewalls" href="/docs/user-guide/services-firewalls/"></a>
    <a class="item" data-title="Cross-cluster Service Discovery using Federated Services" href="/docs/user-guide/federation/federated-services/"></a>
  </div>
</div>
<div class="item" data-title="Containers and Pods">
  <div class="container">
    <a class="item" data-title="Running Your First Containers" href="/docs/user-guide/simple-nginx/"></a>
    <a class="item" data-title="Creating Single-Container Pods" href="/docs/user-guide/pods/single-container/"></a>
    <a class="item" data-title="Creating Multi-Container Pods" href="/docs/user-guide/pods/multi-container/"></a>
    <a class="item" data-title="Configuring Containers" href="/docs/user-guide/configuring-containers/"></a>
    <a class="item" data-title="Working with Containers in Production" href="/docs/user-guide/production-pods/"></a>
    <a class="item" data-title="Commands and Capabilities" href="/docs/user-guide/containers/"></a>
    <a class="item" data-title="Using Environment Variables" href="/docs/user-guide/environment-guide/"></a>
    <a class="item" data-title="Managing Compute Resources" href="/docs/user-guide/compute-resources/"></a>
    <a class="item" data-title="The Lifecycle of a Pod" href="/docs/user-guide/pod-states/"></a>
    <a class="item" data-title="Checking Pod Health" href="/docs/user-guide/liveness/"></a>
    <a class="item" data-title="Container Lifecycle Hooks" href="/docs/user-guide/container-environment/"></a>
    <a class="item" data-title="Assigning Pods to Nodes" href="/docs/user-guide/node-selection/"></a>
    <a class="item" data-title="Using the Downward API to Convey Pod Properties" href="/docs/user-guide/downward-api/"></a>
    <a class="item" data-title="Downward API Volumes" href="/docs/user-guide/downward-api/volume"></a>
    <a class="item" data-title="Persistent Volumes Walkthrough" href="/docs/user-guide/persistent-volumes/walkthrough/"></a>
    <a class="item" data-title="Bootstrapping Pet Sets" href="/docs/user-guide/petset/bootstrapping/"></a>
  </div>
</div>
<div class="item" data-title="Monitoring, Logging, and Debugging Containers">
  <div class="container">
    <a class="item" data-title="Resource Usage Monitoring" href="/docs/user-guide/monitoring/"></a>
    <a class="item" data-title="Logging" href="/docs/getting-started-guides/logging/"></a>
    <a class="item" data-title="Logging with Elasticsearch and Kibana" href="/docs/getting-started-guides/logging-elasticsearch/"></a>
    <a class="item" data-title="Running Commands in a Container with kubectl exec" href="/docs/user-guide/getting-into-containers/"></a>
    <a class="item" data-title="Connect with Proxies" href="/docs/user-guide/connecting-to-applications-proxy/"></a>
    <a class="item" data-title="Connect with Port Forwarding" href="/docs/user-guide/connecting-to-applications-port-forward/"></a>
    <a class="item" data-title="Using Explorer to Examine the Runtime Environment" href="https://github.com/kubernetes/kubernetes/tree/release-1.3/examples/explorer" target='_blank'></a>
  </div>
</div>
<div class="item" data-title="Creating a Cluster">
  <div class="container">
    <a class="item" data-title="Picking the Right Solution" href="/docs/getting-started-guides/"></a>
<div class="item" data-title="Running Kubernetes on Your Local Machine">
  <div class="container">
    <a class="item" data-title="Running Kubernetes Locally via Minikube" href="/docs/getting-started-guides/minikube/"></a>
    <a class="item" data-title="Deprecated Alternatives" href="/docs/getting-started-guides/alternatives/"></a>
  </div>
</div>
<div class="item" data-title="Running Kubernetes on Turn-key Cloud Solutions">
  <div class="container">
    <a class="item" data-title="Running Kubernetes on Google Container Engine" href="https://cloud.google.com/container-engine/docs/before-you-begin/" target='_blank'></a>
    <a class="item" data-title="Running Kubernetes on Google Compute Engine" href="/docs/getting-started-guides/gce/"></a>
    <a class="item" data-title="Running Kubernetes on AWS EC2" href="/docs/getting-started-guides/aws/"></a>
    <a class="item" data-title="Running Kubernetes on Azure (Weave-based)" href="/docs/getting-started-guides/coreos/azure/"></a>
    <a class="item" data-title="Running Kubernetes on Azure (Flannel-based)" href="/docs/getting-started-guides/azure/"></a>
    <a class="item" data-title="Running Kubernetes on CenturyLink Cloud" href="/docs/getting-started-guides/clc/"></a>
  </div>
</div>
<div class="item" data-title="Running Kubernetes on Custom Solutions">
  <div class="container">
    <a class="item" data-title="Creating a Custom Cluster from Scratch" href="/docs/getting-started-guides/scratch/"></a>
<div class="item" data-title="Custom Cloud Solutions">
  <div class="container">
    <a class="item" data-title="CoreOS on AWS or GCE" href="/docs/getting-started-guides/coreos/"></a>
    <a class="item" data-title="Ubuntu on AWS or Joyent" href="/docs/getting-started-guides/juju/"></a>
    <a class="item" data-title="CoreOS on Rackspace" href="/docs/getting-started-guides/rackspace/"></a>
  </div>
</div>
<div class="item" data-title="On-Premise VMs">
  <div class="container">
    <a class="item" data-title="CoreOS on Vagrant" href="/docs/getting-started-guides/coreos/"></a>
    <a class="item" data-title="Cloudstack" href="/docs/getting-started-guides/cloudstack/"></a>
    <a class="item" data-title="VMware vSphere" href="/docs/getting-started-guides/vsphere/"></a>
    <a class="item" data-title="VMware Photon Controller" href="/docs/getting-started-guides/photon-controller/"></a>
    <a class="item" data-title="Juju" href="/docs/getting-started-guides/juju/"></a>
    <a class="item" data-title="DCOS" href="/docs/getting-started-guides/dcos/"></a>
    <a class="item" data-title="CoreOS on libvirt" href="/docs/getting-started-guides/libvirt-coreos/"></a>
    <a class="item" data-title="oVirt" href="/docs/getting-started-guides/ovirt/"></a>
    <a class="item" data-title="OpenStack Heat" href="/docs/getting-started-guides/openstack-heat/"></a>
    <a class="item" data-title="CoreOS on Multinode Cluster" href="/docs/getting-started-guides/coreos/coreos_multinode_cluster/"></a>
    <a class="item" data-title="Fedora With Calico Networking" href="/docs/getting-started-guides/fedora/fedora-calico/"></a>
<div class="item" data-title="rkt">
  <div class="container">
    <a class="item" data-title="Running Kubernetes with rkt" href="/docs/getting-started-guides/rkt/"></a>
    <a class="item" data-title="Known Issues when Using rkt" href="/docs/getting-started-guides/rkt/notes/"></a>
  </div>
</div>
    <a class="item" data-title="Kubernetes on Mesos" href="/docs/getting-started-guides/mesos/"></a>
    <a class="item" data-title="Kubernetes on Mesos on Docker" href="/docs/getting-started-guides/mesos-docker/"></a>
  </div>
</div>
<div class="item" data-title="Bare Metal">
  <div class="container">
    <a class="item" data-title="Offline" href="/docs/getting-started-guides/coreos/bare_metal_offline/"></a>
    <a class="item" data-title="Fedora via Ansible" href="/docs/getting-started-guides/fedora/fedora_ansible_config/"></a>
    <a class="item" data-title="Fedora (Single Node)" href="/docs/getting-started-guides/fedora/fedora_manual_config/"></a>
    <a class="item" data-title="Fedora (Multi Node)" href="/docs/getting-started-guides/fedora/flannel_multi_node_cluster/"></a>
    <a class="item" data-title="CentOS" href="/docs/getting-started-guides/centos/centos_manual_config/"></a>
    <a class="item" data-title="CoreOS" href="/docs/getting-started-guides/coreos"></a>
    <a class="item" data-title="CoreOS with Calico" href="/docs/getting-started-guides/coreos/bare_metal_calico/"></a>
    <a class="item" data-title="Ubuntu" href="/docs/getting-started-guides/ubuntu/"></a>
    <a class="item" data-title="Ubuntu Nodes with Calico" href="/docs/getting-started-guides/ubuntu-calico/"></a>
  </div>
</div>
  </div>
</div>
    <a class="item" data-title="Portable Multi-Node Cluster" href="/docs/getting-started-guides/docker-multinode/"></a>
    <a class="item" data-title="Building Large Clusters" href="/docs/admin/cluster-large/"></a>
    <a class="item" data-title="Running in Multiple Zones" href="/docs/admin/multiple-zones/"></a>
    <a class="item" data-title="Building High-Availability Clusters" href="/docs/admin/high-availability/"></a>
  </div>
</div>
<div class="item" data-title="Administering Clusters">
  <div class="container">
    <a class="item" data-title="Admin Guide" href="/docs/admin/"></a>
    <a class="item" data-title="Cluster Management Guide" href="/docs/admin/cluster-management/"></a>
    <a class="item" data-title="Sharing a Cluster with Namespaces" href="/docs/admin/namespaces/"></a>
    <a class="item" data-title="Namespaces Walkthrough" href="/docs/admin/namespaces/walkthrough/"></a>
    <a class="item" data-title="Setting Pod CPU and Memory Limits" href="/docs/admin/limitrange/"></a>
    <a class="item" data-title="Understanding Resource Quotas" href="/docs/admin/resourcequota/"></a>
    <a class="item" data-title="Applying Resource Quotas and Limits" href="/docs/admin/resourcequota/walkthrough/"></a>
    <a class="item" data-title="Kubernetes Components" href="/docs/admin/cluster-components/"></a>
    <a class="item" data-title="Configuring Kubernetes Use of etcd" href="/docs/admin/etcd/"></a>
    <a class="item" data-title="Federating Clusters" href="/docs/admin/federation/"></a>
    <a class="item" data-title="Using Multiple Clusters" href="/docs/admin/multi-cluster/"></a>
    <a class="item" data-title="Changing Cluster Size" href="https://github.com/kubernetes/kubernetes/wiki/User-FAQ#how-do-i-change-the-size-of-my-cluster/" target='_blank'></a>
    <a class="item" data-title="Configuring Multiple Schedulers" href="/docs/admin/multiple-schedulers/"></a>
    <a class="item" data-title="Networking in Kubernetes" href="/docs/admin/networking/"></a>
    <a class="item" data-title="Using DNS Pods and Services" href="/docs/admin/dns/"></a>
    <a class="item" data-title="Setting Up and Configuring DNS" href="https://github.com/kubernetes/kubernetes/tree/release-1.3/examples/cluster-dns" target='_blank'></a>
    <a class="item" data-title="Master <-> Node Communication" href="/docs/admin/master-node-communication/"></a>
    <a class="item" data-title="Network Plugins" href="/docs/admin/network-plugins/"></a>
    <a class="item" data-title="Static Pods" href="/docs/admin/static-pods/"></a>
    <a class="item" data-title="Configuring kubelet Garbage Collection" href="/docs/admin/garbage-collection/"></a>
    <a class="item" data-title="Configuring Out Of Resource Handling" href="/docs/admin/out-of-resource/"></a>
    <a class="item" data-title="Configuring Kubernetes with Salt" href="/docs/admin/salt/"></a>
    <a class="item" data-title="Monitoring Node Health" href="/docs/admin/node-problem/"></a>
  </div>
</div>
        </div> <!-- /pi-accordion -->
		<button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
	</div> <!-- /docsToc -->
	<div id="docsContent">
        <p><a href="/editdocs#docs/getting-started-guides/rkt/index.md" id="editPageButton">Edit This Page</a></p>
    	<h1>Running Kubernetes with rkt</h1>
		<p>This document describes how to run Kubernetes using <a href="https://github.com/coreos/rkt">rkt</a> as the container runtime.</p>

<ul id="markdown-toc">
  <li><a href="#prerequisites" id="markdown-toc-prerequisites">Prerequisites</a></li>
  <li><a href="#pod-networking-in-rktnetes" id="markdown-toc-pod-networking-in-rktnetes">Pod networking in rktnetes</a>    <ul>
      <li><a href="#kubernetes-cni-networking" id="markdown-toc-kubernetes-cni-networking">Kubernetes CNI networking</a>        <ul>
          <li><a href="#kubenet-google-compute-engine-gce-network" id="markdown-toc-kubenet-google-compute-engine-gce-network">kubenet: Google Compute Engine (GCE) network</a></li>
        </ul>
      </li>
      <li><a href="#rkt-contained-network" id="markdown-toc-rkt-contained-network">rkt contained network</a>        <ul>
          <li><a href="#rkt-contained-network-with-bridge" id="markdown-toc-rkt-contained-network-with-bridge">rkt contained network with bridge</a></li>
          <li><a href="#rkt-contained-network-with-flannel" id="markdown-toc-rkt-contained-network-with-flannel">rkt contained network with flannel</a></li>
          <li><a href="#contained-network-caveats" id="markdown-toc-contained-network-caveats">Contained network caveats:</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#running-rktnetes" id="markdown-toc-running-rktnetes">Running rktnetes</a>    <ul>
      <li><a href="#spin-up-a-local-kubernetes-cluster-with-the-rkt-runtime" id="markdown-toc-spin-up-a-local-kubernetes-cluster-with-the-rkt-runtime">Spin up a local Kubernetes cluster with the rkt runtime</a></li>
      <li><a href="#launch-a-rktnetes-cluster-on-google-compute-engine-gce" id="markdown-toc-launch-a-rktnetes-cluster-on-google-compute-engine-gce">Launch a rktnetes cluster on Google Compute Engine (GCE)</a></li>
      <li><a href="#launch-a-rktnetes-cluster-on-aws" id="markdown-toc-launch-a-rktnetes-cluster-on-aws">Launch a rktnetes cluster on AWS</a></li>
      <li><a href="#deploy-apps-to-the-cluster" id="markdown-toc-deploy-apps-to-the-cluster">Deploy apps to the cluster</a></li>
    </ul>
  </li>
  <li><a href="#modular-isolation-with-interchangeable-stage1-images" id="markdown-toc-modular-isolation-with-interchangeable-stage1-images">Modular isolation with interchangeable stage1 images</a>    <ul>
      <li><a href="#notes-on-using-different-stage1-images" id="markdown-toc-notes-on-using-different-stage1-images">Notes on using different stage1 images</a></li>
    </ul>
  </li>
  <li><a href="#known-issues-and-differences-between-rkt-and-docker" id="markdown-toc-known-issues-and-differences-between-rkt-and-docker">Known issues and differences between rkt and Docker</a></li>
  <li><a href="#troubleshooting" id="markdown-toc-troubleshooting">Troubleshooting</a>    <ul>
      <li><a href="#check-rkt-pod-status" id="markdown-toc-check-rkt-pod-status">Check rkt pod status</a></li>
      <li><a href="#check-journal-logs" id="markdown-toc-check-journal-logs">Check journal logs</a>        <ul>
          <li><a href="#log-verbosity" id="markdown-toc-log-verbosity">Log verbosity</a></li>
        </ul>
      </li>
      <li><a href="#check-kubernetes-events-and-logs" id="markdown-toc-check-kubernetes-events-and-logs">Check Kubernetes events and logs.</a></li>
    </ul>
  </li>
</ul>

<h2 id="prerequisites">Prerequisites</h2>

<ul>
  <li>
    <p><a href="http://www.freedesktop.org/wiki/Software/systemd/">Systemd</a> must be installed and enabled. The minimum systemd version required for Kubernetes v1.3 is <code class="highlighter-rouge">219</code>. Systemd is used to monitor and manage the pods on each node.</p>
  </li>
  <li>
    <p><a href="https://coreos.com/rkt/docs/latest/trying-out-rkt.html">Install the latest rkt release</a>. The minimum rkt version required is <a href="https://github.com/coreos/rkt/releases/tag/v1.9.1">v1.9.1</a>. The <a href="https://coreos.com/releases/">CoreOS Linux alpha channel</a> ships with a recent rkt release, and you can easily <a href="https://coreos.com/rkt/docs/latest/install-rkt-in-coreos.html">upgrade rkt on CoreOS</a>, if necessary.</p>
  </li>
  <li>
    <p>The <a href="https://coreos.com/rkt/docs/latest/subcommands/api-service.html">rkt API service</a> must be running on the node.</p>
  </li>
</ul>

<h2 id="pod-networking-in-rktnetes">Pod networking in rktnetes</h2>

<h3 id="kubernetes-cni-networking">Kubernetes CNI networking</h3>

<p>You can configure Kubernetes pod networking with the usual Container Network Interface (CNI) <a href="/docs/admin/network-plugins/">network plugins</a> by setting the kubelet’s <code class="highlighter-rouge">--network-plugin</code> and <code class="highlighter-rouge">--network-plugin-dir</code> options appropriately. Configured in this fashion, the rkt container engine will be unaware of network details, and expects to connect pods to the provided subnet.</p>

<h4 id="kubenet-google-compute-engine-gce-network">kubenet: Google Compute Engine (GCE) network</h4>

<p>The <code class="highlighter-rouge">kubenet</code> plugin can be selected with the kubelet option <code class="highlighter-rouge">--network-plugin=kubenet</code>. This plugin is currently only supported on GCE. When using kubenet, Kubernetes CNI creates and manages the network, and rkt is provided with a subnet from a bridge device connected to the GCE network.</p>

<h3 id="rkt-contained-network">rkt contained network</h3>

<p>Rather than delegating pod networking to Kubernetes, rkt can configure connectivity directly with its own <a href="https://coreos.com/rkt/docs/latest/networking/overview.html#contained-mode"><em>contained network</em></a> on a subnet provided by a bridge device, the flannel SDN, or another CNI plugin. Configured this way, rkt looks in its <a href="https://coreos.com/rkt/docs/latest/configuration.html#command-line-flags">config directories</a>, usually <code class="highlighter-rouge">/etc/rkt/net.d</code>, to discover the CNI configuration and invoke the appropriate plugins to create the pod network.</p>

<h4 id="rkt-contained-network-with-bridge">rkt contained network with bridge</h4>

<p>The <em>contained network</em> is rkt’s default, so you can leave the kubelet’s <code class="highlighter-rouge">--network-plugin</code> option empty to select this network. The contained network can be backed by any CNI plugin. With the <em>contained network</em>, rkt will attempt to join pods to a network named <code class="highlighter-rouge">rkt.kubernetes.io</code>, so this network name must be used for whatever desired CNI configuration.</p>

<p>When using the contained network, create a network configuration file beneath the rkt network config directory that defines how to create this <code class="highlighter-rouge">rkt.kubernetes.io</code> network in your environment. This example sets up a bridge device with the <code class="highlighter-rouge">bridge</code> CNI plugin:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>cat <span class="sh">&lt;&lt;EOF &gt;/etc/rkt/net.d/k8s_network_example.conf
{
  "name": "rkt.kubernetes.io",
  "type": "bridge",
  "bridge": "mybridge",
  "mtu": 1460,
  "addIf": "true",
  "isGateway": true,
  "ipMasq": true,
  "ipam": {
    "type": "host-local",
    "subnet": "10.22.0.0/16",
    "gateway": "10.22.0.1",
    "routes": [
      { "dst": "0.0.0.0/0" }
    ]
  }
}
EOF
</span></code></pre>
</div>

<h4 id="rkt-contained-network-with-flannel">rkt contained network with flannel</h4>

<p>While it is recommended to operate flannel through the Kubernetes CNI support, you can alternatively configure the flannel plugin directly to provide the subnet for rkt’s contained network. An example CNI/flannel config file looks like this:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>cat <span class="sh">&lt;&lt;EOF &gt;/etc/rkt/net.d/k8s_flannel_example.conf
{
    "name": "rkt.kubernetes.io",
    "type": "flannel",
    "delegate": {
        "isDefaultGateway": true
    }
}
EOF
</span></code></pre>
</div>

<p>For more information on flannel configuration, see the <a href="https://github.com/containernetworking/cni/blob/master/Documentation/flannel.md">CNI/flannel README</a>.</p>

<h4 id="contained-network-caveats">Contained network caveats:</h4>

<ul>
  <li>You must create an appropriate CNI configuration file with a network name of <code class="highlighter-rouge">rkt.kubernetes.io</code>.</li>
  <li>The downwards API and environment variable substitution will not contain the pod IP address.</li>
  <li>The <code class="highlighter-rouge">/etc/hosts</code> file will not contain the pod’s own hostname, although <code class="highlighter-rouge">/etc/hostname</code> is populated.</li>
</ul>

<h2 id="running-rktnetes">Running rktnetes</h2>

<h3 id="spin-up-a-local-kubernetes-cluster-with-the-rkt-runtime">Spin up a local Kubernetes cluster with the rkt runtime</h3>

<p>To use rkt as the container runtime in a local Kubernetes cluster, supply the following flags to the kubelet:</p>

<ul>
  <li><code class="highlighter-rouge">--container-runtime=rkt</code> Set the node’s container runtime to rkt.</li>
  <li><code class="highlighter-rouge">--rkt-api-endpoint=HOST:PORT</code> Set the endpoint of the rkt API service. Default: <code class="highlighter-rouge">localhost:15441</code>.</li>
  <li><code class="highlighter-rouge">--rkt-path=PATH_TO_RKT_BINARY</code> Set the path of the rkt binary. Optional. If empty, look for <code class="highlighter-rouge">rkt</code> in <code class="highlighter-rouge">$PATH</code>.</li>
  <li><code class="highlighter-rouge">--rkt-stage1-image=STAGE1</code> Set the name of the stage1 image, e.g. <code class="highlighter-rouge">coreos.com/rkt/stage1-coreos</code>. Optional. If not set, the default Linux kernel software isolation stage1 is used.</li>
</ul>

<p>If you are using the <a href="https://github.com/kubernetes/kubernetes/tree/master/hack/local-up-cluster.sh">hack/local-up-cluster.sh</a> script to launch the cluster, you can edit the environment variables <code class="highlighter-rouge">CONTAINER_RUNTIME</code>, <code class="highlighter-rouge">RKT_PATH</code>, and <code class="highlighter-rouge">RKT_STAGE1_IMAGE</code> to set these flags. <code class="highlighter-rouge">RKT_PATH</code> and <code class="highlighter-rouge">RKT_STAGE1_IMAGE</code> are optional if <code class="highlighter-rouge">rkt</code> is in your $PATH` with appropriate configuration.</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span><span class="nb">export </span><span class="nv">CONTAINER_RUNTIME</span><span class="o">=</span>rkt
<span class="gp">$ </span><span class="nb">export </span><span class="nv">RKT_PATH</span><span class="o">=</span>&lt;rkt_binary_path&gt;
<span class="gp">$ </span><span class="nb">export </span><span class="nv">RKT_STAGE1_IMAGE</span><span class="o">=</span>&lt;stage1-name&gt;
</code></pre>
</div>

<p>Now you can launch the cluster using the <code class="highlighter-rouge">local-up-cluster.sh</code> script:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>hack/local-up-cluster.sh
</code></pre>
</div>

<p>We are also working on getting rkt working as the container runtime in <a href="https://github.com/kubernetes/minikube/issues/168">minikube</a>.</p>

<h3 id="launch-a-rktnetes-cluster-on-google-compute-engine-gce">Launch a rktnetes cluster on Google Compute Engine (GCE)</h3>

<p>This section outlines using the <code class="highlighter-rouge">kube-up</code> script to launch a CoreOS/rkt cluster on GCE.</p>

<p>Specify the OS distribution, the GCE distributor’s master project, and the instance images for the Kubernetes master and nodes. Set the <code class="highlighter-rouge">KUBE_CONTAINER_RUNTIME</code> to <code class="highlighter-rouge">rkt</code>:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span><span class="nb">export </span><span class="nv">KUBE_OS_DISTRIBUTION</span><span class="o">=</span>coreos
<span class="gp">$ </span><span class="nb">export </span><span class="nv">KUBE_GCE_MASTER_PROJECT</span><span class="o">=</span>coreos-cloud
<span class="gp">$ </span><span class="nb">export </span><span class="nv">KUBE_GCE_MASTER_IMAGE</span><span class="o">=</span>&lt;image_id&gt;
<span class="gp">$ </span><span class="nb">export </span><span class="nv">KUBE_GCE_NODE_PROJECT</span><span class="o">=</span>coreos-cloud
<span class="gp">$ </span><span class="nb">export </span><span class="nv">KUBE_GCE_NODE_IMAGE</span><span class="o">=</span>&lt;image_id&gt;
<span class="gp">$ </span><span class="nb">export </span><span class="nv">KUBE_CONTAINER_RUNTIME</span><span class="o">=</span>rkt
</code></pre>
</div>

<p>Optionally, set the version of rkt by setting <code class="highlighter-rouge">KUBE_RKT_VERSION</code>:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span><span class="nb">export </span><span class="nv">KUBE_RKT_VERSION</span><span class="o">=</span>1.9.1
</code></pre>
</div>

<p>Optionally, select an alternative <a href="#modular-isolation-with-interchangeable-stage1-images">stage1 isolator</a> for the container runtime by setting <code class="highlighter-rouge">KUBE_RKT_STAGE1_IMAGE</code>:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span><span class="nb">export </span><span class="nv">KUBE_RKT_STAGE1_IMAGE</span><span class="o">=</span>&lt;stage1-name&gt;
</code></pre>
</div>

<p>Then you can launch the cluster with:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>cluster/kube-up.sh
</code></pre>
</div>

<h3 id="launch-a-rktnetes-cluster-on-aws">Launch a rktnetes cluster on AWS</h3>

<p>The <code class="highlighter-rouge">kube-up</code> script is not yet supported on AWS. Instead, we recommend following the <a href="https://coreos.com/kubernetes/docs/latest/kubernetes-on-aws.html">Kubernetes on AWS guide</a> to launch a CoreOS Kubernetes cluster on AWS, then setting kubelet options as above.</p>

<h3 id="deploy-apps-to-the-cluster">Deploy apps to the cluster</h3>

<p>After creating the cluster, you can start deploying applications. For an introductory example, <a href="/docs/user-guide/simple-nginx">deploy a simple nginx web server</a>. Note that this example did not have to be modified for use with a “rktnetes” cluster. More examples can be found in the <a href="https://github.com/kubernetes/kubernetes/tree/master/examples/">Kubernetes examples directory</a>.</p>

<h2 id="modular-isolation-with-interchangeable-stage1-images">Modular isolation with interchangeable stage1 images</h2>

<p>rkt executes containers in an interchangeable isolation environment. This facility is called the <a href="https://coreos.com/rkt/docs/latest/devel/architecture.html#stage-1"><em>stage1</em> image</a>. There are currently three supported rkt stage1 images:</p>

<ul>
  <li><code class="highlighter-rouge">systemd-nspawn</code> stage1, the default. Isolates running containers with Linux kernel namespaces and cgroups in a manner similar to the default container runtime.</li>
  <li><a href="https://coreos.com/rkt/docs/latest/running-lkvm-stage1.html"><code class="highlighter-rouge">KVM</code> stage1</a>, runs containers inside a KVM hypervisor-managed virtual machine. Experimental in the Kubernetes v1.3 release.</li>
  <li><a href="https://coreos.com/rkt/docs/latest/running-fly-stage1.html"><code class="highlighter-rouge">fly stage1</code></a>, which isolates containers with only a <code class="highlighter-rouge">chroot</code>, giving host-level access to mount and network namespaces for specially-privileged utilities.</li>
</ul>

<p>In addition to the three provided stage1 images, you can <a href="https://coreos.com/rkt/docs/latest/devel/stage1-implementors-guide.html">create your own</a> for specific isolation requirements. If no configuration is set, the <a href="https://coreos.com/rkt/docs/latest/build-configure.html#parameters-for-setting-up-default-stage1-image">default stage1</a> is used. There are two ways to select a different stage1; either per-node, or per-pod:</p>

<ul>
  <li>Set the kubelet’s <code class="highlighter-rouge">--rkt-stage1-image</code> flag, which tells the kubelet the stage1 image to use for every pod on the node. For example, <code class="highlighter-rouge">--rkt-stage1-image=coreos/rkt/stage1-coreos</code> selects the default systemd-nspawn stage1.</li>
  <li>Set the annotation <code class="highlighter-rouge">rkt.alpha.kubernetes.io/stage1-name-override</code> to override the stage1 used to execute a given pod. This allows for mixing different container isolation mechanisms on the same cluster or on the same node. For example, the following (shortened) pod manifest will run its pod with the <code class="highlighter-rouge">fly stage1</code> to give the application – the <code class="highlighter-rouge">kubelet</code> in this case – access to the host’s namespace:</li>
</ul>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="s">kind</span><span class="pi">:</span> <span class="s">Pod</span>
<span class="s">metadata</span><span class="pi">:</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">kubelet</span>
  <span class="s">namespace</span><span class="pi">:</span> <span class="s">kube-system</span>
  <span class="s">labels</span><span class="pi">:</span>
    <span class="s">k8s-app</span><span class="pi">:</span> <span class="s">kubelet</span>
  <span class="s">annotations</span><span class="pi">:</span>
    <span class="s">rkt.alpha.kubernetes.io/stage1-name-override</span><span class="pi">:</span> <span class="s">coreos.com/rkt/stage1-fly</span>
<span class="s">spec</span><span class="pi">:</span>
  <span class="s">containers</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">name</span><span class="pi">:</span> <span class="s">kubelet</span>
    <span class="s">image</span><span class="pi">:</span> <span class="s">quay.io/coreos/hyperkube:v1.3.0-beta.2_coreos.0</span>
    <span class="s">command</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">kubelet</span>
    <span class="pi">-</span> <span class="s">--api-servers=127.0.0.1:8080</span>
    <span class="pi">-</span> <span class="s">--config=/etc/kubernetes/manifests</span>
    <span class="pi">-</span> <span class="s">--allow-privileged</span>
    <span class="pi">-</span> <span class="s">--kubeconfig=/etc/kubernetes/kubeconfig</span>
    <span class="s">securityContext</span><span class="pi">:</span>
      <span class="s">privileged</span><span class="pi">:</span> <span class="s">true</span>
<span class="pi">[</span><span class="nv">...</span><span class="pi">]</span>
</code></pre>
</div>

<h3 id="notes-on-using-different-stage1-images">Notes on using different stage1 images</h3>

<p>Setting the stage1 annotation could potentially give the pod root privileges. Because of this, the <code class="highlighter-rouge">privileged</code> boolean in the pod’s <code class="highlighter-rouge">securityContext</code> must be set to <code class="highlighter-rouge">true</code>.</p>

<p>Use rkt’s <a href="#rkt-contained-network"><em>contained network</em></a> with the KVM stage1, because the CNI plugin driver does not yet fully support the hypervisor-based runtime.</p>

<h2 id="known-issues-and-differences-between-rkt-and-docker">Known issues and differences between rkt and Docker</h2>

<p>rkt and the default node container engine have very different designs, as do rkt’s native ACI and the Docker container image format. Users may experience different behaviors when switching from one container engine to the other. More information can be found <a href="/docs/getting-started-guides/rkt/notes/">in the Kubernetes rkt notes</a>.</p>

<h2 id="troubleshooting">Troubleshooting</h2>

<p>Here are a few tips for troubleshooting Kubernetes with the rkt container engine:</p>

<h3 id="check-rkt-pod-status">Check rkt pod status</h3>

<p>To check the status of running pods, use the rkt subcommands <a href="https://coreos.com/rkt/docs/latest/subcommands/list.html"><code class="highlighter-rouge">rkt list</code></a>, <a href="https://coreos.com/rkt/docs/latest/subcommands/status.html"><code class="highlighter-rouge">rkt status</code></a>, and <a href="https://coreos.com/rkt/docs/latest/subcommands/image.html#rkt-image-list"><code class="highlighter-rouge">rkt image list</code></a>. See the <a href="https://coreos.com/rkt/docs/latest/commands.html">rkt commands documentation</a> for more information about rkt subcommands.</p>

<h3 id="check-journal-logs">Check journal logs</h3>

<p>Check a pod’s log using <code class="highlighter-rouge">journalctl</code> on the node. Pods are managed and named as systemd units. The pod’s unit name is formed by concatenating a <code class="highlighter-rouge">k8s_</code> prefix with the pod UUID, in a format like <code class="highlighter-rouge">k8s_${RKT_UUID}</code>. Find the pod’s UUID with <code class="highlighter-rouge">rkt list</code> to assemble its service name, then ask journalctl for the logs:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo journalctl -u k8s_ad623346
</code></pre>
</div>

<h4 id="log-verbosity">Log verbosity</h4>

<p>By default, the log verbosity level is 2. In order to see more log messages related to rkt, set this level to 4 or above. For a local cluster, set the environment variable: <code class="highlighter-rouge">LOG_LEVEL=4</code>.</p>

<h3 id="check-kubernetes-events-and-logs">Check Kubernetes events and logs.</h3>

<p>Kubernetes provides various tools for troubleshooting and examination. More information can be found <a href="/docs/user-guide/application-troubleshooting">in the app troubleshooting guide</a>.</p>

        <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/getting-started-guides/rkt/index.md?pixel" alt="Analytics" /></a>
        <div id="pd_rating_holder_8345992"></div>
		<script type="text/javascript">
	        PDRTJS_settings_8345992 = {
		        "id" : "8345992",
		        "unique_id" : "/docs/getting-started-guides/rkt/",
		        "title" : "Running Kubernetes with rkt",
		        "permalink" : "http://kubernetes.github.io/docs/getting-started-guides/rkt/"
	        };
	        (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
        </script>
	</div>
</section>

<footer>
	<main class="light-text">
		<nav>
			<a href="/docs/hellonode/">Get Started</a>
			<a href="/docs/">Documentation</a>
			<a href="http://blog.kubernetes.io/">Blog</a>
			<a href="/community/">Community</a>
		</nav>
		<div class="social">
			<div>
				<a href="https://twitter.com/kubernetesio" class="twitter"><span>twitter</span></a>
				<a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
				<a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
			</div>
			<div>
				<a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
				<a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
				<a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
			</div>
			<div>
				<span>I wish this page</span>
				<input type="text" id="wishField" name="wishField" placeholder="enter your wish">
			</div>
		</div>
		<div id="miceType" class="center">&copy; 2016 Kubernetes</div>
	</main>
</footer>


<button class="flyout-button" onclick="kub.toggleToc()"></button>

<style>
	.cse .gsc-control-cse, .gsc-control-cse, {
		padding: 0;
	}
	.gsc-control-cse table, .gsc-control-cse-en table {
		margin:0px !important;
	}

	.gsc-above-wrapper-area {
		border-bottom: 0;
	}
</style>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36037335-10', 'auto');
  ga('send', 'pageview');
</script>
<!-- Commenting out AnswerDash for now; we need to work on our list of questions/answers/design first
<!-- Start of AnswerDash script <script>var AnswerDash;!function(e,t,n,s,a){if(!t.getElementById(s)){var i,r=t.createElement(n),c=t.getElementsByTagName(n)[0];e[a]||(i=e[a]=function(){i.__oninit.push(arguments)},i.__oninit=[]),r.type="text/javascript",r.async=!0,r.src="https://p1.answerdash.com/answerdash.min.js?siteid=756",r.setAttribute("id",s),c.parentNode.insertBefore(r,c)}}(window,document,"script","answerdash-script","AnswerDash");</script> <!-- End of AnswerDash script -->
</body>
</html>
