

<!Doctype html>
<html id="docs" class="Guides">


<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="canonical" href="http://kubernetes.io/docs/getting-started-guides/ubuntu-calico/" />
	<link rel="shortcut icon" type="image/png" href="/images/favicon.png">
	<link href='https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href='https://fonts.googleapis.com/css?family=Roboto+Mono' type='text/css'>
	<link rel="stylesheet" href="/css/styles.css"/>
        <link rel="stylesheet" href="/css/jquery-ui.min.css">
        <link rel="stylesheet" href="/css/sweetalert.css">
	<script src="/js/jquery-2.2.0.min.js"></script>
        <script src="/js/jquery-ui.min.js"></script>
	<script src="/js/script.js"></script>
        <script src="/js/sweetalert.min.js"></script>
	<title>Kubernetes - Ubuntu Nodes with Calico</title>
</head>
<body>
<div id="cellophane" onclick="kub.toggleMenu()"></div>
<header>
	<a href="/" class="logo"></a>
	<div class="nav-buttons" data-auto-burger="primary">
		<a href="/docs/" class="button" id="viewDocs" data-auto-burger-exclude>View Documentation</a>
		<a href="/docs/hellonode/" class="button" id="tryKubernetes" data-auto-burger-exclude>Try Kubernetes</a>
		<button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
	</div>

	<nav id="mainNav">
		<main data-auto-burger="primary">
			<div class="nav-box">
				<h3><a href="/docs/hellonode/">Get Started</a></h3>
				<p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>
			</div>
			<div class="nav-box">
				<h3><a href="/docs/">Documentation</a></h3>
				<p>Learn how to use Kubernetes with the use of walkthroughs, samples, and reference documentation. You can even <a href="/editdocs/" data-auto-burger-exclude>help contribute to the docs</a>!</p>
			</div>
			<div class="nav-box">
				<h3><a href="/community/">Community</a></h3>
				<p>If you need help, you can connect with other Kubernetes users and the Kubernetes authors, attend community events, and watch video presentations from around the web.</p>
			</div>
			<div class="nav-box">
				<h3><a href="http://blog.kubernetes.io">Blog</a></h3>
				<p>Read the latest news for Kubernetes and the containers space in general, and get technical how-tos hot off the presses.</p>
			</div>
		</main>
		<main data-auto-burger="primary">
			<div class="left">
				<h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
				<a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>View On Github</a>
			</div>

			<div class="right">
				<h5 class="github-invite">Explore the community</h5>
				<div class="social">
					<a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
					<a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
					<a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
					<a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
					<a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
					<a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
				</div>
			</div>
			<div class="clear" style="clear: both"></div>
		</main>
	</nav>
</header>


<!--  HERO  -->
<section id="hero" class="light-text">
	<h1>Guides</h1>
	<h5>How to get started, and achieve tasks, using Kubernetes</h5>
	<div id="vendorStrip" class="light-text">
		<ul>
			<li><a href="/docs/" class="YAH">GUIDES</a></li>
			<li><a href="/docs/reference" >REFERENCE</a></li>
			<li><a href="/docs/samples" >SAMPLES</a></li>
			<li><a href="/docs/troubleshooting/" >SUPPORT</a></li>
		</ul>
		<div id="searchBox">
			<input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)">
		</div>
	</div>
</section>

<section id="encyclopedia">
	<div id="docsToc">
        <div class="pi-accordion">
        
    <a class="item" data-title="Guides" href="/docs/"></a>
<div class="item" data-title="Getting Started">
  <div class="container">
    <a class="item" data-title="What is Kubernetes?" href="/docs/whatisk8s/"></a>
    <a class="item" data-title="Downloading or Building Kubernetes" href="/docs/getting-started-guides/binary_release/"></a>
    <a class="item" data-title="Hello World Walkthrough" href="/docs/hellonode/"></a>
    <a class="item" data-title="Online Training Course" href="https://www.udacity.com/course/scalable-microservices-with-kubernetes--ud615" target='_blank'></a>
  </div>
</div>
<div class="item" data-title="Accessing the Cluster">
  <div class="container">
    <a class="item" data-title="Installing and Setting up kubectl" href="/docs/user-guide/prereqs/"></a>
    <a class="item" data-title="Accessing Clusters" href="/docs/user-guide/accessing-the-cluster/"></a>
    <a class="item" data-title="Sharing Cluster Access with kubeconfig" href="/docs/user-guide/sharing-clusters/"></a>
    <a class="item" data-title="Authenticating Across Clusters with kubeconfig" href="/docs/user-guide/kubeconfig-file/"></a>
  </div>
</div>
    <a class="item" data-title="User Guide" href="/docs/user-guide/"></a>
    <a class="item" data-title="Web UI (Dashboard)" href="/docs/user-guide/ui/"></a>
<div class="item" data-title="Workload Deployment and Management">
  <div class="container">
    <a class="item" data-title="Launching, Exposing, and Killing Applications" href="/docs/user-guide/quick-start/"></a>
    <a class="item" data-title="Deploying Applications" href="/docs/user-guide/deploying-applications/"></a>
    <a class="item" data-title="Managing Resources" href="/docs/user-guide/managing-deployments/"></a>
    <a class="item" data-title="Replication Controller Operations" href="/docs/user-guide/replication-controller/operations/"></a>
    <a class="item" data-title="Resizing a Replication Controller" href="/docs/user-guide/resizing-a-replication-controller/"></a>
    <a class="item" data-title="Rolling Updates" href="/docs/user-guide/rolling-updates/"></a>
    <a class="item" data-title="Rolling Update Demo" href="/docs/user-guide/update-demo/"></a>
    <a class="item" data-title="Secrets Walkthrough" href="/docs/user-guide/secrets/walkthrough/"></a>
    <a class="item" data-title="Using ConfigMap" href="/docs/user-guide/configmap/"></a>
    <a class="item" data-title="Horizontal Pod Autoscaling" href="/docs/user-guide/horizontal-pod-autoscaling/walkthrough/"></a>
    <a class="item" data-title="Best Practices for Configuration" href="/docs/user-guide/config-best-practices/"></a>
    <a class="item" data-title="Using kubectl to Manage Resources" href="/docs/user-guide/working-with-resources/"></a>
    <a class="item" data-title="Garbage collection" href="/docs/user-guide/garbage-collector/"></a>
  </div>
</div>
<div class="item" data-title="Batch Jobs">
  <div class="container">
    <a class="item" data-title="Jobs" href="/docs/user-guide/jobs/"></a>
    <a class="item" data-title="Parallel Processing using Expansions" href="/docs/user-guide/jobs/expansions/"></a>
    <a class="item" data-title="Coarse Parallel Processing using a Work Queue" href="/docs/user-guide/jobs/work-queue-1/"></a>
    <a class="item" data-title="Fine Parallel Processing using a Work Queue" href="/docs/user-guide/jobs/work-queue-2/"></a>
  </div>
</div>
<div class="item" data-title="Service Discovery and Load Balancing">
  <div class="container">
    <a class="item" data-title="Connecting Applications with Services" href="/docs/user-guide/connecting-applications/"></a>
    <a class="item" data-title="Service Operations" href="/docs/user-guide/services/operations/"></a>
    <a class="item" data-title="Creating an External Load Balancer" href="/docs/user-guide/load-balancer/"></a>
    <a class="item" data-title="Configuring Your Cloud Provider's Firewalls" href="/docs/user-guide/services-firewalls/"></a>
    <a class="item" data-title="Cross-cluster Service Discovery using Federated Services" href="/docs/user-guide/federation/federated-services/"></a>
  </div>
</div>
<div class="item" data-title="Containers and Pods">
  <div class="container">
    <a class="item" data-title="Running Your First Containers" href="/docs/user-guide/simple-nginx/"></a>
    <a class="item" data-title="Creating Single-Container Pods" href="/docs/user-guide/pods/single-container/"></a>
    <a class="item" data-title="Creating Multi-Container Pods" href="/docs/user-guide/pods/multi-container/"></a>
    <a class="item" data-title="Configuring Containers" href="/docs/user-guide/configuring-containers/"></a>
    <a class="item" data-title="Working with Containers in Production" href="/docs/user-guide/production-pods/"></a>
    <a class="item" data-title="Commands and Capabilities" href="/docs/user-guide/containers/"></a>
    <a class="item" data-title="Using Environment Variables" href="/docs/user-guide/environment-guide/"></a>
    <a class="item" data-title="Managing Compute Resources" href="/docs/user-guide/compute-resources/"></a>
    <a class="item" data-title="The Lifecycle of a Pod" href="/docs/user-guide/pod-states/"></a>
    <a class="item" data-title="Checking Pod Health" href="/docs/user-guide/liveness/"></a>
    <a class="item" data-title="Container Lifecycle Hooks" href="/docs/user-guide/container-environment/"></a>
    <a class="item" data-title="Assigning Pods to Nodes" href="/docs/user-guide/node-selection/"></a>
    <a class="item" data-title="Using the Downward API to Convey Pod Properties" href="/docs/user-guide/downward-api/"></a>
    <a class="item" data-title="Downward API Volumes" href="/docs/user-guide/downward-api/volume"></a>
    <a class="item" data-title="Persistent Volumes Walkthrough" href="/docs/user-guide/persistent-volumes/walkthrough/"></a>
    <a class="item" data-title="Bootstrapping Pet Sets" href="/docs/user-guide/petset/bootstrapping/"></a>
  </div>
</div>
<div class="item" data-title="Monitoring, Logging, and Debugging Containers">
  <div class="container">
    <a class="item" data-title="Resource Usage Monitoring" href="/docs/user-guide/monitoring/"></a>
    <a class="item" data-title="Logging" href="/docs/getting-started-guides/logging/"></a>
    <a class="item" data-title="Logging with Elasticsearch and Kibana" href="/docs/getting-started-guides/logging-elasticsearch/"></a>
    <a class="item" data-title="Running Commands in a Container with kubectl exec" href="/docs/user-guide/getting-into-containers/"></a>
    <a class="item" data-title="Connect with Proxies" href="/docs/user-guide/connecting-to-applications-proxy/"></a>
    <a class="item" data-title="Connect with Port Forwarding" href="/docs/user-guide/connecting-to-applications-port-forward/"></a>
    <a class="item" data-title="Using Explorer to Examine the Runtime Environment" href="https://github.com/kubernetes/kubernetes/tree/release-1.3/examples/explorer" target='_blank'></a>
  </div>
</div>
<div class="item" data-title="Creating a Cluster">
  <div class="container">
    <a class="item" data-title="Picking the Right Solution" href="/docs/getting-started-guides/"></a>
<div class="item" data-title="Running Kubernetes on Your Local Machine">
  <div class="container">
    <a class="item" data-title="Running Kubernetes Locally via Minikube" href="/docs/getting-started-guides/minikube/"></a>
    <a class="item" data-title="Deprecated Alternatives" href="/docs/getting-started-guides/alternatives/"></a>
  </div>
</div>
<div class="item" data-title="Running Kubernetes on Turn-key Cloud Solutions">
  <div class="container">
    <a class="item" data-title="Running Kubernetes on Google Container Engine" href="https://cloud.google.com/container-engine/docs/before-you-begin/" target='_blank'></a>
    <a class="item" data-title="Running Kubernetes on Google Compute Engine" href="/docs/getting-started-guides/gce/"></a>
    <a class="item" data-title="Running Kubernetes on AWS EC2" href="/docs/getting-started-guides/aws/"></a>
    <a class="item" data-title="Running Kubernetes on Azure (Weave-based)" href="/docs/getting-started-guides/coreos/azure/"></a>
    <a class="item" data-title="Running Kubernetes on Azure (Flannel-based)" href="/docs/getting-started-guides/azure/"></a>
    <a class="item" data-title="Running Kubernetes on CenturyLink Cloud" href="/docs/getting-started-guides/clc/"></a>
  </div>
</div>
<div class="item" data-title="Running Kubernetes on Custom Solutions">
  <div class="container">
    <a class="item" data-title="Creating a Custom Cluster from Scratch" href="/docs/getting-started-guides/scratch/"></a>
<div class="item" data-title="Custom Cloud Solutions">
  <div class="container">
    <a class="item" data-title="CoreOS on AWS or GCE" href="/docs/getting-started-guides/coreos/"></a>
    <a class="item" data-title="Ubuntu on AWS or Joyent" href="/docs/getting-started-guides/juju/"></a>
    <a class="item" data-title="CoreOS on Rackspace" href="/docs/getting-started-guides/rackspace/"></a>
  </div>
</div>
<div class="item" data-title="On-Premise VMs">
  <div class="container">
    <a class="item" data-title="CoreOS on Vagrant" href="/docs/getting-started-guides/coreos/"></a>
    <a class="item" data-title="Cloudstack" href="/docs/getting-started-guides/cloudstack/"></a>
    <a class="item" data-title="VMware vSphere" href="/docs/getting-started-guides/vsphere/"></a>
    <a class="item" data-title="VMware Photon Controller" href="/docs/getting-started-guides/photon-controller/"></a>
    <a class="item" data-title="Juju" href="/docs/getting-started-guides/juju/"></a>
    <a class="item" data-title="DCOS" href="/docs/getting-started-guides/dcos/"></a>
    <a class="item" data-title="CoreOS on libvirt" href="/docs/getting-started-guides/libvirt-coreos/"></a>
    <a class="item" data-title="oVirt" href="/docs/getting-started-guides/ovirt/"></a>
    <a class="item" data-title="OpenStack Heat" href="/docs/getting-started-guides/openstack-heat/"></a>
    <a class="item" data-title="CoreOS on Multinode Cluster" href="/docs/getting-started-guides/coreos/coreos_multinode_cluster/"></a>
    <a class="item" data-title="Fedora With Calico Networking" href="/docs/getting-started-guides/fedora/fedora-calico/"></a>
<div class="item" data-title="rkt">
  <div class="container">
    <a class="item" data-title="Running Kubernetes with rkt" href="/docs/getting-started-guides/rkt/"></a>
    <a class="item" data-title="Known Issues when Using rkt" href="/docs/getting-started-guides/rkt/notes/"></a>
  </div>
</div>
    <a class="item" data-title="Kubernetes on Mesos" href="/docs/getting-started-guides/mesos/"></a>
    <a class="item" data-title="Kubernetes on Mesos on Docker" href="/docs/getting-started-guides/mesos-docker/"></a>
  </div>
</div>
<div class="item" data-title="Bare Metal">
  <div class="container">
    <a class="item" data-title="Offline" href="/docs/getting-started-guides/coreos/bare_metal_offline/"></a>
    <a class="item" data-title="Fedora via Ansible" href="/docs/getting-started-guides/fedora/fedora_ansible_config/"></a>
    <a class="item" data-title="Fedora (Single Node)" href="/docs/getting-started-guides/fedora/fedora_manual_config/"></a>
    <a class="item" data-title="Fedora (Multi Node)" href="/docs/getting-started-guides/fedora/flannel_multi_node_cluster/"></a>
    <a class="item" data-title="CentOS" href="/docs/getting-started-guides/centos/centos_manual_config/"></a>
    <a class="item" data-title="CoreOS" href="/docs/getting-started-guides/coreos"></a>
    <a class="item" data-title="CoreOS with Calico" href="/docs/getting-started-guides/coreos/bare_metal_calico/"></a>
    <a class="item" data-title="Ubuntu" href="/docs/getting-started-guides/ubuntu/"></a>
    <a class="item" data-title="Ubuntu Nodes with Calico" href="/docs/getting-started-guides/ubuntu-calico/"></a>
  </div>
</div>
  </div>
</div>
    <a class="item" data-title="Portable Multi-Node Cluster" href="/docs/getting-started-guides/docker-multinode/"></a>
    <a class="item" data-title="Building Large Clusters" href="/docs/admin/cluster-large/"></a>
    <a class="item" data-title="Running in Multiple Zones" href="/docs/admin/multiple-zones/"></a>
    <a class="item" data-title="Building High-Availability Clusters" href="/docs/admin/high-availability/"></a>
  </div>
</div>
<div class="item" data-title="Administering Clusters">
  <div class="container">
    <a class="item" data-title="Admin Guide" href="/docs/admin/"></a>
    <a class="item" data-title="Cluster Management Guide" href="/docs/admin/cluster-management/"></a>
    <a class="item" data-title="Sharing a Cluster with Namespaces" href="/docs/admin/namespaces/"></a>
    <a class="item" data-title="Namespaces Walkthrough" href="/docs/admin/namespaces/walkthrough/"></a>
    <a class="item" data-title="Setting Pod CPU and Memory Limits" href="/docs/admin/limitrange/"></a>
    <a class="item" data-title="Understanding Resource Quotas" href="/docs/admin/resourcequota/"></a>
    <a class="item" data-title="Applying Resource Quotas and Limits" href="/docs/admin/resourcequota/walkthrough/"></a>
    <a class="item" data-title="Kubernetes Components" href="/docs/admin/cluster-components/"></a>
    <a class="item" data-title="Configuring Kubernetes Use of etcd" href="/docs/admin/etcd/"></a>
    <a class="item" data-title="Federating Clusters" href="/docs/admin/federation/"></a>
    <a class="item" data-title="Using Multiple Clusters" href="/docs/admin/multi-cluster/"></a>
    <a class="item" data-title="Changing Cluster Size" href="https://github.com/kubernetes/kubernetes/wiki/User-FAQ#how-do-i-change-the-size-of-my-cluster/" target='_blank'></a>
    <a class="item" data-title="Configuring Multiple Schedulers" href="/docs/admin/multiple-schedulers/"></a>
    <a class="item" data-title="Networking in Kubernetes" href="/docs/admin/networking/"></a>
    <a class="item" data-title="Using DNS Pods and Services" href="/docs/admin/dns/"></a>
    <a class="item" data-title="Setting Up and Configuring DNS" href="https://github.com/kubernetes/kubernetes/tree/release-1.3/examples/cluster-dns" target='_blank'></a>
    <a class="item" data-title="Master <-> Node Communication" href="/docs/admin/master-node-communication/"></a>
    <a class="item" data-title="Network Plugins" href="/docs/admin/network-plugins/"></a>
    <a class="item" data-title="Static Pods" href="/docs/admin/static-pods/"></a>
    <a class="item" data-title="Configuring kubelet Garbage Collection" href="/docs/admin/garbage-collection/"></a>
    <a class="item" data-title="Configuring Out Of Resource Handling" href="/docs/admin/out-of-resource/"></a>
    <a class="item" data-title="Configuring Kubernetes with Salt" href="/docs/admin/salt/"></a>
    <a class="item" data-title="Monitoring Node Health" href="/docs/admin/node-problem/"></a>
  </div>
</div>
        </div> <!-- /pi-accordion -->
		<button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
	</div> <!-- /docsToc -->
	<div id="docsContent">
        <p><a href="/editdocs#docs/getting-started-guides/ubuntu-calico.md" id="editPageButton">Edit This Page</a></p>
    	<h1>Ubuntu Nodes with Calico</h1>
		<p>This document describes how to deploy Kubernetes with Calico networking from scratch on <em>bare metal</em> Ubuntu. For more information on Project Calico, visit <a href="http://projectcalico.org">projectcalico.org</a> and the <a href="https://github.com/projectcalico/calico-containers">calico-containers repository</a>.</p>

<p>To install Calico on an existing Kubernetes cluster, or for more information on deploying Calico with Kubernetes in a number of other environments take a look at our supported <a href="https://github.com/projectcalico/calico-containers/tree/master/docs/cni/kubernetes">deployment guides</a>.</p>

<p>This guide will set up a simple Kubernetes cluster with a single Kubernetes master and two Kubernetes nodes.  We’ll run Calico’s etcd cluster on the master and install the Calico daemon on the master and nodes.</p>

<h2 id="prerequisites-and-assumptions">Prerequisites and Assumptions</h2>

<ul>
  <li>This guide uses <code class="highlighter-rouge">systemd</code> for process management. Ubuntu 15.04 supports systemd natively as do a number of other Linux distributions.</li>
  <li>All machines should have Docker &gt;= 1.7.0 installed.
    <ul>
      <li>To install Docker on Ubuntu, follow <a href="https://docs.docker.com/installation/ubuntulinux/">these instructions</a></li>
    </ul>
  </li>
  <li>All machines should have connectivity to each other and the internet.</li>
  <li>This guide assumes a DHCP server on your network to assign server IPs.</li>
  <li>This guide uses <code class="highlighter-rouge">192.168.0.0/16</code> as the subnet from which pod IP addresses are assigned.  If this overlaps with your host subnet, you will need to configure Calico to use a different <a href="https://github.com/projectcalico/calico-containers/blob/master/docs/calicoctl/pool.md#calicoctl-pool-commands">IP pool</a>.</li>
  <li>This guide assumes that none of the hosts have been configured with any Kubernetes or Calico software.</li>
  <li>This guide will set up a secure, TLS-authenticated API server.</li>
</ul>

<h2 id="set-up-the-master">Set up the master</h2>

<h3 id="configure-tls">Configure TLS</h3>

<p>The master requires the root CA public key, <code class="highlighter-rouge">ca.pem</code>; the apiserver certificate, <code class="highlighter-rouge">apiserver.pem</code> and its private key, <code class="highlighter-rouge">apiserver-key.pem</code>.</p>

<ol>
  <li>
    <p>Create the file <code class="highlighter-rouge">openssl.cnf</code> with the following contents.</p>

    <div class="language-conf highlighter-rouge"><pre class="highlight"><code>[<span class="n">req</span>]
<span class="n">req_extensions</span> = <span class="n">v3_req</span>
<span class="n">distinguished_name</span> = <span class="n">req_distinguished_name</span>
[<span class="n">req_distinguished_name</span>]
[ <span class="n">v3_req</span> ]
<span class="n">basicConstraints</span> = <span class="n">CA</span>:<span class="n">FALSE</span>
<span class="n">keyUsage</span> = <span class="n">nonRepudiation</span>, <span class="n">digitalSignature</span>, <span class="n">keyEncipherment</span>
<span class="n">subjectAltName</span> = @<span class="n">alt_names</span>
[<span class="n">alt_names</span>]
<span class="n">DNS</span>.<span class="m">1</span> = <span class="n">kubernetes</span>
<span class="n">DNS</span>.<span class="m">2</span> = <span class="n">kubernetes</span>.<span class="n">default</span>
<span class="n">IP</span>.<span class="m">1</span> = <span class="m">10</span>.<span class="m">100</span>.<span class="m">0</span>.<span class="m">1</span> 
<span class="n">IP</span>.<span class="m">2</span> = ${<span class="n">MASTER_IPV4</span>}
</code></pre>
    </div>
  </li>
</ol>

<blockquote>
  <p>Replace ${MASTER_IPV4} with the Master’s IP address on which the Kubernetes API will be accessible.</p>
</blockquote>

<ol>
  <li>
    <p>Generate the necessary TLS assets.</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="c"># Generate the root CA.</span>
openssl genrsa -out ca-key.pem 2048
openssl req -x509 -new -nodes -key ca-key.pem -days 10000 -out ca.pem -subj <span class="s2">"/CN=kube-ca"</span>

<span class="c"># Generate the API server keypair.</span>
openssl genrsa -out apiserver-key.pem 2048
openssl req -new -key apiserver-key.pem -out apiserver.csr -subj <span class="s2">"/CN=kube-apiserver"</span> -config openssl.cnf
openssl x509 -req -in apiserver.csr -CA ca.pem -CAkey ca-key.pem -CAcreateserial -out apiserver.pem -days 365 -extensions v3_req -extfile openssl.cnf
</code></pre>
    </div>
  </li>
  <li>You should now have the following three files: <code class="highlighter-rouge">ca.pem</code>, <code class="highlighter-rouge">apiserver.pem</code>, and <code class="highlighter-rouge">apiserver-key.pem</code>.  Send the three files to your master host (using <code class="highlighter-rouge">scp</code> for example).</li>
  <li>
    <p>Move them to the <code class="highlighter-rouge">/etc/kubernetes/ssl</code> folder and ensure that only the root user can read the key:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="c"># Move keys</span>
sudo mkdir -p /etc/kubernetes/ssl/
sudo mv -t /etc/kubernetes/ssl/ ca.pem apiserver.pem apiserver-key.pem
    
<span class="c"># Set permissions</span>
sudo chmod 600 /etc/kubernetes/ssl/apiserver-key.pem
sudo chown root:root /etc/kubernetes/ssl/apiserver-key.pem
</code></pre>
    </div>
  </li>
</ol>

<h3 id="install-calicos-etcd-on-the-master">Install Calico’s etcd on the master</h3>

<p>Calico needs its own etcd cluster to store its state.  In this guide we install a single-node cluster on the master server.</p>

<blockquote>
  <p>Note: In a production deployment we recommend running a distributed etcd cluster for redundancy. In this guide, we use a single etcd for simplicitly.</p>
</blockquote>

<ol>
  <li>
    <p>Download the template manifest file:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>wget https://raw.githubusercontent.com/projectcalico/calico-cni/k8s-1.1-docs/samples/kubernetes/master/calico-etcd.manifest
</code></pre>
    </div>
  </li>
  <li>
    <p>Replace all instances of <code class="highlighter-rouge">&lt;MASTER_IPV4&gt;</code> in the <code class="highlighter-rouge">calico-etcd.manifest</code> file with your master’s IP address.</p>
  </li>
  <li>
    <p>Then, move the file to the <code class="highlighter-rouge">/etc/kubernetes/manifests</code> directory.  This will not have any effect until we later run the kubelet, but Calico seems to tolerate the lack of its etcd in the interim.</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>sudo mv -f calico-etcd.manifest /etc/kubernetes/manifests
</code></pre>
    </div>
  </li>
</ol>

<h3 id="install-calico-on-the-master">Install Calico on the master</h3>

<p>We need to install Calico on the master.  This allows the master to route packets to the pods on other nodes.</p>

<ol>
  <li>
    <p>Install the <code class="highlighter-rouge">calicoctl</code> tool:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>wget https://github.com/projectcalico/calico-containers/releases/download/v0.15.0/calicoctl
chmod +x calicoctl
sudo mv calicoctl /usr/bin
</code></pre>
    </div>
  </li>
  <li>
    <p>Prefetch the calico/node container (this ensures that the Calico service starts immediately when we enable it):</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>sudo docker pull calico/node:v0.15.0
</code></pre>
    </div>
  </li>
  <li>
    <p>Download the <code class="highlighter-rouge">network-environment</code> template from the <code class="highlighter-rouge">calico-kubernetes</code> repository:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>wget -O network-environment https://raw.githubusercontent.com/projectcalico/calico-cni/k8s-1.1-docs/samples/kubernetes/master/network-environment-template
</code></pre>
    </div>
  </li>
  <li>
    <p>Edit <code class="highlighter-rouge">network-environment</code> to represent this node’s settings:</p>

    <ul>
      <li>Replace <code class="highlighter-rouge">&lt;KUBERNETES_MASTER&gt;</code> with the IP address of the master.  This should be the source IP address used to reach the Kubernetes worker nodes.</li>
    </ul>
  </li>
  <li>
    <p>Move <code class="highlighter-rouge">network-environment</code> into <code class="highlighter-rouge">/etc</code>:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>sudo mv -f network-environment /etc
</code></pre>
    </div>
  </li>
  <li>
    <p>Install, enable, and start the <code class="highlighter-rouge">calico-node</code> service:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>sudo wget -N -P /etc/systemd https://raw.githubusercontent.com/projectcalico/calico-cni/k8s-1.1-docs/samples/kubernetes/common/calico-node.service
sudo systemctl <span class="nb">enable</span> /etc/systemd/calico-node.service
sudo systemctl start calico-node.service
</code></pre>
    </div>
  </li>
</ol>

<h3 id="install-kubernetes-on-the-master">Install Kubernetes on the Master</h3>

<p>We’ll use the <code class="highlighter-rouge">kubelet</code> to bootstrap the Kubernetes master.</p>

<ol>
  <li>
    <p>Download and install the <code class="highlighter-rouge">kubelet</code> and <code class="highlighter-rouge">kubectl</code> binaries:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>sudo wget -N -P /usr/bin http://storage.googleapis.com/kubernetes-release/release/v1.1.4/bin/linux/amd64/kubectl
sudo wget -N -P /usr/bin http://storage.googleapis.com/kubernetes-release/release/v1.1.4/bin/linux/amd64/kubelet
sudo chmod +x /usr/bin/kubelet /usr/bin/kubectl
</code></pre>
    </div>
  </li>
  <li>
    <p>Install the <code class="highlighter-rouge">kubelet</code> systemd unit file and start the <code class="highlighter-rouge">kubelet</code>:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="c"># Install the unit file</span>
sudo wget -N -P /etc/systemd https://raw.githubusercontent.com/projectcalico/calico-cni/k8s-1.1-docs/samples/kubernetes/master/kubelet.service

<span class="c"># Enable the unit file so that it runs on boot</span>
sudo systemctl <span class="nb">enable</span> /etc/systemd/kubelet.service

<span class="c"># Start the kubelet service</span>
sudo systemctl start kubelet.service
</code></pre>
    </div>
  </li>
  <li>
    <p>Download and install the master manifest file, which will start the Kubernetes master services automatically:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>sudo mkdir -p /etc/kubernetes/manifests
sudo wget -N -P /etc/kubernetes/manifests https://raw.githubusercontent.com/projectcalico/calico-cni/k8s-1.1-docs/samples/kubernetes/master/kubernetes-master.manifest
</code></pre>
    </div>
  </li>
  <li>
    <p>Check the progress by running <code class="highlighter-rouge">docker ps</code>.  After a while, you should see the <code class="highlighter-rouge">etcd</code>, <code class="highlighter-rouge">apiserver</code>, <code class="highlighter-rouge">controller-manager</code>, <code class="highlighter-rouge">scheduler</code>, and <code class="highlighter-rouge">kube-proxy</code> containers running.</p>

    <blockquote>
      <p>Note: it may take some time for all the containers to start. Don’t worry if <code class="highlighter-rouge">docker ps</code> doesn’t show any containers for a while or if some containers start before others.</p>
    </blockquote>
  </li>
</ol>

<h2 id="set-up-the-nodes">Set up the nodes</h2>

<p>The following steps should be run on each Kubernetes node.</p>

<h3 id="configure-tls-1">Configure TLS</h3>

<p>Worker nodes require three keys: <code class="highlighter-rouge">ca.pem</code>, <code class="highlighter-rouge">worker.pem</code>, and <code class="highlighter-rouge">worker-key.pem</code>.  We’ve already generated
<code class="highlighter-rouge">ca.pem</code> and <code class="highlighter-rouge">ca-key.pem</code> for use on the Master.  The worker public/private keypair should be generated for each Kubernetes node.</p>

<ol>
  <li>
    <p>Create the file <code class="highlighter-rouge">worker-openssl.cnf</code> with the following contents.</p>

    <div class="language-conf highlighter-rouge"><pre class="highlight"><code>[<span class="n">req</span>]
<span class="n">req_extensions</span> = <span class="n">v3_req</span>
<span class="n">distinguished_name</span> = <span class="n">req_distinguished_name</span>
[<span class="n">req_distinguished_name</span>]
[ <span class="n">v3_req</span> ]
<span class="n">basicConstraints</span> = <span class="n">CA</span>:<span class="n">FALSE</span>
<span class="n">keyUsage</span> = <span class="n">nonRepudiation</span>, <span class="n">digitalSignature</span>, <span class="n">keyEncipherment</span>
<span class="n">subjectAltName</span> = @<span class="n">alt_names</span>
[<span class="n">alt_names</span>]
<span class="n">IP</span>.<span class="m">1</span> = $<span class="n">ENV</span>::<span class="n">WORKER_IP</span>
</code></pre>
    </div>
  </li>
  <li>
    <p>Generate the necessary TLS assets for this worker. This relies on the worker’s IP address, and the <code class="highlighter-rouge">ca.pem</code> and <code class="highlighter-rouge">ca-key.pem</code> files generated earlier in the guide.</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="c"># Export this worker's IP address.</span>
<span class="nb">export </span><span class="nv">WORKER_IP</span><span class="o">=</span>&lt;WORKER_IPV4&gt;
</code></pre>
    </div>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="c"># Generate keys.</span>
openssl genrsa -out worker-key.pem 2048
openssl req -new -key worker-key.pem -out worker.csr -subj <span class="s2">"/CN=worker-key"</span> -config worker-openssl.cnf
openssl x509 -req -in worker.csr -CA ca.pem -CAkey ca-key.pem -CAcreateserial -out worker.pem -days 365 -extensions v3_req -extfile worker-openssl.cnf
</code></pre>
    </div>
  </li>
  <li>
    <p>Send the three files (<code class="highlighter-rouge">ca.pem</code>, <code class="highlighter-rouge">worker.pem</code>, and <code class="highlighter-rouge">worker-key.pem</code>) to the host (using scp, for example).</p>
  </li>
  <li>
    <p>Move the files to the <code class="highlighter-rouge">/etc/kubernetes/ssl</code> folder with the appropriate permissions:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="c"># Move keys</span>
sudo mkdir -p /etc/kubernetes/ssl/
sudo mv -t /etc/kubernetes/ssl/ ca.pem worker.pem worker-key.pem

<span class="c"># Set permissions</span>
sudo chmod 600 /etc/kubernetes/ssl/worker-key.pem
sudo chown root:root /etc/kubernetes/ssl/worker-key.pem
</code></pre>
    </div>
  </li>
</ol>

<h3 id="configure-the-kubelet-worker">Configure the kubelet worker</h3>

<ol>
  <li>
    <p>With your certs in place, create a kubeconfig for worker authentication in <code class="highlighter-rouge">/etc/kubernetes/worker-kubeconfig.yaml</code>; replace <code class="highlighter-rouge">&lt;KUBERNETES_MASTER&gt;</code> with the IP address of the master:</p>

    <div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="s">kind</span><span class="pi">:</span> <span class="s">Config</span>
<span class="s">clusters</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">name</span><span class="pi">:</span> <span class="s">local</span>
  <span class="s">cluster</span><span class="pi">:</span>
    <span class="s">server</span><span class="pi">:</span> <span class="s">https://&lt;KUBERNETES_MASTER&gt;:443</span>
    <span class="s">certificate-authority</span><span class="pi">:</span> <span class="s">/etc/kubernetes/ssl/ca.pem</span>
<span class="s">users</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">name</span><span class="pi">:</span> <span class="s">kubelet</span>
  <span class="s">user</span><span class="pi">:</span>
    <span class="s">client-certificate</span><span class="pi">:</span> <span class="s">/etc/kubernetes/ssl/worker.pem</span>
    <span class="s">client-key</span><span class="pi">:</span> <span class="s">/etc/kubernetes/ssl/worker-key.pem</span>
<span class="s">contexts</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">context</span><span class="pi">:</span>
    <span class="s">cluster</span><span class="pi">:</span> <span class="s">local</span>
    <span class="s">user</span><span class="pi">:</span> <span class="s">kubelet</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">kubelet-context</span>
<span class="s">current-context</span><span class="pi">:</span> <span class="s">kubelet-context</span>
</code></pre>
    </div>
  </li>
</ol>

<h3 id="install-calico-on-the-node">Install Calico on the node</h3>

<p>On your compute nodes, it is important that you install Calico before Kubernetes. We’ll install Calico using the provided <code class="highlighter-rouge">calico-node.service</code> systemd unit file:</p>

<ol>
  <li>
    <p>Install the <code class="highlighter-rouge">calicoctl</code> binary:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>wget https://github.com/projectcalico/calico-containers/releases/download/v0.15.0/calicoctl
chmod +x calicoctl
sudo mv calicoctl /usr/bin
</code></pre>
    </div>
  </li>
  <li>
    <p>Fetch the calico/node container:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>sudo docker pull calico/node:v0.15.0
</code></pre>
    </div>
  </li>
  <li>
    <p>Download the <code class="highlighter-rouge">network-environment</code> template from the <code class="highlighter-rouge">calico-cni</code> repository:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>wget -O network-environment https://raw.githubusercontent.com/projectcalico/calico-cni/k8s-1.1-docs/samples/kubernetes/node/network-environment-template
</code></pre>
    </div>
  </li>
  <li>
    <p>Edit <code class="highlighter-rouge">network-environment</code> to represent this node’s settings:</p>

    <ul>
      <li>Replace <code class="highlighter-rouge">&lt;DEFAULT_IPV4&gt;</code> with the IP address of the node.</li>
      <li>Replace <code class="highlighter-rouge">&lt;KUBERNETES_MASTER&gt;</code> with the IP or hostname of the master.</li>
    </ul>
  </li>
  <li>
    <p>Move <code class="highlighter-rouge">network-environment</code> into <code class="highlighter-rouge">/etc</code>:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>sudo mv -f network-environment /etc
</code></pre>
    </div>
  </li>
  <li>
    <p>Install the <code class="highlighter-rouge">calico-node</code> service:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>sudo wget -N -P /etc/systemd https://raw.githubusercontent.com/projectcalico/calico-cni/k8s-1.1-docs/samples/kubernetes/common/calico-node.service
sudo systemctl <span class="nb">enable</span> /etc/systemd/calico-node.service
sudo systemctl start calico-node.service
</code></pre>
    </div>
  </li>
  <li>
    <p>Install the Calico CNI plugins:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>sudo mkdir -p /opt/cni/bin/
sudo wget -N -P /opt/cni/bin/ https://github.com/projectcalico/calico-cni/releases/download/v1.0.0/calico
sudo wget -N -P /opt/cni/bin/ https://github.com/projectcalico/calico-cni/releases/download/v1.0.0/calico-ipam
sudo chmod +x /opt/cni/bin/calico /opt/cni/bin/calico-ipam
</code></pre>
    </div>
  </li>
  <li>
    <p>Create a CNI network configuration file, which tells Kubernetes to create a network named <code class="highlighter-rouge">calico-k8s-network</code> and to use the calico plugins for that network.  Create file <code class="highlighter-rouge">/etc/cni/net.d/10-calico.conf</code> with the following contents, replacing <code class="highlighter-rouge">&lt;KUBERNETES_MASTER&gt;</code> with the IP of the master (this file should be the same on each node):</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="c"># Make the directory structure.</span>
mkdir -p /etc/cni/net.d

<span class="c"># Make the network configuration file</span>
cat &gt;/etc/cni/net.d/10-calico.conf <span class="sh">&lt;&lt;EOF
{
    "name": "calico-k8s-network",
    "type": "calico",
    "etcd_authority": "&lt;KUBERNETES_MASTER&gt;:6666",
    "log_level": "info",
    "ipam": {
        "type": "calico-ipam"
    }
}
EOF
</span></code></pre>
    </div>

    <p>Since this is the only network we create, it will be used by default by the kubelet.</p>
  </li>
  <li>
    <p>Verify that Calico started correctly:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>calicoctl status
</code></pre>
    </div>

    <p>should show that Felix (Calico’s per-node agent) is running and the there should be a BGP status line for each other node that you’ve configured and the master.  The “Info” column should show “Established”:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>$ calicoctl status
calico-node container is running. Status: Up 15 hours
Running felix version 1.3.0rc5
    
IPv4 BGP status
+---------------+-------------------+-------+----------+-------------+
|  Peer address |     Peer type     | State |  Since   |     Info    |
+---------------+-------------------+-------+----------+-------------+
| 172.18.203.41 | node-to-node mesh |   up  | 17:32:26 | Established |
| 172.18.203.42 | node-to-node mesh |   up  | 17:32:25 | Established |
+---------------+-------------------+-------+----------+-------------+
    
IPv6 BGP status
+--------------+-----------+-------+-------+------+
| Peer address | Peer type | State | Since | Info |
+--------------+-----------+-------+-------+------+
+--------------+-----------+-------+-------+------+
</code></pre>
    </div>

    <p>If the “Info” column shows “Active” or some other value then Calico is having difficulty connecting to the other host.  Check the IP address of the peer is correct and check that Calico is using the correct local IP address (set in the <code class="highlighter-rouge">network-environment</code> file above).</p>
  </li>
</ol>

<h3 id="install-kubernetes-on-the-node">Install Kubernetes on the Node</h3>

<ol>
  <li>
    <p>Download and Install the kubelet binary:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>sudo wget -N -P /usr/bin http://storage.googleapis.com/kubernetes-release/release/v1.1.4/bin/linux/amd64/kubelet
sudo chmod +x /usr/bin/kubelet
</code></pre>
    </div>
  </li>
  <li>
    <p>Install the <code class="highlighter-rouge">kubelet</code> systemd unit file:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="c"># Download the unit file.</span>
sudo wget -N -P /etc/systemd  https://raw.githubusercontent.com/projectcalico/calico-cni/k8s-1.1-docs/samples/kubernetes/node/kubelet.service

<span class="c"># Enable and start the unit files so that they run on boot</span>
sudo systemctl <span class="nb">enable</span> /etc/systemd/kubelet.service
sudo systemctl start kubelet.service
</code></pre>
    </div>
  </li>
  <li>
    <p>Download the <code class="highlighter-rouge">kube-proxy</code> manifest:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>wget https://raw.githubusercontent.com/projectcalico/calico-cni/k8s-1.1-docs/samples/kubernetes/node/kube-proxy.manifest
</code></pre>
    </div>
  </li>
  <li>
    <p>In that file, replace <code class="highlighter-rouge">&lt;KUBERNETES_MASTER&gt;</code> with your master’s IP. Then move it into place:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>sudo mkdir -p /etc/kubernetes/manifests/
sudo mv kube-proxy.manifest /etc/kubernetes/manifests/
</code></pre>
    </div>
  </li>
</ol>

<h2 id="configure-kubectl-remote-access">Configure kubectl remote access</h2>

<p>To administer your cluster from a separate host (e.g your laptop), you will need the root CA generated earlier, as well as an admin public/private keypair (<code class="highlighter-rouge">ca.pem</code>, <code class="highlighter-rouge">admin.pem</code>, <code class="highlighter-rouge">admin-key.pem</code>). Run the following steps on the machine which you will use to control your cluster.</p>

<ol>
  <li>
    <p>Download the kubectl binary.</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>sudo wget -N -P /usr/bin http://storage.googleapis.com/kubernetes-release/release/v1.1.4/bin/linux/amd64/kubectl
sudo chmod +x /usr/bin/kubectl
</code></pre>
    </div>
  </li>
  <li>
    <p>Generate the admin public/private keypair.</p>
  </li>
  <li>
    <p>Export the necessary variables, substituting in correct values for your machine.</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="c"># Export the appropriate paths.</span>
<span class="nb">export </span><span class="nv">CA_CERT_PATH</span><span class="o">=</span>&lt;PATH_TO_CA_PEM&gt;
<span class="nb">export </span><span class="nv">ADMIN_CERT_PATH</span><span class="o">=</span>&lt;PATH_TO_ADMIN_PEM&gt;
<span class="nb">export </span><span class="nv">ADMIN_KEY_PATH</span><span class="o">=</span>&lt;PATH_TO_ADMIN_KEY_PEM&gt;

<span class="c"># Export the Master's IP address.</span>
<span class="nb">export </span><span class="nv">MASTER_IPV4</span><span class="o">=</span>&lt;MASTER_IPV4&gt;
</code></pre>
    </div>
  </li>
  <li>
    <p>Configure your host <code class="highlighter-rouge">kubectl</code> with the admin credentials:</p>

    <div class="language-shell highlighter-rouge"><pre class="highlight"><code>kubectl config <span class="nb">set</span>-cluster calico-cluster --server<span class="o">=</span>https://<span class="k">${</span><span class="nv">MASTER_IPV4</span><span class="k">}</span> --certificate-authority<span class="o">=</span><span class="k">${</span><span class="nv">CA_CERT_PATH</span><span class="k">}</span>
kubectl config <span class="nb">set</span>-credentials calico-admin --certificate-authority<span class="o">=</span><span class="k">${</span><span class="nv">CA_CERT_PATH</span><span class="k">}</span> --client-key<span class="o">=</span><span class="k">${</span><span class="nv">ADMIN_KEY_PATH</span><span class="k">}</span> --client-certificate<span class="o">=</span><span class="k">${</span><span class="nv">ADMIN_CERT_PATH</span><span class="k">}</span>
kubectl config <span class="nb">set</span>-context calico --cluster<span class="o">=</span>calico-cluster --user<span class="o">=</span>calico-admin
kubectl config use-context calico
</code></pre>
    </div>
  </li>
</ol>

<p>Check your work with <code class="highlighter-rouge">kubectl get nodes</code>, which should succeed and display the nodes.</p>

<h2 id="install-the-dns-addon">Install the DNS Addon</h2>

<p>Most Kubernetes deployments will require the DNS addon for service discovery. To install DNS, create the skydns service and replication controller provided.  This step makes use of the kubectl configuration made above.</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>kubectl create -f https://raw.githubusercontent.com/projectcalico/calico-cni/k8s-1.1-docs/samples/kubernetes/master/dns/skydns.yaml
</code></pre>
</div>

<h2 id="install-the-kubernetes-ui-addon-optional">Install the Kubernetes UI Addon (Optional)</h2>

<p>The Kubernetes UI can be installed using <code class="highlighter-rouge">kubectl</code> to run the following manifest file.</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>kubectl create -f https://raw.githubusercontent.com/projectcalico/calico-cni/k8s-1.1-docs/samples/kubernetes/master/kube-ui/kube-ui.yaml
</code></pre>
</div>

<p>Note: The Kubernetes UI addon is deprecated and has been replaced with Kubernetes dashboard. You can install it by running:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>kubectl create -f https://rawgit.com/kubernetes/dashboard/master/src/deploy/kubernetes-dashboard.yaml
</code></pre>
</div>

<p>You can find the docs at <a href="https://github.com/kubernetes/dashboard">Kubernetes Dashboard</a></p>

<h2 id="launch-other-services-with-calico-kubernetes">Launch other Services With Calico-Kubernetes</h2>

<p>At this point, you have a fully functioning cluster running on Kubernetes with a master and two nodes networked with Calico. You can now follow any of the <a href="https://github.com/kubernetes/kubernetes/tree/v1.3.0/examples/">standard documentation</a> to set up other services on your cluster.</p>

<h2 id="connectivity-to-outside-the-cluster">Connectivity to outside the cluster</h2>

<p>Because containers in this guide have private <code class="highlighter-rouge">192.168.0.0/16</code> IPs, you will need NAT to allow connectivity between containers and the internet. However, in a production data center deployment, NAT is not always necessary, since Calico can peer with the data center’s border routers over BGP.</p>

<h3 id="nat-on-the-nodes">NAT on the nodes</h3>

<p>The simplest method for enabling connectivity from containers to the internet is to use outgoing NAT on your Kubernetes nodes.</p>

<p>Calico can provide outgoing NAT for containers.  To enable it, use the following <code class="highlighter-rouge">calicoctl</code> command:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">ETCD_AUTHORITY=&lt;master_ip:6666&gt; </span>calicoctl pool add &lt;CONTAINER_SUBNET&gt; --nat-outgoing
</code></pre>
</div>

<p>By default, <code class="highlighter-rouge">&lt;CONTAINER_SUBNET&gt;</code> will be <code class="highlighter-rouge">192.168.0.0/16</code>.  You can find out which pools have been configured with the following command:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">ETCD_AUTHORITY=&lt;master_ip:6666&gt; </span>calicoctl pool show
</code></pre>
</div>

<h3 id="nat-at-the-border-router">NAT at the border router</h3>

<p>In a data center environment, it is recommended to configure Calico to peer with the border routers over BGP. This means that the container IPs will be routable anywhere in the data center, and so NAT is not needed on the nodes (though it may be enabled at the data center edge to allow outbound-only internet connectivity).</p>

<p>The Calico documentation contains more information on how to configure Calico to <a href="https://github.com/projectcalico/calico-containers/blob/master/docs/ExternalConnectivity.md">peer with existing infrastructure</a>.</p>

<h2 id="support-level">Support Level</h2>

<table>
  <thead>
    <tr>
      <th>IaaS Provider</th>
      <th>Config. Mgmt</th>
      <th>OS</th>
      <th>Networking</th>
      <th>Docs</th>
      <th>Conforms</th>
      <th>Support Level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Bare-metal</td>
      <td>custom</td>
      <td>Ubuntu</td>
      <td>Calico</td>
      <td><a href="/docs/getting-started-guides/ubuntu-calico">docs</a></td>
      <td> </td>
      <td>Community (<a href="https://github.com/djosborne">@djosborne</a>)</td>
    </tr>
  </tbody>
</table>

<p>For support level information on all solutions, see the <a href="/docs/getting-started-guides/#table-of-solutions">Table of solutions</a> chart.</p>


        <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/getting-started-guides/ubuntu-calico.md?pixel" alt="Analytics" /></a>
        <div id="pd_rating_holder_8345992"></div>
		<script type="text/javascript">
	        PDRTJS_settings_8345992 = {
		        "id" : "8345992",
		        "unique_id" : "/docs/getting-started-guides/ubuntu-calico/",
		        "title" : "Ubuntu Nodes with Calico",
		        "permalink" : "http://kubernetes.github.io/docs/getting-started-guides/ubuntu-calico/"
	        };
	        (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
        </script>
	</div>
</section>

<footer>
	<main class="light-text">
		<nav>
			<a href="/docs/hellonode/">Get Started</a>
			<a href="/docs/">Documentation</a>
			<a href="http://blog.kubernetes.io/">Blog</a>
			<a href="/community/">Community</a>
		</nav>
		<div class="social">
			<div>
				<a href="https://twitter.com/kubernetesio" class="twitter"><span>twitter</span></a>
				<a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
				<a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
			</div>
			<div>
				<a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
				<a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
				<a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
			</div>
			<div>
				<span>I wish this page</span>
				<input type="text" id="wishField" name="wishField" placeholder="enter your wish">
			</div>
		</div>
		<div id="miceType" class="center">&copy; 2016 Kubernetes</div>
	</main>
</footer>


<button class="flyout-button" onclick="kub.toggleToc()"></button>

<style>
	.cse .gsc-control-cse, .gsc-control-cse, {
		padding: 0;
	}
	.gsc-control-cse table, .gsc-control-cse-en table {
		margin:0px !important;
	}

	.gsc-above-wrapper-area {
		border-bottom: 0;
	}
</style>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36037335-10', 'auto');
  ga('send', 'pageview');
</script>
<!-- Commenting out AnswerDash for now; we need to work on our list of questions/answers/design first
<!-- Start of AnswerDash script <script>var AnswerDash;!function(e,t,n,s,a){if(!t.getElementById(s)){var i,r=t.createElement(n),c=t.getElementsByTagName(n)[0];e[a]||(i=e[a]=function(){i.__oninit.push(arguments)},i.__oninit=[]),r.type="text/javascript",r.async=!0,r.src="https://p1.answerdash.com/answerdash.min.js?siteid=756",r.setAttribute("id",s),c.parentNode.insertBefore(r,c)}}(window,document,"script","answerdash-script","AnswerDash");</script> <!-- End of AnswerDash script -->
</body>
</html>
