

<!Doctype html>
<html id="docs" class="Guides">


<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="canonical" href="http://kubernetes.io/docs/getting-started-guides/coreos/coreos_multinode_cluster/" />
	<link rel="shortcut icon" type="image/png" href="/images/favicon.png">
	<link href='https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href='https://fonts.googleapis.com/css?family=Roboto+Mono' type='text/css'>
	<link rel="stylesheet" href="/css/styles.css"/>
        <link rel="stylesheet" href="/css/jquery-ui.min.css">
        <link rel="stylesheet" href="/css/sweetalert.css">
	<script src="/js/jquery-2.2.0.min.js"></script>
        <script src="/js/jquery-ui.min.js"></script>
	<script src="/js/script.js"></script>
        <script src="/js/sweetalert.min.js"></script>
	<title>Kubernetes - CoreOS on Multinode Cluster</title>
</head>
<body>
<div id="cellophane" onclick="kub.toggleMenu()"></div>
<header>
	<a href="/" class="logo"></a>
	<div class="nav-buttons" data-auto-burger="primary">
		<a href="/docs/" class="button" id="viewDocs" data-auto-burger-exclude>View Documentation</a>
		<a href="/docs/hellonode/" class="button" id="tryKubernetes" data-auto-burger-exclude>Try Kubernetes</a>
		<button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
	</div>

	<nav id="mainNav">
		<main data-auto-burger="primary">
			<div class="nav-box">
				<h3><a href="/docs/hellonode/">Get Started</a></h3>
				<p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>
			</div>
			<div class="nav-box">
				<h3><a href="/docs/">Documentation</a></h3>
				<p>Learn how to use Kubernetes with the use of walkthroughs, samples, and reference documentation. You can even <a href="/editdocs/" data-auto-burger-exclude>help contribute to the docs</a>!</p>
			</div>
			<div class="nav-box">
				<h3><a href="/community/">Community</a></h3>
				<p>If you need help, you can connect with other Kubernetes users and the Kubernetes authors, attend community events, and watch video presentations from around the web.</p>
			</div>
			<div class="nav-box">
				<h3><a href="http://blog.kubernetes.io">Blog</a></h3>
				<p>Read the latest news for Kubernetes and the containers space in general, and get technical how-tos hot off the presses.</p>
			</div>
		</main>
		<main data-auto-burger="primary">
			<div class="left">
				<h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
				<a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>View On Github</a>
			</div>

			<div class="right">
				<h5 class="github-invite">Explore the community</h5>
				<div class="social">
					<a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
					<a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
					<a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
					<a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
					<a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
					<a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
				</div>
			</div>
			<div class="clear" style="clear: both"></div>
		</main>
	</nav>
</header>


<!--  HERO  -->
<section id="hero" class="light-text">
	<h1>Guides</h1>
	<h5>How to get started, and achieve tasks, using Kubernetes</h5>
	<div id="vendorStrip" class="light-text">
		<ul>
			<li><a href="/docs/" class="YAH">GUIDES</a></li>
			<li><a href="/docs/reference" >REFERENCE</a></li>
			<li><a href="/docs/samples" >SAMPLES</a></li>
			<li><a href="/docs/troubleshooting/" >SUPPORT</a></li>
		</ul>
		<div id="searchBox">
			<input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)">
		</div>
	</div>
</section>

<section id="encyclopedia">
	<div id="docsToc">
        <div class="pi-accordion">
        
    <a class="item" data-title="Guides" href="/docs/"></a>
<div class="item" data-title="Getting Started">
  <div class="container">
    <a class="item" data-title="What is Kubernetes?" href="/docs/whatisk8s/"></a>
    <a class="item" data-title="Downloading or Building Kubernetes" href="/docs/getting-started-guides/binary_release/"></a>
    <a class="item" data-title="Hello World Walkthrough" href="/docs/hellonode/"></a>
    <a class="item" data-title="Online Training Course" href="https://www.udacity.com/course/scalable-microservices-with-kubernetes--ud615" target='_blank'></a>
  </div>
</div>
<div class="item" data-title="Accessing the Cluster">
  <div class="container">
    <a class="item" data-title="Installing and Setting up kubectl" href="/docs/user-guide/prereqs/"></a>
    <a class="item" data-title="Accessing Clusters" href="/docs/user-guide/accessing-the-cluster/"></a>
    <a class="item" data-title="Sharing Cluster Access with kubeconfig" href="/docs/user-guide/sharing-clusters/"></a>
    <a class="item" data-title="Authenticating Across Clusters with kubeconfig" href="/docs/user-guide/kubeconfig-file/"></a>
  </div>
</div>
    <a class="item" data-title="User Guide" href="/docs/user-guide/"></a>
    <a class="item" data-title="Web UI (Dashboard)" href="/docs/user-guide/ui/"></a>
<div class="item" data-title="Workload Deployment and Management">
  <div class="container">
    <a class="item" data-title="Launching, Exposing, and Killing Applications" href="/docs/user-guide/quick-start/"></a>
    <a class="item" data-title="Deploying Applications" href="/docs/user-guide/deploying-applications/"></a>
    <a class="item" data-title="Managing Resources" href="/docs/user-guide/managing-deployments/"></a>
    <a class="item" data-title="Replication Controller Operations" href="/docs/user-guide/replication-controller/operations/"></a>
    <a class="item" data-title="Resizing a Replication Controller" href="/docs/user-guide/resizing-a-replication-controller/"></a>
    <a class="item" data-title="Rolling Updates" href="/docs/user-guide/rolling-updates/"></a>
    <a class="item" data-title="Rolling Update Demo" href="/docs/user-guide/update-demo/"></a>
    <a class="item" data-title="Secrets Walkthrough" href="/docs/user-guide/secrets/walkthrough/"></a>
    <a class="item" data-title="Using ConfigMap" href="/docs/user-guide/configmap/"></a>
    <a class="item" data-title="Horizontal Pod Autoscaling" href="/docs/user-guide/horizontal-pod-autoscaling/walkthrough/"></a>
    <a class="item" data-title="Best Practices for Configuration" href="/docs/user-guide/config-best-practices/"></a>
    <a class="item" data-title="Using kubectl to Manage Resources" href="/docs/user-guide/working-with-resources/"></a>
    <a class="item" data-title="Garbage collection" href="/docs/user-guide/garbage-collector/"></a>
  </div>
</div>
<div class="item" data-title="Batch Jobs">
  <div class="container">
    <a class="item" data-title="Jobs" href="/docs/user-guide/jobs/"></a>
    <a class="item" data-title="Parallel Processing using Expansions" href="/docs/user-guide/jobs/expansions/"></a>
    <a class="item" data-title="Coarse Parallel Processing using a Work Queue" href="/docs/user-guide/jobs/work-queue-1/"></a>
    <a class="item" data-title="Fine Parallel Processing using a Work Queue" href="/docs/user-guide/jobs/work-queue-2/"></a>
  </div>
</div>
<div class="item" data-title="Service Discovery and Load Balancing">
  <div class="container">
    <a class="item" data-title="Connecting Applications with Services" href="/docs/user-guide/connecting-applications/"></a>
    <a class="item" data-title="Service Operations" href="/docs/user-guide/services/operations/"></a>
    <a class="item" data-title="Creating an External Load Balancer" href="/docs/user-guide/load-balancer/"></a>
    <a class="item" data-title="Configuring Your Cloud Provider's Firewalls" href="/docs/user-guide/services-firewalls/"></a>
    <a class="item" data-title="Cross-cluster Service Discovery using Federated Services" href="/docs/user-guide/federation/federated-services/"></a>
  </div>
</div>
<div class="item" data-title="Containers and Pods">
  <div class="container">
    <a class="item" data-title="Running Your First Containers" href="/docs/user-guide/simple-nginx/"></a>
    <a class="item" data-title="Creating Single-Container Pods" href="/docs/user-guide/pods/single-container/"></a>
    <a class="item" data-title="Creating Multi-Container Pods" href="/docs/user-guide/pods/multi-container/"></a>
    <a class="item" data-title="Configuring Containers" href="/docs/user-guide/configuring-containers/"></a>
    <a class="item" data-title="Working with Containers in Production" href="/docs/user-guide/production-pods/"></a>
    <a class="item" data-title="Commands and Capabilities" href="/docs/user-guide/containers/"></a>
    <a class="item" data-title="Using Environment Variables" href="/docs/user-guide/environment-guide/"></a>
    <a class="item" data-title="Managing Compute Resources" href="/docs/user-guide/compute-resources/"></a>
    <a class="item" data-title="The Lifecycle of a Pod" href="/docs/user-guide/pod-states/"></a>
    <a class="item" data-title="Checking Pod Health" href="/docs/user-guide/liveness/"></a>
    <a class="item" data-title="Container Lifecycle Hooks" href="/docs/user-guide/container-environment/"></a>
    <a class="item" data-title="Assigning Pods to Nodes" href="/docs/user-guide/node-selection/"></a>
    <a class="item" data-title="Using the Downward API to Convey Pod Properties" href="/docs/user-guide/downward-api/"></a>
    <a class="item" data-title="Downward API Volumes" href="/docs/user-guide/downward-api/volume"></a>
    <a class="item" data-title="Persistent Volumes Walkthrough" href="/docs/user-guide/persistent-volumes/walkthrough/"></a>
    <a class="item" data-title="Bootstrapping Pet Sets" href="/docs/user-guide/petset/bootstrapping/"></a>
  </div>
</div>
<div class="item" data-title="Monitoring, Logging, and Debugging Containers">
  <div class="container">
    <a class="item" data-title="Resource Usage Monitoring" href="/docs/user-guide/monitoring/"></a>
    <a class="item" data-title="Logging" href="/docs/getting-started-guides/logging/"></a>
    <a class="item" data-title="Logging with Elasticsearch and Kibana" href="/docs/getting-started-guides/logging-elasticsearch/"></a>
    <a class="item" data-title="Running Commands in a Container with kubectl exec" href="/docs/user-guide/getting-into-containers/"></a>
    <a class="item" data-title="Connect with Proxies" href="/docs/user-guide/connecting-to-applications-proxy/"></a>
    <a class="item" data-title="Connect with Port Forwarding" href="/docs/user-guide/connecting-to-applications-port-forward/"></a>
    <a class="item" data-title="Using Explorer to Examine the Runtime Environment" href="https://github.com/kubernetes/kubernetes/tree/release-1.3/examples/explorer" target='_blank'></a>
  </div>
</div>
<div class="item" data-title="Creating a Cluster">
  <div class="container">
    <a class="item" data-title="Picking the Right Solution" href="/docs/getting-started-guides/"></a>
<div class="item" data-title="Running Kubernetes on Your Local Machine">
  <div class="container">
    <a class="item" data-title="Running Kubernetes Locally via Minikube" href="/docs/getting-started-guides/minikube/"></a>
    <a class="item" data-title="Deprecated Alternatives" href="/docs/getting-started-guides/alternatives/"></a>
  </div>
</div>
<div class="item" data-title="Running Kubernetes on Turn-key Cloud Solutions">
  <div class="container">
    <a class="item" data-title="Running Kubernetes on Google Container Engine" href="https://cloud.google.com/container-engine/docs/before-you-begin/" target='_blank'></a>
    <a class="item" data-title="Running Kubernetes on Google Compute Engine" href="/docs/getting-started-guides/gce/"></a>
    <a class="item" data-title="Running Kubernetes on AWS EC2" href="/docs/getting-started-guides/aws/"></a>
    <a class="item" data-title="Running Kubernetes on Azure (Weave-based)" href="/docs/getting-started-guides/coreos/azure/"></a>
    <a class="item" data-title="Running Kubernetes on Azure (Flannel-based)" href="/docs/getting-started-guides/azure/"></a>
    <a class="item" data-title="Running Kubernetes on CenturyLink Cloud" href="/docs/getting-started-guides/clc/"></a>
  </div>
</div>
<div class="item" data-title="Running Kubernetes on Custom Solutions">
  <div class="container">
    <a class="item" data-title="Creating a Custom Cluster from Scratch" href="/docs/getting-started-guides/scratch/"></a>
<div class="item" data-title="Custom Cloud Solutions">
  <div class="container">
    <a class="item" data-title="CoreOS on AWS or GCE" href="/docs/getting-started-guides/coreos/"></a>
    <a class="item" data-title="Ubuntu on AWS or Joyent" href="/docs/getting-started-guides/juju/"></a>
    <a class="item" data-title="CoreOS on Rackspace" href="/docs/getting-started-guides/rackspace/"></a>
  </div>
</div>
<div class="item" data-title="On-Premise VMs">
  <div class="container">
    <a class="item" data-title="CoreOS on Vagrant" href="/docs/getting-started-guides/coreos/"></a>
    <a class="item" data-title="Cloudstack" href="/docs/getting-started-guides/cloudstack/"></a>
    <a class="item" data-title="VMware vSphere" href="/docs/getting-started-guides/vsphere/"></a>
    <a class="item" data-title="VMware Photon Controller" href="/docs/getting-started-guides/photon-controller/"></a>
    <a class="item" data-title="Juju" href="/docs/getting-started-guides/juju/"></a>
    <a class="item" data-title="DCOS" href="/docs/getting-started-guides/dcos/"></a>
    <a class="item" data-title="CoreOS on libvirt" href="/docs/getting-started-guides/libvirt-coreos/"></a>
    <a class="item" data-title="oVirt" href="/docs/getting-started-guides/ovirt/"></a>
    <a class="item" data-title="OpenStack Heat" href="/docs/getting-started-guides/openstack-heat/"></a>
    <a class="item" data-title="CoreOS on Multinode Cluster" href="/docs/getting-started-guides/coreos/coreos_multinode_cluster/"></a>
    <a class="item" data-title="Fedora With Calico Networking" href="/docs/getting-started-guides/fedora/fedora-calico/"></a>
<div class="item" data-title="rkt">
  <div class="container">
    <a class="item" data-title="Running Kubernetes with rkt" href="/docs/getting-started-guides/rkt/"></a>
    <a class="item" data-title="Known Issues when Using rkt" href="/docs/getting-started-guides/rkt/notes/"></a>
  </div>
</div>
    <a class="item" data-title="Kubernetes on Mesos" href="/docs/getting-started-guides/mesos/"></a>
    <a class="item" data-title="Kubernetes on Mesos on Docker" href="/docs/getting-started-guides/mesos-docker/"></a>
  </div>
</div>
<div class="item" data-title="Bare Metal">
  <div class="container">
    <a class="item" data-title="Offline" href="/docs/getting-started-guides/coreos/bare_metal_offline/"></a>
    <a class="item" data-title="Fedora via Ansible" href="/docs/getting-started-guides/fedora/fedora_ansible_config/"></a>
    <a class="item" data-title="Fedora (Single Node)" href="/docs/getting-started-guides/fedora/fedora_manual_config/"></a>
    <a class="item" data-title="Fedora (Multi Node)" href="/docs/getting-started-guides/fedora/flannel_multi_node_cluster/"></a>
    <a class="item" data-title="CentOS" href="/docs/getting-started-guides/centos/centos_manual_config/"></a>
    <a class="item" data-title="CoreOS" href="/docs/getting-started-guides/coreos"></a>
    <a class="item" data-title="CoreOS with Calico" href="/docs/getting-started-guides/coreos/bare_metal_calico/"></a>
    <a class="item" data-title="Ubuntu" href="/docs/getting-started-guides/ubuntu/"></a>
    <a class="item" data-title="Ubuntu Nodes with Calico" href="/docs/getting-started-guides/ubuntu-calico/"></a>
  </div>
</div>
  </div>
</div>
    <a class="item" data-title="Portable Multi-Node Cluster" href="/docs/getting-started-guides/docker-multinode/"></a>
    <a class="item" data-title="Building Large Clusters" href="/docs/admin/cluster-large/"></a>
    <a class="item" data-title="Running in Multiple Zones" href="/docs/admin/multiple-zones/"></a>
    <a class="item" data-title="Building High-Availability Clusters" href="/docs/admin/high-availability/"></a>
  </div>
</div>
<div class="item" data-title="Administering Clusters">
  <div class="container">
    <a class="item" data-title="Admin Guide" href="/docs/admin/"></a>
    <a class="item" data-title="Cluster Management Guide" href="/docs/admin/cluster-management/"></a>
    <a class="item" data-title="Sharing a Cluster with Namespaces" href="/docs/admin/namespaces/"></a>
    <a class="item" data-title="Namespaces Walkthrough" href="/docs/admin/namespaces/walkthrough/"></a>
    <a class="item" data-title="Setting Pod CPU and Memory Limits" href="/docs/admin/limitrange/"></a>
    <a class="item" data-title="Understanding Resource Quotas" href="/docs/admin/resourcequota/"></a>
    <a class="item" data-title="Applying Resource Quotas and Limits" href="/docs/admin/resourcequota/walkthrough/"></a>
    <a class="item" data-title="Kubernetes Components" href="/docs/admin/cluster-components/"></a>
    <a class="item" data-title="Configuring Kubernetes Use of etcd" href="/docs/admin/etcd/"></a>
    <a class="item" data-title="Federating Clusters" href="/docs/admin/federation/"></a>
    <a class="item" data-title="Using Multiple Clusters" href="/docs/admin/multi-cluster/"></a>
    <a class="item" data-title="Changing Cluster Size" href="https://github.com/kubernetes/kubernetes/wiki/User-FAQ#how-do-i-change-the-size-of-my-cluster/" target='_blank'></a>
    <a class="item" data-title="Configuring Multiple Schedulers" href="/docs/admin/multiple-schedulers/"></a>
    <a class="item" data-title="Networking in Kubernetes" href="/docs/admin/networking/"></a>
    <a class="item" data-title="Using DNS Pods and Services" href="/docs/admin/dns/"></a>
    <a class="item" data-title="Setting Up and Configuring DNS" href="https://github.com/kubernetes/kubernetes/tree/release-1.3/examples/cluster-dns" target='_blank'></a>
    <a class="item" data-title="Master <-> Node Communication" href="/docs/admin/master-node-communication/"></a>
    <a class="item" data-title="Network Plugins" href="/docs/admin/network-plugins/"></a>
    <a class="item" data-title="Static Pods" href="/docs/admin/static-pods/"></a>
    <a class="item" data-title="Configuring kubelet Garbage Collection" href="/docs/admin/garbage-collection/"></a>
    <a class="item" data-title="Configuring Out Of Resource Handling" href="/docs/admin/out-of-resource/"></a>
    <a class="item" data-title="Configuring Kubernetes with Salt" href="/docs/admin/salt/"></a>
    <a class="item" data-title="Monitoring Node Health" href="/docs/admin/node-problem/"></a>
  </div>
</div>
        </div> <!-- /pi-accordion -->
		<button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
	</div> <!-- /docsToc -->
	<div id="docsContent">
        <p><a href="/editdocs#docs/getting-started-guides/coreos/coreos_multinode_cluster.md" id="editPageButton">Edit This Page</a></p>
    	<h1>CoreOS on Multinode Cluster</h1>
		<p>Use the <a href="/docs/getting-started-guides/coreos/cloud-configs/master.yaml">master.yaml</a> and <a href="/docs/getting-started-guides/coreos/cloud-configs/node.yaml">node.yaml</a> cloud-configs to provision a multi-node Kubernetes cluster.</p>

<blockquote>
  <p><strong>Attention</strong>: This requires at least CoreOS version <strong><a href="https://coreos.com/releases/#695.0.0">695.0.0</a></strong>, which includes <code class="highlighter-rouge">etcd2</code>.</p>
</blockquote>

<ul id="markdown-toc">
  <li><a href="#aws" id="markdown-toc-aws">AWS</a>    <ul>
      <li><a href="#provision-the-master" id="markdown-toc-provision-the-master">Provision the Master</a></li>
      <li><a href="#capture-the-private-ip-address" id="markdown-toc-capture-the-private-ip-address">Capture the private IP address</a></li>
      <li><a href="#edit-nodeyaml" id="markdown-toc-edit-nodeyaml">Edit node.yaml</a></li>
      <li><a href="#provision-worker-nodes" id="markdown-toc-provision-worker-nodes">Provision worker nodes</a></li>
    </ul>
  </li>
  <li><a href="#google-compute-engine-gce" id="markdown-toc-google-compute-engine-gce">Google Compute Engine (GCE)</a>    <ul>
      <li><a href="#provision-the-master-1" id="markdown-toc-provision-the-master-1">Provision the Master</a></li>
      <li><a href="#capture-the-private-ip-address-1" id="markdown-toc-capture-the-private-ip-address-1">Capture the private IP address</a></li>
      <li><a href="#edit-nodeyaml-1" id="markdown-toc-edit-nodeyaml-1">Edit node.yaml</a></li>
      <li><a href="#provision-worker-nodes-1" id="markdown-toc-provision-worker-nodes-1">Provision worker nodes</a></li>
      <li><a href="#establish-network-connectivity" id="markdown-toc-establish-network-connectivity">Establish network connectivity</a></li>
    </ul>
  </li>
  <li><a href="#openstack" id="markdown-toc-openstack">OpenStack</a>    <ul>
      <li><a href="#make-sure-you-can-connect-with-openstack" id="markdown-toc-make-sure-you-can-connect-with-openstack">Make sure you can connect with OpenStack</a></li>
      <li><a href="#get-a-suitable-coreos-image" id="markdown-toc-get-a-suitable-coreos-image">Get a Suitable CoreOS Image</a></li>
      <li><a href="#create-security-group" id="markdown-toc-create-security-group">Create security group</a></li>
      <li><a href="#provision-the-master-2" id="markdown-toc-provision-the-master-2">Provision the Master</a></li>
      <li><a href="#provision-worker-nodes-2" id="markdown-toc-provision-worker-nodes-2">Provision Worker Nodes</a></li>
    </ul>
  </li>
</ul>

<h3 id="aws">AWS</h3>

<p><em>Attention:</em> Replace <code class="highlighter-rouge">&lt;ami_image_id&gt;</code> below for a <a href="https://coreos.com/docs/running-coreos/cloud-providers/ec2/">suitable version of CoreOS image for AWS</a>.</p>

<h4 id="provision-the-master">Provision the Master</h4>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>aws ec2 create-security-group --group-name kubernetes --description <span class="s2">"Kubernetes Security Group"</span>
aws ec2 authorize-security-group-ingress --group-name kubernetes --protocol tcp --port 22 --cidr 0.0.0.0/0
aws ec2 authorize-security-group-ingress --group-name kubernetes --protocol tcp --port 80 --cidr 0.0.0.0/0
aws ec2 authorize-security-group-ingress --group-name kubernetes --source-security-group-name kubernetes
</code></pre>
</div>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>aws ec2 run-instances <span class="se">\</span>
--image-id &lt;ami_image_id&gt; <span class="se">\</span>
--key-name &lt;keypair&gt; <span class="se">\</span>
--region us-west-2 <span class="se">\</span>
--security-groups kubernetes <span class="se">\</span>
--instance-type m3.medium <span class="se">\</span>
--user-data file://master.yaml
</code></pre>
</div>

<h4 id="capture-the-private-ip-address">Capture the private IP address</h4>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>aws ec2 describe-instances --instance-id &lt;master-instance-id&gt;
</code></pre>
</div>

<h4 id="edit-nodeyaml">Edit node.yaml</h4>

<p>Edit <code class="highlighter-rouge">node.yaml</code> and replace all instances of <code class="highlighter-rouge">&lt;master-private-ip&gt;</code> with the private IP address of the master node.</p>

<h4 id="provision-worker-nodes">Provision worker nodes</h4>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>aws ec2 run-instances <span class="se">\</span>
--count 1 <span class="se">\</span>
--image-id &lt;ami_image_id&gt; <span class="se">\</span>
--key-name &lt;keypair&gt; <span class="se">\</span>
--region us-west-2 <span class="se">\</span>
--security-groups kubernetes <span class="se">\</span>
--instance-type m3.medium <span class="se">\</span>
--user-data file://node.yaml
</code></pre>
</div>

<h3 id="google-compute-engine-gce">Google Compute Engine (GCE)</h3>

<p><em>Attention:</em> Replace <code class="highlighter-rouge">&lt;gce_image_id&gt;</code> below for a <a href="https://coreos.com/docs/running-coreos/cloud-providers/google-compute-engine/">suitable version of CoreOS image for Google Compute Engine</a>.</p>

<h4 id="provision-the-master-1">Provision the Master</h4>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>gcloud compute instances create master <span class="se">\</span>
--image-project coreos-cloud <span class="se">\</span>
--image &lt;gce_image_id&gt; <span class="se">\</span>
--boot-disk-size 200GB <span class="se">\</span>
--machine-type n1-standard-1 <span class="se">\</span>
--zone us-central1-a <span class="se">\</span>
--metadata-from-file user-data<span class="o">=</span>master.yaml
</code></pre>
</div>

<h4 id="capture-the-private-ip-address-1">Capture the private IP address</h4>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>gcloud compute instances list
</code></pre>
</div>

<h4 id="edit-nodeyaml-1">Edit node.yaml</h4>

<p>Edit <code class="highlighter-rouge">node.yaml</code> and replace all instances of <code class="highlighter-rouge">&lt;master-private-ip&gt;</code> with the private IP address of the master node.</p>

<h4 id="provision-worker-nodes-1">Provision worker nodes</h4>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>gcloud compute instances create node1 <span class="se">\</span>
--image-project coreos-cloud <span class="se">\</span>
--image &lt;gce_image_id&gt; <span class="se">\</span>
--boot-disk-size 200GB <span class="se">\</span>
--machine-type n1-standard-1 <span class="se">\</span>
--zone us-central1-a <span class="se">\</span>
--metadata-from-file user-data<span class="o">=</span>node.yaml
</code></pre>
</div>

<h4 id="establish-network-connectivity">Establish network connectivity</h4>

<p>Next, setup an ssh tunnel to the master so you can run kubectl from your local host.
In one terminal, run <code class="highlighter-rouge">gcloud compute ssh master --ssh-flag="-L 8080:127.0.0.1:8080"</code> and in a second
run <code class="highlighter-rouge">gcloud compute ssh master --ssh-flag="-R 8080:127.0.0.1:8080"</code>.</p>

<h3 id="openstack">OpenStack</h3>

<p>These instructions are for running on the command line.  Most of this you can also do through the Horizon dashboard.
These instructions were tested on the Ice House release on a Metacloud distribution of OpenStack but should be similar if not the same across other versions/distributions of OpenStack.</p>

<h4 id="make-sure-you-can-connect-with-openstack">Make sure you can connect with OpenStack</h4>

<p>Make sure the environment variables are set for OpenStack such as:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>OS_TENANT_ID
OS_PASSWORD
OS_AUTH_URL
OS_USERNAME
OS_TENANT_NAME
</code></pre>
</div>

<p>Test this works with something like:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>nova list
</code></pre>
</div>

<h4 id="get-a-suitable-coreos-image">Get a Suitable CoreOS Image</h4>

<p>You’ll need a <a href="https://coreos.com/os/docs/latest/booting-on-openstack.html">suitable version of CoreOS image for OpenStack</a>
Once you download that, upload it to glance.  An example is shown below:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>glance image-create --name CoreOS723 <span class="se">\</span>
--container-format bare --disk-format qcow2 <span class="se">\</span>
--file coreos_production_openstack_image.img <span class="se">\</span>
--is-public True
</code></pre>
</div>

<h4 id="create-security-group">Create security group</h4>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>nova secgroup-create kubernetes <span class="s2">"Kubernetes Security Group"</span>
nova secgroup-add-rule kubernetes tcp 22 22   0.0.0.0/0
nova secgroup-add-rule kubernetes tcp 80 80   0.0.0.0/0
</code></pre>
</div>

<h4 id="provision-the-master-2">Provision the Master</h4>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>nova boot <span class="se">\</span>
--image &lt;image_name&gt; <span class="se">\</span>
--key-name &lt;my_key&gt; <span class="se">\</span>
--flavor &lt;flavor id&gt; <span class="se">\</span>
--security-group kubernetes <span class="se">\</span>
--user-data files/master.yaml <span class="se">\</span>
kube-master
</code></pre>
</div>

<p><code class="highlighter-rouge">&lt;image_name&gt;</code> is the CoreOS image name. In our example we can use the image we created in the previous step and put in ‘CoreOS723’</p>

<p><code class="highlighter-rouge">&lt;my_key&gt;</code> is the keypair name that you already generated to access the instance.</p>

<p><code class="highlighter-rouge">&lt;flavor_id&gt;</code> is the flavor ID you use to size the instance.  Run <code class="highlighter-rouge">nova flavor-list</code> to get the IDs.  3 on the system this was tested with gives the m1.large size.</p>

<p>The important part is to ensure you have the files/master.yml as this is what will do all the post boot configuration. This path is relevant so we are assuming in this example that you are running the nova command in a directory where there is a subdirectory called files that has the master.yml file in it.  Absolute paths also work.</p>

<p>Next, assign it a public IP address:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>nova floating-ip-list
</code></pre>
</div>

<p>Get an IP address that’s free and run:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>nova floating-ip-associate kube-master &lt;ip address&gt;
</code></pre>
</div>

<p>where <code class="highlighter-rouge">&lt;ip address&gt;</code> is the IP address that was available from the <code class="highlighter-rouge">nova floating-ip-list</code> command.</p>

<h4 id="provision-worker-nodes-2">Provision Worker Nodes</h4>

<p>Edit <code class="highlighter-rouge">node.yaml</code> and replace all instances of <code class="highlighter-rouge">&lt;master-private-ip&gt;</code> with the private IP address of the master node.  You can get this by running <code class="highlighter-rouge">nova show kube-master</code> assuming you named your instance kube master.  This is not the floating IP address you just assigned it.</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>nova boot <span class="se">\</span>
--image &lt;image_name&gt; <span class="se">\</span>
--key-name &lt;my_key&gt; <span class="se">\</span>
--flavor &lt;flavor id&gt; <span class="se">\</span>
--security-group kubernetes <span class="se">\</span>
--user-data files/node.yaml <span class="se">\</span>
minion01
</code></pre>
</div>

<p>This is basically the same as the master nodes but with the node.yaml post-boot script instead of the master.</p>

        <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/getting-started-guides/coreos/coreos_multinode_cluster.md?pixel" alt="Analytics" /></a>
        <div id="pd_rating_holder_8345992"></div>
		<script type="text/javascript">
	        PDRTJS_settings_8345992 = {
		        "id" : "8345992",
		        "unique_id" : "/docs/getting-started-guides/coreos/coreos_multinode_cluster/",
		        "title" : "CoreOS on Multinode Cluster",
		        "permalink" : "http://kubernetes.github.io/docs/getting-started-guides/coreos/coreos_multinode_cluster/"
	        };
	        (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
        </script>
	</div>
</section>

<footer>
	<main class="light-text">
		<nav>
			<a href="/docs/hellonode/">Get Started</a>
			<a href="/docs/">Documentation</a>
			<a href="http://blog.kubernetes.io/">Blog</a>
			<a href="/community/">Community</a>
		</nav>
		<div class="social">
			<div>
				<a href="https://twitter.com/kubernetesio" class="twitter"><span>twitter</span></a>
				<a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
				<a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
			</div>
			<div>
				<a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
				<a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
				<a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
			</div>
			<div>
				<span>I wish this page</span>
				<input type="text" id="wishField" name="wishField" placeholder="enter your wish">
			</div>
		</div>
		<div id="miceType" class="center">&copy; 2016 Kubernetes</div>
	</main>
</footer>


<button class="flyout-button" onclick="kub.toggleToc()"></button>

<style>
	.cse .gsc-control-cse, .gsc-control-cse, {
		padding: 0;
	}
	.gsc-control-cse table, .gsc-control-cse-en table {
		margin:0px !important;
	}

	.gsc-above-wrapper-area {
		border-bottom: 0;
	}
</style>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36037335-10', 'auto');
  ga('send', 'pageview');
</script>
<!-- Commenting out AnswerDash for now; we need to work on our list of questions/answers/design first
<!-- Start of AnswerDash script <script>var AnswerDash;!function(e,t,n,s,a){if(!t.getElementById(s)){var i,r=t.createElement(n),c=t.getElementsByTagName(n)[0];e[a]||(i=e[a]=function(){i.__oninit.push(arguments)},i.__oninit=[]),r.type="text/javascript",r.async=!0,r.src="https://p1.answerdash.com/answerdash.min.js?siteid=756",r.setAttribute("id",s),c.parentNode.insertBefore(r,c)}}(window,document,"script","answerdash-script","AnswerDash");</script> <!-- End of AnswerDash script -->
</body>
</html>
