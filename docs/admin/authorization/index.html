

<!Doctype html>
<html id="docs" class="Reference Documentation">


<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="canonical" href="http://kubernetes.io/docs/admin/authorization/" />
	<link rel="shortcut icon" type="image/png" href="/images/favicon.png">
	<link href='https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href='https://fonts.googleapis.com/css?family=Roboto+Mono' type='text/css'>
	<link rel="stylesheet" href="/css/styles.css"/>
        <link rel="stylesheet" href="/css/jquery-ui.min.css">
        <link rel="stylesheet" href="/css/sweetalert.css">
	<script src="/js/jquery-2.2.0.min.js"></script>
        <script src="/js/jquery-ui.min.js"></script>
	<script src="/js/script.js"></script>
        <script src="/js/sweetalert.min.js"></script>
	<title>Kubernetes - Using Authorization Plugins</title>
</head>
<body>
<div id="cellophane" onclick="kub.toggleMenu()"></div>
<header>
	<a href="/" class="logo"></a>
	<div class="nav-buttons" data-auto-burger="primary">
		<a href="/docs/" class="button" id="viewDocs" data-auto-burger-exclude>View Documentation</a>
		<a href="/docs/hellonode/" class="button" id="tryKubernetes" data-auto-burger-exclude>Try Kubernetes</a>
		<button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
	</div>

	<nav id="mainNav">
		<main data-auto-burger="primary">
			<div class="nav-box">
				<h3><a href="/docs/hellonode/">Get Started</a></h3>
				<p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>
			</div>
			<div class="nav-box">
				<h3><a href="/docs/">Documentation</a></h3>
				<p>Learn how to use Kubernetes with the use of walkthroughs, samples, and reference documentation. You can even <a href="/editdocs/" data-auto-burger-exclude>help contribute to the docs</a>!</p>
			</div>
			<div class="nav-box">
				<h3><a href="/community/">Community</a></h3>
				<p>If you need help, you can connect with other Kubernetes users and the Kubernetes authors, attend community events, and watch video presentations from around the web.</p>
			</div>
			<div class="nav-box">
				<h3><a href="http://blog.kubernetes.io">Blog</a></h3>
				<p>Read the latest news for Kubernetes and the containers space in general, and get technical how-tos hot off the presses.</p>
			</div>
		</main>
		<main data-auto-burger="primary">
			<div class="left">
				<h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
				<a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>View On Github</a>
			</div>

			<div class="right">
				<h5 class="github-invite">Explore the community</h5>
				<div class="social">
					<a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
					<a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
					<a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
					<a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
					<a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
					<a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
				</div>
			</div>
			<div class="clear" style="clear: both"></div>
		</main>
	</nav>
</header>


<!--  HERO  -->
<section id="hero" class="light-text">
	<h1>Reference Documentation</h1>
	<h5>Design docs, concept definitions, and references for APIs and CLIs.</h5>
	<div id="vendorStrip" class="light-text">
		<ul>
			<li><a href="/docs/" >GUIDES</a></li>
			<li><a href="/docs/reference" class="YAH">REFERENCE</a></li>
			<li><a href="/docs/samples" >SAMPLES</a></li>
			<li><a href="/docs/troubleshooting/" >SUPPORT</a></li>
		</ul>
		<div id="searchBox">
			<input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)">
		</div>
	</div>
</section>

<section id="encyclopedia">
	<div id="docsToc">
        <div class="pi-accordion">
        
    <a class="item" data-title="Reference Documentation" href="/docs/reference/"></a>
<div class="item" data-title="Kubernetes API">
  <div class="container">
    <a class="item" data-title="Kubernetes API Overview" href="/docs/api/"></a>
<div class="item" data-title="Accessing the API">
  <div class="container">
    <a class="item" data-title="Overview" href="/docs/admin/accessing-the-api/"></a>
    <a class="item" data-title="Authenticating" href="/docs/admin/authentication/"></a>
    <a class="item" data-title="Using Authorization Plugins" href="/docs/admin/authorization/"></a>
    <a class="item" data-title="Using Admission Controllers" href="/docs/admin/admission-controllers/"></a>
    <a class="item" data-title="Managing Service Accounts" href="/docs/admin/service-accounts-admin/"></a>
  </div>
</div>
    <a class="item" data-title="Kubernetes API Operations" href="/docs/api-reference/v1/operations/"></a>
    <a class="item" data-title="Kubernetes API Definitions" href="/docs/api-reference/v1/definitions/"></a>
    <a class="item" data-title="Kubernetes API Swagger Spec" href="/kubernetes/third_party/swagger-ui/"></a>
  </div>
</div>
<div class="item" data-title="Autoscaling API">
  <div class="container">
    <a class="item" data-title="Autoscaling API Operations" href="/docs/api-reference/autoscaling/v1/operations/"></a>
    <a class="item" data-title="Autoscaling API Definitions" href="/docs/api-reference/autoscaling/v1/definitions/"></a>
  </div>
</div>
<div class="item" data-title="Batch API">
  <div class="container">
    <a class="item" data-title="Batch API Operations" href="/docs/api-reference/batch/v1/operations/"></a>
    <a class="item" data-title="Batch API Definitions" href="/docs/api-reference/batch/v1/definitions/"></a>
  </div>
</div>
<div class="item" data-title="Extensions API">
  <div class="container">
    <a class="item" data-title="Extensions API Operations" href="/docs/api-reference/extensions/v1beta1/operations/"></a>
    <a class="item" data-title="Extensions API Definitions" href="/docs/api-reference/extensions/v1beta1/definitions/"></a>
  </div>
</div>
<div class="item" data-title="kubectl CLI">
  <div class="container">
    <a class="item" data-title="kubectl Overview" href="/docs/user-guide/kubectl-overview/"></a>
    <a class="item" data-title="kubectl for Docker Users" href="/docs/user-guide/docker-cli-to-kubectl/"></a>
    <a class="item" data-title="kubectl Usage Conventions" href="/docs/user-guide/kubectl-conventions/"></a>
    <a class="item" data-title="JSONpath Support" href="/docs/user-guide/jsonpath/"></a>
    <a class="item" data-title="kubectl Cheat Sheet" href="/docs/user-guide/kubectl-cheatsheet/"></a>
<div class="item" data-title="kubectl Commands">
  <div class="container">
    <a class="item" data-title="kubectl" href="/docs/user-guide/kubectl/kubectl/"></a>
    <a class="item" data-title="kubectl annotate" href="/docs/user-guide/kubectl/kubectl_annotate/"></a>
    <a class="item" data-title="kubectl api-versions" href="/docs/user-guide/kubectl/kubectl_api-versions/"></a>
    <a class="item" data-title="kubectl apply" href="/docs/user-guide/kubectl/kubectl_apply/"></a>
    <a class="item" data-title="kubectl attach" href="/docs/user-guide/kubectl/kubectl_attach/"></a>
    <a class="item" data-title="kubectl autoscale" href="/docs/user-guide/kubectl/kubectl_autoscale/"></a>
    <a class="item" data-title="kubectl cluster-info" href="/docs/user-guide/kubectl/kubectl_cluster-info/"></a>
    <a class="item" data-title="kubectl config" href="/docs/user-guide/kubectl/kubectl_config/"></a>
    <a class="item" data-title="kubectl config current-context" href="/docs/user-guide/kubectl/kubectl_config_current-context/"></a>
    <a class="item" data-title="kubectl config set-cluster" href="/docs/user-guide/kubectl/kubectl_config_set-cluster/"></a>
    <a class="item" data-title="kubectl config set-context" href="/docs/user-guide/kubectl/kubectl_config_set-context/"></a>
    <a class="item" data-title="kubectl config set-credentials" href="/docs/user-guide/kubectl/kubectl_config_set-credentials/"></a>
    <a class="item" data-title="kubectl config set" href="/docs/user-guide/kubectl/kubectl_config_set/"></a>
    <a class="item" data-title="kubectl config unset" href="/docs/user-guide/kubectl/kubectl_config_unset/"></a>
    <a class="item" data-title="kubectl config use-context" href="/docs/user-guide/kubectl/kubectl_config_use-context/"></a>
    <a class="item" data-title="kubectl config view" href="/docs/user-guide/kubectl/kubectl_config_view/"></a>
    <a class="item" data-title="kubectl convert" href="/docs/user-guide/kubectl/kubectl_convert/"></a>
    <a class="item" data-title="kubectl cordon" href="/docs/user-guide/kubectl/kubectl_cordon/"></a>
    <a class="item" data-title="kubectl create" href="/docs/user-guide/kubectl/kubectl_create/"></a>
    <a class="item" data-title="kubectl create configmap" href="/docs/user-guide/kubectl/kubectl_create_configmap/"></a>
    <a class="item" data-title="kubectl create namespace" href="/docs/user-guide/kubectl/kubectl_create_namespace/"></a>
    <a class="item" data-title="kubectl create secret docker-registry" href="/docs/user-guide/kubectl/kubectl_create_secret_docker-registry/"></a>
    <a class="item" data-title="kubectl create secret" href="/docs/user-guide/kubectl/kubectl_create_secret/"></a>
    <a class="item" data-title="kubectl create secret generic" href="/docs/user-guide/kubectl/kubectl_create_secret_generic/"></a>
    <a class="item" data-title="kubectl create serviceaccount" href="/docs/user-guide/kubectl/kubectl_create_serviceaccount/"></a>
    <a class="item" data-title="kubectl delete" href="/docs/user-guide/kubectl/kubectl_delete/"></a>
    <a class="item" data-title="kubectl describe" href="/docs/user-guide/kubectl/kubectl_describe/"></a>
    <a class="item" data-title="kubectl drain" href="/docs/user-guide/kubectl/kubectl_drain/"></a>
    <a class="item" data-title="kubectl edit" href="/docs/user-guide/kubectl/kubectl_edit/"></a>
    <a class="item" data-title="kubectl exec" href="/docs/user-guide/kubectl/kubectl_exec/"></a>
    <a class="item" data-title="kubectl explain" href="/docs/user-guide/kubectl/kubectl_explain/"></a>
    <a class="item" data-title="kubectl expose" href="/docs/user-guide/kubectl/kubectl_expose/"></a>
    <a class="item" data-title="kubectl get" href="/docs/user-guide/kubectl/kubectl_get/"></a>
    <a class="item" data-title="kubectl label" href="/docs/user-guide/kubectl/kubectl_label/"></a>
    <a class="item" data-title="kubectl logs" href="/docs/user-guide/kubectl/kubectl_logs/"></a>
    <a class="item" data-title="kubectl patch" href="/docs/user-guide/kubectl/kubectl_patch/"></a>
    <a class="item" data-title="kubectl port-forward" href="/docs/user-guide/kubectl/kubectl_port-forward/"></a>
    <a class="item" data-title="kubectl proxy" href="/docs/user-guide/kubectl/kubectl_proxy/"></a>
    <a class="item" data-title="kubectl replace" href="/docs/user-guide/kubectl/kubectl_replace/"></a>
    <a class="item" data-title="kubectl rolling-update" href="/docs/user-guide/kubectl/kubectl_rolling-update/"></a>
    <a class="item" data-title="kubectl rollout" href="/docs/user-guide/kubectl/kubectl_rollout/"></a>
    <a class="item" data-title="kubectl rollout history" href="/docs/user-guide/kubectl/kubectl_rollout_history/"></a>
    <a class="item" data-title="kubectl rollout pause" href="/docs/user-guide/kubectl/kubectl_rollout_pause/"></a>
    <a class="item" data-title="kubectl rollout resume" href="/docs/user-guide/kubectl/kubectl_rollout_resume/"></a>
    <a class="item" data-title="kubectl rollout undo" href="/docs/user-guide/kubectl/kubectl_rollout_undo/"></a>
    <a class="item" data-title="kubectl run" href="/docs/user-guide/kubectl/kubectl_run/"></a>
    <a class="item" data-title="kubectl scale" href="/docs/user-guide/kubectl/kubectl_scale/"></a>
    <a class="item" data-title="kubectl uncordon" href="/docs/user-guide/kubectl/kubectl_uncordon/"></a>
    <a class="item" data-title="kubectl version" href="/docs/user-guide/kubectl/kubectl_version/"></a>
<div class="item" data-title="Superseded and Deprecated Commands">
  <div class="container">
    <a class="item" data-title="kubectl namespace" href="/docs/user-guide/kubectl/kubectl_namespace/"></a>
    <a class="item" data-title="kubectl stop" href="/docs/user-guide/kubectl/kubectl_stop/"></a>
  </div>
</div>
  </div>
</div>
  </div>
</div>
<div class="item" data-title="Kubernetes Components">
  <div class="container">
    <a class="item" data-title="kube-apiserver" href="/docs/admin/kube-apiserver/"></a>
    <a class="item" data-title="kube-controller-manager" href="/docs/admin/kube-controller-manager/"></a>
    <a class="item" data-title="kube-proxy" href="/docs/admin/kube-proxy/"></a>
    <a class="item" data-title="kube-scheduler" href="/docs/admin/kube-scheduler/"></a>
    <a class="item" data-title="kubelet" href="/docs/admin/kubelet/"></a>
  </div>
</div>
<div class="item" data-title="Glossary">
  <div class="container">
    <a class="item" data-title="Annotations" href="/docs/user-guide/annotations/"></a>
    <a class="item" data-title="Daemon Sets" href="/docs/admin/daemons/"></a>
    <a class="item" data-title="Deployments" href="/docs/user-guide/deployments/"></a>
    <a class="item" data-title="Horizontal Pod Autoscaling" href="/docs/user-guide/horizontal-pod-autoscaling/"></a>
    <a class="item" data-title="Images" href="/docs/user-guide/images/"></a>
    <a class="item" data-title="Ingress Resources" href="/docs/user-guide/ingress/"></a>
    <a class="item" data-title="Jobs" href="/docs/user-guide/jobs/"></a>
    <a class="item" data-title="Labels and Selectors" href="/docs/user-guide/labels/"></a>
    <a class="item" data-title="Names" href="/docs/user-guide/identifiers/"></a>
    <a class="item" data-title="Namespaces" href="/docs/user-guide/namespaces/"></a>
    <a class="item" data-title="Network Policies" href="/docs/user-guide/networkpolicies/"></a>
    <a class="item" data-title="Nodes" href="/docs/admin/node/"></a>
    <a class="item" data-title="Persistent Volumes" href="/docs/user-guide/persistent-volumes/"></a>
    <a class="item" data-title="Pet Sets" href="/docs/user-guide/petset/"></a>
    <a class="item" data-title="Pods" href="/docs/user-guide/pods/"></a>
    <a class="item" data-title="Replica Sets" href="/docs/user-guide/replicasets/"></a>
    <a class="item" data-title="Replication Controller" href="/docs/user-guide/replication-controller/"></a>
    <a class="item" data-title="Resource Quotas" href="/docs/admin/resource-quota/"></a>
    <a class="item" data-title="Secrets" href="/docs/user-guide/secrets/"></a>
    <a class="item" data-title="Security Context" href="/docs/user-guide/security-context/"></a>
    <a class="item" data-title="Services" href="/docs/user-guide/services/"></a>
    <a class="item" data-title="Service Accounts" href="/docs/user-guide/service-accounts/"></a>
    <a class="item" data-title="Volumes" href="/docs/user-guide/volumes/"></a>
  </div>
</div>
<div class="item" data-title="Kubernetes Design Docs">
  <div class="container">
    <a class="item" data-title="Kubernetes Architecture" href="https://github.com/kubernetes/kubernetes/blob/release-1.3/docs/design/architecture.md" target='_blank'></a>
    <a class="item" data-title="Kubernetes Design Overview" href="https://github.com/kubernetes/kubernetes/blob/release-1.3/docs/design/" target='_blank'></a>
    <a class="item" data-title="Kubernetes Identity and Access Management" href="https://github.com/kubernetes/kubernetes/blob/release-1.3/docs/design/access.md" target='_blank'></a>
    <a class="item" data-title="Kubernetes OpenVSwitch GRE/VxLAN networking" href="/docs/admin/ovs-networking/"></a>
    <a class="item" data-title="Security Contexts" href="https://github.com/kubernetes/kubernetes/blob/release-1.3/docs/design/security_context.md" target='_blank'></a>
    <a class="item" data-title="Security in Kubernetes" href="https://github.com/kubernetes/kubernetes/blob/release-1.3/docs/design/security.md" target='_blank'></a>
  </div>
</div>
        </div> <!-- /pi-accordion -->
		<button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
	</div> <!-- /docsToc -->
	<div id="docsContent">
        <p><a href="/editdocs#docs/admin/authorization.md" id="editPageButton">Edit This Page</a></p>
    	<h1>Using Authorization Plugins</h1>
		<p>In Kubernetes, authorization happens as a separate step from authentication.
See the <a href="/docs/admin/accessing-the-api/">Accessing Control Overview</a> for an
overview of how authentication and authorization are applied to requests.</p>

<p>Authorization applies to all HTTP accesses on the main (secure) apiserver port.</p>

<p>The authorization check for any request compares attributes of the context of
the request, (such as user, resource, and namespace) with access
policies.  An API call must be allowed by some policy in order to proceed.</p>

<p>The following implementations are available, and are selected by flag:</p>

<ul>
  <li><code class="highlighter-rouge">--authorization-mode=AlwaysDeny</code> blocks all requests (used in tests).</li>
  <li><code class="highlighter-rouge">--authorization-mode=AlwaysAllow</code> allows all requests; use if you don’t
need authorization.</li>
  <li><code class="highlighter-rouge">--authorization-mode=ABAC</code> allows for a simple local-file-based user-configured
authorization policy.  ABAC stands for Attribute-Based Access Control.
authorization policy.</li>
  <li><code class="highlighter-rouge">--authorization-mode=RBAC</code> is an experimental implementation which allows
for authorization to be driven by the Kubernetes API.
RBAC stands for Roles-Based Access Control.</li>
  <li><code class="highlighter-rouge">--authorization-mode=Webhook</code> allows for authorization to be driven by a
remote service using REST.</li>
</ul>

<p>If multiple modes are provided the set is unioned, and only a single authorizer is required to admit the action.  This means the flag:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>--authorization-mode=AlwaysDeny,AlwaysAllow
</code></pre>
</div>

<p>will always allow.</p>

<h2 id="request-attributes">Request Attributes</h2>

<p>A request has the following attributes that can be considered for authorization:</p>

<ul>
  <li>user (the user-string which a user was authenticated as).</li>
  <li>group (the list of group names the authenticated user is a member of).</li>
  <li>“extra” (a map of arbitrary string keys to string values, provided by the authentication layer)</li>
  <li>whether the request is for an API resource.</li>
  <li>the request path.
    <ul>
      <li>allows authorizing access to miscellaneous non-resource endpoints like <code class="highlighter-rouge">/api</code> or <code class="highlighter-rouge">/healthz</code> (see <a href="#kubectl">kubectl</a>).</li>
    </ul>
  </li>
  <li>the request verb.
    <ul>
      <li>API verbs <code class="highlighter-rouge">get</code>, <code class="highlighter-rouge">list</code>, <code class="highlighter-rouge">create</code>, <code class="highlighter-rouge">update</code>, <code class="highlighter-rouge">patch</code>, <code class="highlighter-rouge">watch</code>, <code class="highlighter-rouge">proxy</code>, <code class="highlighter-rouge">redirect</code>, <code class="highlighter-rouge">delete</code>, and <code class="highlighter-rouge">deletecollection</code> are used for resource requests</li>
      <li>HTTP verbs <code class="highlighter-rouge">get</code>, <code class="highlighter-rouge">post</code>, <code class="highlighter-rouge">put</code>, and <code class="highlighter-rouge">delete</code> are used for non-resource requests</li>
    </ul>
  </li>
  <li>what resource is being accessed (for resource requests only)</li>
  <li>what subresource is being accessed (for resource requests only)</li>
  <li>the namespace of the object being accessed (for namespaced resource requests only)</li>
  <li>the API group being accessed (for resource requests only)</li>
</ul>

<p>The request verb for a resource API endpoint can be determined by the HTTP verb used and whether or not the request acts on an individual resource or a collection of resources:</p>

<table>
  <thead>
    <tr>
      <th>HTTP verb</th>
      <th>request verb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>POST</td>
      <td>create</td>
    </tr>
    <tr>
      <td>GET, HEAD</td>
      <td>get (for individual resources), list (for collections)</td>
    </tr>
    <tr>
      <td>PUT</td>
      <td>update</td>
    </tr>
    <tr>
      <td>PATCH</td>
      <td>patch</td>
    </tr>
    <tr>
      <td>DELETE</td>
      <td>delete (for individual resources), deletecollection (for collections)</td>
    </tr>
  </tbody>
</table>

<h2 id="abac-mode">ABAC Mode</h2>

<h3 id="policy-file-format">Policy File Format</h3>

<p>For mode <code class="highlighter-rouge">ABAC</code>, also specify <code class="highlighter-rouge">--authorization-policy-file=SOME_FILENAME</code>.</p>

<p>The file format is <a href="http://jsonlines.org/">one JSON object per line</a>.  There
should be no enclosing list or map, just one map per line.</p>

<p>Each line is a “policy object”.  A policy object is a map with the following
properties:</p>

<ul>
  <li>Versioning properties:
    <ul>
      <li><code class="highlighter-rouge">apiVersion</code>, type string; valid values are “abac.authorization.kubernetes.io/v1beta1”. Allows versioning and conversion of the policy format.</li>
      <li><code class="highlighter-rouge">kind</code>, type string: valid values are “Policy”. Allows versioning and conversion of the policy format.</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">spec</code> property set to a map with the following properties:
    <ul>
      <li>Subject-matching properties:
        <ul>
          <li><code class="highlighter-rouge">user</code>, type string; the user-string from <code class="highlighter-rouge">--token-auth-file</code>. If you specify <code class="highlighter-rouge">user</code>, it must match the username of the authenticated user. <code class="highlighter-rouge">*</code> matches all requests.</li>
          <li><code class="highlighter-rouge">group</code>, type string; if you specify <code class="highlighter-rouge">group</code>, it must match one of the groups of the authenticated user. <code class="highlighter-rouge">*</code> matches all requests.</li>
        </ul>
      </li>
      <li><code class="highlighter-rouge">readonly</code>, type boolean, when true, means that the policy only applies to get, list, and watch operations.</li>
      <li>Resource-matching properties:
        <ul>
          <li><code class="highlighter-rouge">apiGroup</code>, type string; an API group, such as <code class="highlighter-rouge">extensions</code>. <code class="highlighter-rouge">*</code> matches all API groups.</li>
          <li><code class="highlighter-rouge">namespace</code>, type string; a namespace string. <code class="highlighter-rouge">*</code> matches all resource requests.</li>
          <li><code class="highlighter-rouge">resource</code>, type string; a resource, such as <code class="highlighter-rouge">pods</code>. <code class="highlighter-rouge">*</code> matches all resource requests.</li>
        </ul>
      </li>
      <li>Non-resource-matching properties:</li>
      <li><code class="highlighter-rouge">nonResourcePath</code>, type string; matches the non-resource request paths (like <code class="highlighter-rouge">/version</code> and <code class="highlighter-rouge">/apis</code>). <code class="highlighter-rouge">*</code> matches all non-resource requests. <code class="highlighter-rouge">/foo/*</code> matches <code class="highlighter-rouge">/foo/</code> and all of its subpaths.</li>
    </ul>
  </li>
</ul>

<p>An unset property is the same as a property set to the zero value for its type
(e.g. empty string, 0, false). However, unset should be preferred for
readability.</p>

<p>In the future, policies may be expressed in a JSON format, and managed via a
REST interface.</p>

<h3 id="authorization-algorithm">Authorization Algorithm</h3>

<p>A request has attributes which correspond to the properties of a policy object.</p>

<p>When a request is received, the attributes are determined.  Unknown attributes
are set to the zero value of its type (e.g. empty string, 0, false).</p>

<p>A property set to <code class="highlighter-rouge">"*"</code> will match any value of the corresponding attribute.</p>

<p>The tuple of attributes is checked for a match against every policy in the
policy file. If at least one line matches the request attributes, then the
request is authorized (but may fail later validation).</p>

<p>To permit any user to do something, write a policy with the user property set to
<code class="highlighter-rouge">"*"</code>.</p>

<p>To permit a user to do anything, write a policy with the apiGroup, namespace,
resource, and nonResourcePath properties set to <code class="highlighter-rouge">"*"</code>.</p>

<h3 id="kubectl">Kubectl</h3>

<p>Kubectl uses the <code class="highlighter-rouge">/api</code> and <code class="highlighter-rouge">/apis</code> endpoints of api-server to negotiate
client/server versions. To validate objects sent to the API by create/update
operations, kubectl queries certain swagger resources. For API version <code class="highlighter-rouge">v1</code>
those would be <code class="highlighter-rouge">/swaggerapi/api/v1</code> &amp; <code class="highlighter-rouge">/swaggerapi/experimental/v1</code>.</p>

<p>When using ABAC authorization, those special resources have to be explicitly
exposed via the <code class="highlighter-rouge">nonResourcePath</code> property in a policy (see <a href="#examples">examples</a> below):</p>

<ul>
  <li><code class="highlighter-rouge">/api</code>, <code class="highlighter-rouge">/api/*</code>, <code class="highlighter-rouge">/apis</code>, and <code class="highlighter-rouge">/apis/*</code> for API version negotiation.</li>
  <li><code class="highlighter-rouge">/version</code> for retrieving the server version via <code class="highlighter-rouge">kubectl version</code>.</li>
  <li><code class="highlighter-rouge">/swaggerapi/*</code> for create/update operations.</li>
</ul>

<p>To inspect the HTTP calls involved in a specific kubectl operation you can turn
up the verbosity:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>kubectl --v=8 version
</code></pre>
</div>

<h3 id="examples">Examples</h3>

<ol>
  <li>
    <p>Alice can do anything to all resources:</p>

    <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="nt">"apiVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abac.authorization.kubernetes.io/v1beta1"</span><span class="p">,</span><span class="w"> </span><span class="nt">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Policy"</span><span class="p">,</span><span class="w"> </span><span class="nt">"spec"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"alice"</span><span class="p">,</span><span class="w"> </span><span class="nt">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="p">,</span><span class="w"> </span><span class="nt">"resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="p">,</span><span class="w"> </span><span class="nt">"apiGroup"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="p">}}</span><span class="w">
</span></code></pre>
    </div>
  </li>
  <li>
    <p>Kubelet can read any pods:</p>

    <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="nt">"apiVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abac.authorization.kubernetes.io/v1beta1"</span><span class="p">,</span><span class="w"> </span><span class="nt">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Policy"</span><span class="p">,</span><span class="w"> </span><span class="nt">"spec"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kubelet"</span><span class="p">,</span><span class="w"> </span><span class="nt">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="p">,</span><span class="w"> </span><span class="nt">"resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pods"</span><span class="p">,</span><span class="w"> </span><span class="nt">"readonly"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">}}</span><span class="w">
</span></code></pre>
    </div>
  </li>
  <li>
    <p>Kubelet can read and write events:</p>

    <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="nt">"apiVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abac.authorization.kubernetes.io/v1beta1"</span><span class="p">,</span><span class="w"> </span><span class="nt">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Policy"</span><span class="p">,</span><span class="w"> </span><span class="nt">"spec"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kubelet"</span><span class="p">,</span><span class="w"> </span><span class="nt">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="p">,</span><span class="w"> </span><span class="nt">"resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"events"</span><span class="p">}}</span><span class="w">
</span></code></pre>
    </div>
  </li>
  <li>
    <p>Bob can just read pods in namespace “projectCaribou”:</p>

    <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="nt">"apiVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abac.authorization.kubernetes.io/v1beta1"</span><span class="p">,</span><span class="w"> </span><span class="nt">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Policy"</span><span class="p">,</span><span class="w"> </span><span class="nt">"spec"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bob"</span><span class="p">,</span><span class="w"> </span><span class="nt">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"projectCaribou"</span><span class="p">,</span><span class="w"> </span><span class="nt">"resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pods"</span><span class="p">,</span><span class="w"> </span><span class="nt">"readonly"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">}}</span><span class="w">
</span></code></pre>
    </div>
  </li>
  <li>
    <p>Anyone can make read-only requests to all non-resource paths:</p>

    <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="nt">"apiVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abac.authorization.kubernetes.io/v1beta1"</span><span class="p">,</span><span class="w"> </span><span class="nt">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Policy"</span><span class="p">,</span><span class="w"> </span><span class="nt">"spec"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="p">,</span><span class="w"> </span><span class="nt">"readonly"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nt">"nonResourcePath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="p">}}</span><span class="w">
</span></code></pre>
    </div>
  </li>
</ol>

<p><a href="http://releases.k8s.io/master/pkg/auth/authorizer/abac/example_policy_file.jsonl">Complete file example</a></p>

<h3 id="a-quick-note-on-service-accounts">A quick note on service accounts</h3>

<p>A service account automatically generates a user. The user’s name is generated
according to the naming convention:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>system:serviceaccount:&lt;namespace&gt;:&lt;serviceaccountname&gt;
</code></pre>
</div>
<p>Creating a new namespace also causes a new service account to be created, of
this form:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>system:serviceaccount:&lt;namespace&gt;:default
</code></pre>
</div>

<p>For example, if you wanted to grant the default service account in the
kube-system full privilege to the API, you would add this line to your policy
file:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="nt">"apiVersion"</span><span class="p">:</span><span class="s2">"abac.authorization.kubernetes.io/v1beta1"</span><span class="p">,</span><span class="nt">"kind"</span><span class="p">:</span><span class="s2">"Policy"</span><span class="p">,</span><span class="nt">"spec"</span><span class="p">:{</span><span class="nt">"user"</span><span class="p">:</span><span class="s2">"system:serviceaccount:kube-system:default"</span><span class="p">,</span><span class="nt">"namespace"</span><span class="p">:</span><span class="s2">"*"</span><span class="p">,</span><span class="nt">"resource"</span><span class="p">:</span><span class="s2">"*"</span><span class="p">,</span><span class="nt">"apiGroup"</span><span class="p">:</span><span class="s2">"*"</span><span class="p">}}</span><span class="w">
</span></code></pre>
</div>

<p>The apiserver will need to be restarted to pickup the new policy lines.</p>

<h2 id="rbac-mode">RBAC Mode</h2>

<p>When specified “RBAC” (Role-Based Access Control) uses the
“rbac.authorization.k8s.io” API group to drive authorization decisions,
allowing admins to dynamically configure permission policies through the
Kubernetes API.</p>

<p>As of 1.3 RBAC mode is in alpha and considered experimental.</p>

<p>To use RBAC, you must both enable the authorization module with <code class="highlighter-rouge">--authorization-mode=RBAC</code>,
and <a href="docs/admin/cluster-management.md/#Turn-on-or-off-an-api-version-for-your-cluster">enable the API version</a>,
with a <code class="highlighter-rouge">--runtime-config=</code> that includes <code class="highlighter-rouge">rbac.authorization.k8s.io/v1alpha1</code>.</p>

<h3 id="roles-rolesbindings-clusterroles-and-clusterrolebindings">Roles, RolesBindings, ClusterRoles, and ClusterRoleBindings</h3>

<p>The RBAC API Group declares four top level types which will be covered in this
section. Users can interact with these resources as they would with any other
API resource. Through <code class="highlighter-rouge">kubectl</code>, direct calls to the API, etc. For instance,
<code class="highlighter-rouge">kubectl create -f (resource).yml</code> can be used with any of these examples,
though readers who wish to follow along should review the following section on
bootstrapping first.</p>

<p>In the RBAC API Group, roles hold a logical grouping of permissions. These
permissions map very closely to ABAC policies, but only contain information
about requests being made. Permission are purely additive, rules may only omit
permissions they do not wish to grant.</p>

<p>Here’s an example of a role which grants read access to pods within the
“default” namespace.</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">kind</span><span class="pi">:</span> <span class="s">Role</span>
<span class="s">apiVersion</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io/v1alpha1</span>
<span class="s">metadata</span><span class="pi">:</span>
  <span class="s">namespace</span><span class="pi">:</span> <span class="s">default</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">pod-reader</span>
<span class="s">rules</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">apiGroups</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">"</span><span class="pi">]</span> <span class="c1"># The API group "" indicates the default API Group.</span>
    <span class="s">resources</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">pods"</span><span class="pi">]</span>
    <span class="s">verbs</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">get"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">watch"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">list"</span><span class="pi">]</span>
    <span class="s">nonResourceURLs</span><span class="pi">:</span> <span class="pi">[]</span>
</code></pre>
</div>

<p><code class="highlighter-rouge">ClusterRoles</code> hold the same information as a <code class="highlighter-rouge">Role</code> but can apply to any
namespace as well as non-namespaced resources (such as <code class="highlighter-rouge">Nodes</code>,
<code class="highlighter-rouge">PersistentVolume</code>, etc.). The following <code class="highlighter-rouge">ClusterRole</code> can grant permissions to
read secrets in any namespace.</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">kind</span><span class="pi">:</span> <span class="s">ClusterRole</span>
<span class="s">apiVersion</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io/v1alpha1</span>
<span class="s">metadata</span><span class="pi">:</span>
  <span class="c1"># "namespace" omitted since ClusterRoles are not namespaced.</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">secret-reader</span>
<span class="s">rules</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">apiGroups</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">"</span><span class="pi">]</span>
    <span class="s">resources</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">secrets"</span><span class="pi">]</span>
    <span class="s">verbs</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">get"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">watch"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">list"</span><span class="pi">]</span>
    <span class="s">nonResourceURLs</span><span class="pi">:</span> <span class="pi">[]</span>
</code></pre>
</div>

<p><code class="highlighter-rouge">RoleBindings</code> perform the task of granting the permission to a user or set of
users. They hold a list of subjects which they apply to, and a reference to the
<code class="highlighter-rouge">Role</code> being assigned.</p>

<p>The following <code class="highlighter-rouge">RoleBinding</code> assigns the “pod-reader” role to the user “jane”
within the “default” namespace, and allows jane to read pods.</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="c1"># This role binding allows "jane" to read pods in the namespace "default"</span>
<span class="s">kind</span><span class="pi">:</span> <span class="s">RoleBinding</span>
<span class="s">apiVersion</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io/v1alpha1</span>
<span class="s">metadata</span><span class="pi">:</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">read-pods</span>
  <span class="s">namespace</span><span class="pi">:</span> <span class="s">default</span>
<span class="s">subjects</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">kind</span><span class="pi">:</span> <span class="s">User</span> <span class="c1"># May be "User", "Group" or "ServiceAccount"</span>
    <span class="s">name</span><span class="pi">:</span> <span class="s">jane</span>
<span class="s">roleRef</span><span class="pi">:</span>
  <span class="s">kind</span><span class="pi">:</span> <span class="s">Role</span>
  <span class="s">namespace</span><span class="pi">:</span> <span class="s">default</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">pod-reader</span>
  <span class="s">apiVersion</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io/v1alpha1</span>
</code></pre>
</div>

<p><code class="highlighter-rouge">RoleBindings</code> may also refer to a <code class="highlighter-rouge">ClusterRole</code>. However, a <code class="highlighter-rouge">RoleBinding</code> that
refers to a <code class="highlighter-rouge">ClusterRole</code> only applies in the <code class="highlighter-rouge">RoleBinding</code>’s namespace, not at
the cluster level. This allows admins to define a set of common roles for the
entire cluster, then reuse them in multiple namespaces.</p>

<p>For instance, even though the following <code class="highlighter-rouge">RoleBinding</code> refers to a <code class="highlighter-rouge">ClusterRole</code>,
“dave” (the subject) will only be able read secrets in the “development”
namespace, the namespace of the <code class="highlighter-rouge">RoleBinding</code>.</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="c1"># This role binding allows "dave" to read secrets in the namespace "development"</span>
<span class="s">kind</span><span class="pi">:</span> <span class="s">RoleBinding</span>
<span class="s">apiVersion</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io/v1alpha1</span>
<span class="s">metadata</span><span class="pi">:</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">read-secrets</span>
  <span class="s">namespace</span><span class="pi">:</span> <span class="s">development</span> <span class="c1"># This binding only applies in the "development" namespace</span>
<span class="s">subjects</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">kind</span><span class="pi">:</span> <span class="s">User</span> <span class="c1"># May be "User", "Group" or "ServiceAccount"</span>
    <span class="s">name</span><span class="pi">:</span> <span class="s">dave</span>
<span class="s">roleRef</span><span class="pi">:</span>
  <span class="s">kind</span><span class="pi">:</span> <span class="s">ClusterRole</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">secret-reader</span>
  <span class="s">apiVersion</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io/v1alpha1</span>
</code></pre>
</div>

<p>Finally a <code class="highlighter-rouge">ClusterRoleBinding</code> may be used to grant permissions in all
namespaces. The following <code class="highlighter-rouge">ClusterRoleBinding</code> allows any user in the group
“manager” to read secrets in any namepsace.</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="c1"># This cluster role binding allows anyone in the "manager" group to read secrets in any namespace.</span>
<span class="s">kind</span><span class="pi">:</span> <span class="s">ClusterRoleBinding</span>
<span class="s">apiVersion</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io/v1alpha1</span>
<span class="s">metadata</span><span class="pi">:</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">read-secrets</span>
<span class="s">subjects</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">kind</span><span class="pi">:</span> <span class="s">Group</span> <span class="c1"># May be "User", "Group" or "ServiceAccount"</span>
    <span class="s">name</span><span class="pi">:</span> <span class="s">manager</span>
<span class="s">roleRef</span><span class="pi">:</span>
  <span class="s">kind</span><span class="pi">:</span> <span class="s">ClusterRole</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">secret-reader</span>
  <span class="s">apiVersion</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io/v1alpha1</span>
</code></pre>
</div>

<h3 id="privilege-escalation-prevention-and-bootstrapping">Privilege Escalation Prevention and Bootstrapping</h3>

<p>The <code class="highlighter-rouge">rbac.authorization.k8s.io</code> API group inherently attempts to prevent users
from escalating privileges. Simply put, <strong>a user can’t grant permissions they
don’t already have even when the RBAC authorizer it disabled</strong>. If “user-1”
does not have the ability to read secrets in “namespace-a”, they cannot create
a binding that would grant that permission to themselves or any other user.</p>

<p>For bootstrapping the first roles, it becomes necessary for someone to get
around these limitations. For the alpha release of RBAC, an API Server flag was
added to allow one user to step around all RBAC authorization and privilege
escalation checks. NOTE: <em>This is subject to change with future releases.</em></p>

<div class="highlighter-rouge"><pre class="highlight"><code>--authorization-rbac-super-user=admin
</code></pre>
</div>

<p>Once set the specified super user, in this case “admin”, can be used to create
the roles and role bindings to initialize the system.</p>

<p>This flag is optional and once the initial bootstrapping is performed can be
unset.</p>

<h2 id="webhook-mode">Webhook Mode</h2>

<p>When specified, mode <code class="highlighter-rouge">Webhook</code> causes Kubernetes to query an outside REST
service when determining user privileges.</p>

<h3 id="configuration-file-format">Configuration File Format</h3>

<p>Mode <code class="highlighter-rouge">Webhook</code> requires a file for HTTP configuration, specify by the
<code class="highlighter-rouge">--authorization-webhook-config-file=SOME_FILENAME</code> flag.</p>

<p>The configuration file uses the <a href="/docs/user-guide/kubeconfig-file/">kubeconfig</a>
file format. Within the file “users” refers to the API Server webhook and
“clusters” refers to the remote service.</p>

<p>A configuration example which uses HTTPS client auth:</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="c1"># clusters refers to the remote service.</span>
<span class="s">clusters</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">name</span><span class="pi">:</span> <span class="s">name-of-remote-authz-service</span>
    <span class="s">cluster</span><span class="pi">:</span>
      <span class="s">certificate-authority</span><span class="pi">:</span> <span class="s">/path/to/ca.pem</span>      <span class="c1"># CA for verifying the remote service.</span>
      <span class="s">server</span><span class="pi">:</span> <span class="s">https://authz.example.com/authorize</span> <span class="c1"># URL of remote service to query. Must use 'https'.</span>

<span class="c1"># users refers to the API Server's webhook configuration.</span>
<span class="s">users</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">name</span><span class="pi">:</span> <span class="s">name-of-api-server</span>
    <span class="s">user</span><span class="pi">:</span>
      <span class="s">client-certificate</span><span class="pi">:</span> <span class="s">/path/to/cert.pem</span> <span class="c1"># cert for the webhook plugin to use</span>
      <span class="s">client-key</span><span class="pi">:</span> <span class="s">/path/to/key.pem</span>          <span class="c1"># key matching the cert</span>

<span class="c1"># kubeconfig files require a context. Provide one for the API Server.</span>
<span class="s">current-context</span><span class="pi">:</span> <span class="s">webhook</span>
<span class="s">contexts</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">context</span><span class="pi">:</span>
    <span class="s">cluster</span><span class="pi">:</span> <span class="s">name-of-remote-authz-service</span>
    <span class="s">user</span><span class="pi">:</span> <span class="s">name-of-api-sever</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">webhook</span>
</code></pre>
</div>

<h3 id="request-payloads">Request Payloads</h3>

<p>When faced with an authorization decision, the API Server POSTs a JSON
serialized api.authorization.v1beta1.SubjectAccessReview object describing the
action. This object contains fields describing the user attempting to make the
request, and either details about the resource being accessed or requests
attributes.</p>

<p>Note that webhook API objects are subject to the same <a href="/docs/api/">versioning compatibility rules</a>
as other Kubernetes API objects. Implementers should be aware of loser
compatibility promises for beta objects and check the “apiVersion” field of the
request to ensure correct deserialization. Additionally, the API Server must
enable the <code class="highlighter-rouge">authorization.k8s.io/v1beta1</code> API extensions group (<code class="highlighter-rouge">--runtime-config=authorization.k8s.io/v1beta1=true</code>).</p>

<p>An example request body:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"apiVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"authorization.k8s.io/v1beta1"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SubjectAccessReview"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"spec"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"resourceAttributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kittensandponies"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"verb"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pods"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jane"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"group"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"group1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"group2"</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>The remote service is expected to fill the SubjectAccessReviewStatus field of
the request and respond to either allow or disallow access. The response body’s
“spec” field is ignored and may be omitted. A permissive response would return:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"apiVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"authorization.k8s.io/v1beta1"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SubjectAccessReview"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"allowed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>To disallow access, the remote service would return:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"apiVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"authorization.k8s.io/v1beta1"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SubjectAccessReview"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"allowed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user does not have read access to the namespace"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>Access to non-resource paths are sent as:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"apiVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"authorization.k8s.io/v1beta1"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SubjectAccessReview"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"spec"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"nonResourceAttributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/debug"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"verb"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jane"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"group"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"group1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"group2"</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>Non-resource paths include: <code class="highlighter-rouge">/api</code>, <code class="highlighter-rouge">/apis</code>, <code class="highlighter-rouge">/metrics</code>, <code class="highlighter-rouge">/resetMetrics</code>,
<code class="highlighter-rouge">/logs</code>, <code class="highlighter-rouge">/debug</code>, <code class="highlighter-rouge">/healthz</code>, <code class="highlighter-rouge">/swagger-ui/</code>, <code class="highlighter-rouge">/swaggerapi/</code>, <code class="highlighter-rouge">/ui</code>, and
<code class="highlighter-rouge">/version.</code> Clients require access to <code class="highlighter-rouge">/api</code>, <code class="highlighter-rouge">/api/*/</code>, <code class="highlighter-rouge">/apis/</code>, <code class="highlighter-rouge">/apis/*</code>,
<code class="highlighter-rouge">/apis/*/*</code>, and <code class="highlighter-rouge">/version</code> to discover what resources and versions are present
on the server. Access to other non-resource paths can be disallowed without
restricting access to the REST api.</p>

<p>For further documentation refer to the authorization.v1beta1 API objects and
plugin/pkg/auth/authorizer/webhook/webhook.go.</p>

<h2 id="module-development">Module Development</h2>

<p>Other implementations can be developed fairly easily.
The APIserver calls the Authorizer interface:</p>

<div class="language-go highlighter-rouge"><pre class="highlight"><code><span class="k">type</span><span class="x"> </span><span class="n">Authorizer</span><span class="x"> </span><span class="k">interface</span><span class="x"> </span><span class="p">{</span><span class="x">
  </span><span class="n">Authorize</span><span class="p">(</span><span class="n">a</span><span class="x"> </span><span class="n">Attributes</span><span class="p">)</span><span class="x"> </span><span class="kt">error</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre>
</div>

<p>to determine whether or not to allow each API action.</p>

<p>An authorization plugin is a module that implements this interface.
Authorization plugin code goes in <code class="highlighter-rouge">pkg/auth/authorizer/$MODULENAME</code>.</p>

<p>An authorization module can be completely implemented in go, or can call out
to a remote authorization service.  Authorization modules can implement
their own caching to reduce the cost of repeated authorization calls with the
same or similar arguments.  Developers should then consider the interaction
between caching and revocation of permissions.</p>

        <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/admin/authorization.md?pixel" alt="Analytics" /></a>
        <div id="pd_rating_holder_8345992"></div>
		<script type="text/javascript">
	        PDRTJS_settings_8345992 = {
		        "id" : "8345992",
		        "unique_id" : "/docs/admin/authorization/",
		        "title" : "Using Authorization Plugins",
		        "permalink" : "http://kubernetes.github.io/docs/admin/authorization/"
	        };
	        (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
        </script>
	</div>
</section>

<footer>
	<main class="light-text">
		<nav>
			<a href="/docs/hellonode/">Get Started</a>
			<a href="/docs/">Documentation</a>
			<a href="http://blog.kubernetes.io/">Blog</a>
			<a href="/community/">Community</a>
		</nav>
		<div class="social">
			<div>
				<a href="https://twitter.com/kubernetesio" class="twitter"><span>twitter</span></a>
				<a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
				<a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
			</div>
			<div>
				<a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
				<a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
				<a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
			</div>
			<div>
				<span>I wish this page</span>
				<input type="text" id="wishField" name="wishField" placeholder="enter your wish">
			</div>
		</div>
		<div id="miceType" class="center">&copy; 2016 Kubernetes</div>
	</main>
</footer>


<button class="flyout-button" onclick="kub.toggleToc()"></button>

<style>
	.cse .gsc-control-cse, .gsc-control-cse, {
		padding: 0;
	}
	.gsc-control-cse table, .gsc-control-cse-en table {
		margin:0px !important;
	}

	.gsc-above-wrapper-area {
		border-bottom: 0;
	}
</style>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36037335-10', 'auto');
  ga('send', 'pageview');
</script>
<!-- Commenting out AnswerDash for now; we need to work on our list of questions/answers/design first
<!-- Start of AnswerDash script <script>var AnswerDash;!function(e,t,n,s,a){if(!t.getElementById(s)){var i,r=t.createElement(n),c=t.getElementsByTagName(n)[0];e[a]||(i=e[a]=function(){i.__oninit.push(arguments)},i.__oninit=[]),r.type="text/javascript",r.async=!0,r.src="https://p1.answerdash.com/answerdash.min.js?siteid=756",r.setAttribute("id",s),c.parentNode.insertBefore(r,c)}}(window,document,"script","answerdash-script","AnswerDash");</script> <!-- End of AnswerDash script -->
</body>
</html>
