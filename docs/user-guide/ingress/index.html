

<!Doctype html>
<html id="docs" class="Reference Documentation">


<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="canonical" href="http://kubernetes.io/docs/user-guide/ingress/" />
	<link rel="shortcut icon" type="image/png" href="/images/favicon.png">
	<link href='https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href='https://fonts.googleapis.com/css?family=Roboto+Mono' type='text/css'>
	<link rel="stylesheet" href="/css/styles.css"/>
        <link rel="stylesheet" href="/css/jquery-ui.min.css">
        <link rel="stylesheet" href="/css/sweetalert.css">
	<script src="/js/jquery-2.2.0.min.js"></script>
        <script src="/js/jquery-ui.min.js"></script>
	<script src="/js/script.js"></script>
        <script src="/js/sweetalert.min.js"></script>
	<title>Kubernetes - Ingress Resources</title>
</head>
<body>
<div id="cellophane" onclick="kub.toggleMenu()"></div>
<header>
	<a href="/" class="logo"></a>
	<div class="nav-buttons" data-auto-burger="primary">
		<a href="/docs/" class="button" id="viewDocs" data-auto-burger-exclude>View Documentation</a>
		<a href="/docs/hellonode/" class="button" id="tryKubernetes" data-auto-burger-exclude>Try Kubernetes</a>
		<button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
	</div>

	<nav id="mainNav">
		<main data-auto-burger="primary">
			<div class="nav-box">
				<h3><a href="/docs/hellonode/">Get Started</a></h3>
				<p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>
			</div>
			<div class="nav-box">
				<h3><a href="/docs/">Documentation</a></h3>
				<p>Learn how to use Kubernetes with the use of walkthroughs, samples, and reference documentation. You can even <a href="/editdocs/" data-auto-burger-exclude>help contribute to the docs</a>!</p>
			</div>
			<div class="nav-box">
				<h3><a href="/community/">Community</a></h3>
				<p>If you need help, you can connect with other Kubernetes users and the Kubernetes authors, attend community events, and watch video presentations from around the web.</p>
			</div>
			<div class="nav-box">
				<h3><a href="http://blog.kubernetes.io">Blog</a></h3>
				<p>Read the latest news for Kubernetes and the containers space in general, and get technical how-tos hot off the presses.</p>
			</div>
		</main>
		<main data-auto-burger="primary">
			<div class="left">
				<h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
				<a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>View On Github</a>
			</div>

			<div class="right">
				<h5 class="github-invite">Explore the community</h5>
				<div class="social">
					<a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
					<a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
					<a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
					<a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
					<a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
					<a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
				</div>
			</div>
			<div class="clear" style="clear: both"></div>
		</main>
	</nav>
</header>


<!--  HERO  -->
<section id="hero" class="light-text">
	<h1>Reference Documentation</h1>
	<h5>Design docs, concept definitions, and references for APIs and CLIs.</h5>
	<div id="vendorStrip" class="light-text">
		<ul>
			<li><a href="/docs/" >GUIDES</a></li>
			<li><a href="/docs/reference" class="YAH">REFERENCE</a></li>
			<li><a href="/docs/samples" >SAMPLES</a></li>
			<li><a href="/docs/troubleshooting/" >SUPPORT</a></li>
		</ul>
		<div id="searchBox">
			<input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)">
		</div>
	</div>
</section>

<section id="encyclopedia">
	<div id="docsToc">
        <div class="pi-accordion">
        
    <a class="item" data-title="Reference Documentation" href="/docs/reference/"></a>
<div class="item" data-title="Kubernetes API">
  <div class="container">
    <a class="item" data-title="Kubernetes API Overview" href="/docs/api/"></a>
<div class="item" data-title="Accessing the API">
  <div class="container">
    <a class="item" data-title="Overview" href="/docs/admin/accessing-the-api/"></a>
    <a class="item" data-title="Authenticating" href="/docs/admin/authentication/"></a>
    <a class="item" data-title="Using Authorization Plugins" href="/docs/admin/authorization/"></a>
    <a class="item" data-title="Using Admission Controllers" href="/docs/admin/admission-controllers/"></a>
    <a class="item" data-title="Managing Service Accounts" href="/docs/admin/service-accounts-admin/"></a>
  </div>
</div>
    <a class="item" data-title="Kubernetes API Operations" href="/docs/api-reference/v1/operations/"></a>
    <a class="item" data-title="Kubernetes API Definitions" href="/docs/api-reference/v1/definitions/"></a>
    <a class="item" data-title="Kubernetes API Swagger Spec" href="/kubernetes/third_party/swagger-ui/"></a>
  </div>
</div>
<div class="item" data-title="Autoscaling API">
  <div class="container">
    <a class="item" data-title="Autoscaling API Operations" href="/docs/api-reference/autoscaling/v1/operations/"></a>
    <a class="item" data-title="Autoscaling API Definitions" href="/docs/api-reference/autoscaling/v1/definitions/"></a>
  </div>
</div>
<div class="item" data-title="Batch API">
  <div class="container">
    <a class="item" data-title="Batch API Operations" href="/docs/api-reference/batch/v1/operations/"></a>
    <a class="item" data-title="Batch API Definitions" href="/docs/api-reference/batch/v1/definitions/"></a>
  </div>
</div>
<div class="item" data-title="Extensions API">
  <div class="container">
    <a class="item" data-title="Extensions API Operations" href="/docs/api-reference/extensions/v1beta1/operations/"></a>
    <a class="item" data-title="Extensions API Definitions" href="/docs/api-reference/extensions/v1beta1/definitions/"></a>
  </div>
</div>
<div class="item" data-title="kubectl CLI">
  <div class="container">
    <a class="item" data-title="kubectl Overview" href="/docs/user-guide/kubectl-overview/"></a>
    <a class="item" data-title="kubectl for Docker Users" href="/docs/user-guide/docker-cli-to-kubectl/"></a>
    <a class="item" data-title="kubectl Usage Conventions" href="/docs/user-guide/kubectl-conventions/"></a>
    <a class="item" data-title="JSONpath Support" href="/docs/user-guide/jsonpath/"></a>
    <a class="item" data-title="kubectl Cheat Sheet" href="/docs/user-guide/kubectl-cheatsheet/"></a>
<div class="item" data-title="kubectl Commands">
  <div class="container">
    <a class="item" data-title="kubectl" href="/docs/user-guide/kubectl/kubectl/"></a>
    <a class="item" data-title="kubectl annotate" href="/docs/user-guide/kubectl/kubectl_annotate/"></a>
    <a class="item" data-title="kubectl api-versions" href="/docs/user-guide/kubectl/kubectl_api-versions/"></a>
    <a class="item" data-title="kubectl apply" href="/docs/user-guide/kubectl/kubectl_apply/"></a>
    <a class="item" data-title="kubectl attach" href="/docs/user-guide/kubectl/kubectl_attach/"></a>
    <a class="item" data-title="kubectl autoscale" href="/docs/user-guide/kubectl/kubectl_autoscale/"></a>
    <a class="item" data-title="kubectl cluster-info" href="/docs/user-guide/kubectl/kubectl_cluster-info/"></a>
    <a class="item" data-title="kubectl config" href="/docs/user-guide/kubectl/kubectl_config/"></a>
    <a class="item" data-title="kubectl config current-context" href="/docs/user-guide/kubectl/kubectl_config_current-context/"></a>
    <a class="item" data-title="kubectl config set-cluster" href="/docs/user-guide/kubectl/kubectl_config_set-cluster/"></a>
    <a class="item" data-title="kubectl config set-context" href="/docs/user-guide/kubectl/kubectl_config_set-context/"></a>
    <a class="item" data-title="kubectl config set-credentials" href="/docs/user-guide/kubectl/kubectl_config_set-credentials/"></a>
    <a class="item" data-title="kubectl config set" href="/docs/user-guide/kubectl/kubectl_config_set/"></a>
    <a class="item" data-title="kubectl config unset" href="/docs/user-guide/kubectl/kubectl_config_unset/"></a>
    <a class="item" data-title="kubectl config use-context" href="/docs/user-guide/kubectl/kubectl_config_use-context/"></a>
    <a class="item" data-title="kubectl config view" href="/docs/user-guide/kubectl/kubectl_config_view/"></a>
    <a class="item" data-title="kubectl convert" href="/docs/user-guide/kubectl/kubectl_convert/"></a>
    <a class="item" data-title="kubectl cordon" href="/docs/user-guide/kubectl/kubectl_cordon/"></a>
    <a class="item" data-title="kubectl create" href="/docs/user-guide/kubectl/kubectl_create/"></a>
    <a class="item" data-title="kubectl create configmap" href="/docs/user-guide/kubectl/kubectl_create_configmap/"></a>
    <a class="item" data-title="kubectl create namespace" href="/docs/user-guide/kubectl/kubectl_create_namespace/"></a>
    <a class="item" data-title="kubectl create secret docker-registry" href="/docs/user-guide/kubectl/kubectl_create_secret_docker-registry/"></a>
    <a class="item" data-title="kubectl create secret" href="/docs/user-guide/kubectl/kubectl_create_secret/"></a>
    <a class="item" data-title="kubectl create secret generic" href="/docs/user-guide/kubectl/kubectl_create_secret_generic/"></a>
    <a class="item" data-title="kubectl create serviceaccount" href="/docs/user-guide/kubectl/kubectl_create_serviceaccount/"></a>
    <a class="item" data-title="kubectl delete" href="/docs/user-guide/kubectl/kubectl_delete/"></a>
    <a class="item" data-title="kubectl describe" href="/docs/user-guide/kubectl/kubectl_describe/"></a>
    <a class="item" data-title="kubectl drain" href="/docs/user-guide/kubectl/kubectl_drain/"></a>
    <a class="item" data-title="kubectl edit" href="/docs/user-guide/kubectl/kubectl_edit/"></a>
    <a class="item" data-title="kubectl exec" href="/docs/user-guide/kubectl/kubectl_exec/"></a>
    <a class="item" data-title="kubectl explain" href="/docs/user-guide/kubectl/kubectl_explain/"></a>
    <a class="item" data-title="kubectl expose" href="/docs/user-guide/kubectl/kubectl_expose/"></a>
    <a class="item" data-title="kubectl get" href="/docs/user-guide/kubectl/kubectl_get/"></a>
    <a class="item" data-title="kubectl label" href="/docs/user-guide/kubectl/kubectl_label/"></a>
    <a class="item" data-title="kubectl logs" href="/docs/user-guide/kubectl/kubectl_logs/"></a>
    <a class="item" data-title="kubectl patch" href="/docs/user-guide/kubectl/kubectl_patch/"></a>
    <a class="item" data-title="kubectl port-forward" href="/docs/user-guide/kubectl/kubectl_port-forward/"></a>
    <a class="item" data-title="kubectl proxy" href="/docs/user-guide/kubectl/kubectl_proxy/"></a>
    <a class="item" data-title="kubectl replace" href="/docs/user-guide/kubectl/kubectl_replace/"></a>
    <a class="item" data-title="kubectl rolling-update" href="/docs/user-guide/kubectl/kubectl_rolling-update/"></a>
    <a class="item" data-title="kubectl rollout" href="/docs/user-guide/kubectl/kubectl_rollout/"></a>
    <a class="item" data-title="kubectl rollout history" href="/docs/user-guide/kubectl/kubectl_rollout_history/"></a>
    <a class="item" data-title="kubectl rollout pause" href="/docs/user-guide/kubectl/kubectl_rollout_pause/"></a>
    <a class="item" data-title="kubectl rollout resume" href="/docs/user-guide/kubectl/kubectl_rollout_resume/"></a>
    <a class="item" data-title="kubectl rollout undo" href="/docs/user-guide/kubectl/kubectl_rollout_undo/"></a>
    <a class="item" data-title="kubectl run" href="/docs/user-guide/kubectl/kubectl_run/"></a>
    <a class="item" data-title="kubectl scale" href="/docs/user-guide/kubectl/kubectl_scale/"></a>
    <a class="item" data-title="kubectl uncordon" href="/docs/user-guide/kubectl/kubectl_uncordon/"></a>
    <a class="item" data-title="kubectl version" href="/docs/user-guide/kubectl/kubectl_version/"></a>
<div class="item" data-title="Superseded and Deprecated Commands">
  <div class="container">
    <a class="item" data-title="kubectl namespace" href="/docs/user-guide/kubectl/kubectl_namespace/"></a>
    <a class="item" data-title="kubectl stop" href="/docs/user-guide/kubectl/kubectl_stop/"></a>
  </div>
</div>
  </div>
</div>
  </div>
</div>
<div class="item" data-title="Kubernetes Components">
  <div class="container">
    <a class="item" data-title="kube-apiserver" href="/docs/admin/kube-apiserver/"></a>
    <a class="item" data-title="kube-controller-manager" href="/docs/admin/kube-controller-manager/"></a>
    <a class="item" data-title="kube-proxy" href="/docs/admin/kube-proxy/"></a>
    <a class="item" data-title="kube-scheduler" href="/docs/admin/kube-scheduler/"></a>
    <a class="item" data-title="kubelet" href="/docs/admin/kubelet/"></a>
  </div>
</div>
<div class="item" data-title="Glossary">
  <div class="container">
    <a class="item" data-title="Annotations" href="/docs/user-guide/annotations/"></a>
    <a class="item" data-title="Daemon Sets" href="/docs/admin/daemons/"></a>
    <a class="item" data-title="Deployments" href="/docs/user-guide/deployments/"></a>
    <a class="item" data-title="Horizontal Pod Autoscaling" href="/docs/user-guide/horizontal-pod-autoscaling/"></a>
    <a class="item" data-title="Images" href="/docs/user-guide/images/"></a>
    <a class="item" data-title="Ingress Resources" href="/docs/user-guide/ingress/"></a>
    <a class="item" data-title="Jobs" href="/docs/user-guide/jobs/"></a>
    <a class="item" data-title="Labels and Selectors" href="/docs/user-guide/labels/"></a>
    <a class="item" data-title="Names" href="/docs/user-guide/identifiers/"></a>
    <a class="item" data-title="Namespaces" href="/docs/user-guide/namespaces/"></a>
    <a class="item" data-title="Network Policies" href="/docs/user-guide/networkpolicies/"></a>
    <a class="item" data-title="Nodes" href="/docs/admin/node/"></a>
    <a class="item" data-title="Persistent Volumes" href="/docs/user-guide/persistent-volumes/"></a>
    <a class="item" data-title="Pet Sets" href="/docs/user-guide/petset/"></a>
    <a class="item" data-title="Pods" href="/docs/user-guide/pods/"></a>
    <a class="item" data-title="Replica Sets" href="/docs/user-guide/replicasets/"></a>
    <a class="item" data-title="Replication Controller" href="/docs/user-guide/replication-controller/"></a>
    <a class="item" data-title="Resource Quotas" href="/docs/admin/resource-quota/"></a>
    <a class="item" data-title="Secrets" href="/docs/user-guide/secrets/"></a>
    <a class="item" data-title="Security Context" href="/docs/user-guide/security-context/"></a>
    <a class="item" data-title="Services" href="/docs/user-guide/services/"></a>
    <a class="item" data-title="Service Accounts" href="/docs/user-guide/service-accounts/"></a>
    <a class="item" data-title="Volumes" href="/docs/user-guide/volumes/"></a>
  </div>
</div>
<div class="item" data-title="Kubernetes Design Docs">
  <div class="container">
    <a class="item" data-title="Kubernetes Architecture" href="https://github.com/kubernetes/kubernetes/blob/release-1.3/docs/design/architecture.md" target='_blank'></a>
    <a class="item" data-title="Kubernetes Design Overview" href="https://github.com/kubernetes/kubernetes/blob/release-1.3/docs/design/" target='_blank'></a>
    <a class="item" data-title="Kubernetes Identity and Access Management" href="https://github.com/kubernetes/kubernetes/blob/release-1.3/docs/design/access.md" target='_blank'></a>
    <a class="item" data-title="Kubernetes OpenVSwitch GRE/VxLAN networking" href="/docs/admin/ovs-networking/"></a>
    <a class="item" data-title="Security Contexts" href="https://github.com/kubernetes/kubernetes/blob/release-1.3/docs/design/security_context.md" target='_blank'></a>
    <a class="item" data-title="Security in Kubernetes" href="https://github.com/kubernetes/kubernetes/blob/release-1.3/docs/design/security.md" target='_blank'></a>
  </div>
</div>
        </div> <!-- /pi-accordion -->
		<button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
	</div> <!-- /docsToc -->
	<div id="docsContent">
        <p><a href="/editdocs#docs/user-guide/ingress.md" id="editPageButton">Edit This Page</a></p>
    	<h1>Ingress Resources</h1>
		<ul id="markdown-toc">
  <li><a href="#what-is-ingress" id="markdown-toc-what-is-ingress">What is Ingress?</a></li>
  <li><a href="#prerequisites" id="markdown-toc-prerequisites">Prerequisites</a></li>
  <li><a href="#the-ingress-resource" id="markdown-toc-the-ingress-resource">The Ingress Resource</a></li>
  <li><a href="#ingress-controllers" id="markdown-toc-ingress-controllers">Ingress controllers</a></li>
  <li><a href="#before-you-begin" id="markdown-toc-before-you-begin">Before you begin</a></li>
  <li><a href="#types-of-ingress" id="markdown-toc-types-of-ingress">Types of Ingress</a>    <ul>
      <li><a href="#single-service-ingress" id="markdown-toc-single-service-ingress">Single Service Ingress</a></li>
      <li><a href="#simple-fanout" id="markdown-toc-simple-fanout">Simple fanout</a></li>
      <li><a href="#name-based-virtual-hosting" id="markdown-toc-name-based-virtual-hosting">Name based virtual hosting</a></li>
      <li><a href="#tls" id="markdown-toc-tls">TLS</a></li>
      <li><a href="#loadbalancing" id="markdown-toc-loadbalancing">Loadbalancing</a></li>
    </ul>
  </li>
  <li><a href="#updating-an-ingress" id="markdown-toc-updating-an-ingress">Updating an Ingress</a></li>
  <li><a href="#future-work" id="markdown-toc-future-work">Future Work</a></li>
  <li><a href="#alternatives" id="markdown-toc-alternatives">Alternatives</a></li>
</ul>

<p><strong>Terminology</strong></p>

<p>Throughout this doc you will see a few terms that are sometimes used interchangeably elsewhere, that might cause confusion. This section attempts to clarify them.</p>

<ul>
  <li>Node: A single virtual or physical machine in a Kubernetes cluster.</li>
  <li>Cluster: A group of nodes firewalled from the internet, that are the primary compute resources managed by Kubernetes.</li>
  <li>Edge router: A router that enforces the firewall policy for your cluster. This could be a gateway managed by a cloudprovider or a physical piece of hardware.</li>
  <li>Cluster network: A set of links, logical or physical, that facilitate communication within a cluster according to the <a href="https://github.com/kubernetes/kubernetes/blob/release-1.0/docs/admin/networking.md">Kubernetes networking model</a>. Examples of a Cluster network include Overlays such as <a href="https://github.com/coreos/flannel#flannel">flannel</a> or SDNs such as <a href="https://github.com/kubernetes/kubernetes/blob/release-1.0/docs/admin/ovs-networking.md">OVS</a>.</li>
  <li>Service: A Kubernetes <a href="https://github.com/kubernetes/kubernetes/blob/release-1.0/docs/user-guide/services.md">Service</a> that identifies a set of pods using label selectors. Unless mentioned otherwise, Services are assumed to have virtual IPs only routable within the cluster network.</li>
</ul>

<h2 id="what-is-ingress">What is Ingress?</h2>

<p>Typically, services and pods have IPs only routable by the cluster network. All traffic that ends up at an edge router is either dropped or forwarded elsewhere. Conceptually, this might look like:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    internet
        |
  ------------
  [ Services ]
</code></pre>
</div>

<p>An Ingress is a collection of rules that allow inbound connections to reach the cluster services.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    internet
        |
   [ Ingress ]
   --|-----|--
   [ Services ]
</code></pre>
</div>

<p>It can be configured to give services externally-reachable urls, load balance traffic, terminate SSL, offer name based virtual hosting etc. Users request ingress by POSTing the Ingress resource to the API server. An <a href="#ingress-controllers">Ingress controller</a> is responsible for fulfilling the Ingress, usually with a loadbalancer, though it may also configure your edge router or additional frontends to help handle the traffic in an HA manner.</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>Before you start using the Ingress resource, there are a few things you should understand. The Ingress is a beta resource, not available in any Kubernetes release prior to 1.1. You need an Ingress controller to satisfy an Ingress, simply creating the resource will have no effect.</p>

<p>On GCE/GKE there should be a <a href="https://github.com/kubernetes/contrib/blob/master/ingress/controllers/gce/README.md">L7 cluster addon</a>, deployed into the <code class="highlighter-rouge">kube-system</code> namespace:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>kubectl get pods --namespace<span class="o">=</span>kube-system -l k8s-app<span class="o">=</span>glbc
NAME                            READY     STATUS    RESTARTS   AGE
l7-lb-controller-v0.6.0-chnan   2/2       Running   0          1d
</code></pre>
</div>

<p>Make sure you review the <a href="https://github.com/kubernetes/contrib/tree/master/ingress/controllers/gce/BETA_LIMITATIONS.md">beta limitations</a> of this controller. In environments other than GCE/GKE, you need to <a href="https://github.com/kubernetes/contrib/tree/master/ingress/controllers">deploy a controller</a> as a pod.</p>

<h2 id="the-ingress-resource">The Ingress Resource</h2>

<p>A minimal Ingress might look like:</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">01. apiVersion</span><span class="pi">:</span> <span class="s">extensions/v1beta1</span>
<span class="s">02. kind</span><span class="pi">:</span> <span class="s">Ingress</span>
<span class="s">03. metadata</span><span class="pi">:</span>
<span class="s">04.  name</span><span class="pi">:</span> <span class="s">test-ingress</span>
<span class="s">05. spec</span><span class="pi">:</span>
<span class="s">06.  rules</span><span class="pi">:</span>
<span class="s">07.  - http</span><span class="pi">:</span>
<span class="s">08.      paths</span><span class="pi">:</span>
<span class="s">09.      - path</span><span class="pi">:</span> <span class="s">/testpath</span>
<span class="s">10.        backend</span><span class="pi">:</span>
<span class="s">11.          serviceName</span><span class="pi">:</span> <span class="s">test</span>
<span class="s">12.          servicePort</span><span class="pi">:</span> <span class="s">80</span>
</code></pre>
</div>

<p><em>POSTing this to the API server will have no effect if you have not configured an <a href="#ingress-controllers">Ingress controller</a>.</em></p>

<p><strong>Lines 1-4</strong>: As with all other Kubernetes config, an Ingress needs <code class="highlighter-rouge">apiVersion</code>, <code class="highlighter-rouge">kind</code>, and <code class="highlighter-rouge">metadata</code> fields.  For general information about working with config files, see <a href="/docs/user-guide/simple-yaml">here</a>, <a href="/docs/user-guide/configuring-containers">here</a>, and <a href="/docs/user-guide/working-with-resources">here</a>.</p>

<p><strong>Lines 5-7</strong>: Ingress <a href="https://github.com/kubernetes/kubernetes/tree/master/docs/devel/api-conventions.md#spec-and-status">spec</a> has all the information needed to configure a loadbalancer or proxy server. Most importantly, it contains a list of rules matched against all incoming requests. Currently the Ingress resource only supports http rules.</p>

<p><strong>Lines 8-9</strong>: Each http rule contains the following information: A host (eg: foo.bar.com, defaults to * in this example), a list of paths (eg: /testpath) each of which has an associated backend (test:80). Both the host and path must match the content of an incoming request before the loadbalancer directs traffic to the backend.</p>

<p><strong>Lines 10-12</strong>: A backend is a service:port combination as described in the <a href="/docs/user-guide/services">services doc</a>. Ingress traffic is typically sent directly to the endpoints matching a backend.</p>

<p><strong>Global Parameters</strong>: For the sake of simplicity the example Ingress has no global parameters, see the <a href="https://releases.k8s.io/master/pkg/apis/extensions/v1beta1/types.go">api-reference</a> for a full definition of the resource. One can specify a global default backend in the absence of which requests that don’t match a path in the spec are sent to the default backend of the Ingress controller.</p>

<h2 id="ingress-controllers">Ingress controllers</h2>

<p>In order for the Ingress resource to work, the cluster must have an Ingress controller running. This is unlike other types of controllers, which typically run as part of the <code class="highlighter-rouge">kube-controller-manager</code> binary, and which are typically started automatically as part of cluster creation. You need to choose the ingress controller implementation that is the best fit for your cluster, or implement one.  Examples and instructions can be found <a href="https://github.com/kubernetes/contrib/tree/master/ingress/controllers">here</a>.</p>

<h2 id="before-you-begin">Before you begin</h2>

<p>The following document describes a set of cross platform features exposed through the Ingress resource. Ideally, all Ingress controllers should fulfill this specification, but we’re not there yet. The docs for the GCE and nginx controllers are <a href="https://github.com/kubernetes/contrib/blob/master/ingress/controllers/gce/README.md">here</a> and <a href="https://github.com/kubernetes/contrib/blob/master/ingress/controllers/nginx/README.md">here</a> respectively. <strong>Make sure you review controller specific docs so you understand the caveats of each one</strong>.</p>

<h2 id="types-of-ingress">Types of Ingress</h2>

<h3 id="single-service-ingress">Single Service Ingress</h3>

<p>There are existing Kubernetes concepts that allow you to expose a single service (see <a href="#alternatives">alternatives</a>), however you can do so through an Ingress as well, by specifying a <em>default backend</em> with no rules.</p>

<table class="includecode"><thead><tr><th><a href="https://raw.githubusercontent.com/kubernetes/kubernetes.github.io/release-1.3/docs/user-guide/ingress.yaml" download="ingress.yaml"><code>ingress.yaml</code></a><img src="/images/copycode.svg" style="max-height:24px" onclick="copyCode('ingress.yaml')" title="Copy ingress.yaml to clipboard" /></th></tr></thead>
<tr><td>
<div id="ingress.yaml" class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">apiVersion</span><span class="pi">:</span> <span class="s">extensions/v1beta1</span>
<span class="s">kind</span><span class="pi">:</span> <span class="s">Ingress</span>
<span class="s">metadata</span><span class="pi">:</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">test-ingress</span>
<span class="s">spec</span><span class="pi">:</span>
  <span class="s">backend</span><span class="pi">:</span>
    <span class="s">serviceName</span><span class="pi">:</span> <span class="s">testsvc</span>
    <span class="s">servicePort</span><span class="pi">:</span> <span class="s">80</span>
</code></pre>
</div>
</td></tr></table>

<p>If you create it using <code class="highlighter-rouge">kubectl create -f</code> you should see:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>kubectl get ing
NAME                RULE          BACKEND        ADDRESS
<span class="nb">test</span>-ingress        -             testsvc:80     107.178.254.228
</code></pre>
</div>

<p>Where <code class="highlighter-rouge">107.178.254.228</code> is the IP allocated by the Ingress controller to satisfy this Ingress. The <code class="highlighter-rouge">RULE</code> column shows that all traffic send to the IP is directed to the Kubernetes Service listed under <code class="highlighter-rouge">BACKEND</code>.</p>

<h3 id="simple-fanout">Simple fanout</h3>

<p>As described previously, pods within kubernetes have ips only visible on the cluster network, so we need something at the edge accepting ingress traffic and proxying it to the right endpoints. This component is usually a highly available loadbalancer/s. An Ingress allows you to keep the number of loadbalancers down to a minimum, for example, a setup like:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>foo.bar.com -&gt; 178.91.123.132 -&gt; / foo    s1:80
                                 / bar    s2:80
</code></pre>
</div>

<p>would require an Ingress such as:</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">apiVersion</span><span class="pi">:</span> <span class="s">extensions/v1beta1</span>
<span class="s">kind</span><span class="pi">:</span> <span class="s">Ingress</span>
<span class="s">metadata</span><span class="pi">:</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">test</span>
<span class="s">spec</span><span class="pi">:</span>
  <span class="s">rules</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">host</span><span class="pi">:</span> <span class="s">foo.bar.com</span>
    <span class="s">http</span><span class="pi">:</span>
      <span class="s">paths</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">path</span><span class="pi">:</span> <span class="s">/foo</span>
        <span class="s">backend</span><span class="pi">:</span>
          <span class="s">serviceName</span><span class="pi">:</span> <span class="s">s1</span>
          <span class="s">servicePort</span><span class="pi">:</span> <span class="s">80</span>
      <span class="pi">-</span> <span class="s">path</span><span class="pi">:</span> <span class="s">/bar</span>
        <span class="s">backend</span><span class="pi">:</span>
          <span class="s">serviceName</span><span class="pi">:</span> <span class="s">s2</span>
          <span class="s">servicePort</span><span class="pi">:</span> <span class="s">80</span>
</code></pre>
</div>

<p>When you create the Ingress with <code class="highlighter-rouge">kubectl create -f</code>:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>kubectl get ing
NAME      RULE          BACKEND   ADDRESS
<span class="nb">test</span>      -
          foo.bar.com
          /foo          s1:80
          /bar          s2:80
</code></pre>
</div>
<p>The Ingress controller will provision an implementation specific loadbalancer that satisfies the Ingress, as long as the services (s1, s2) exist. When it has done so, you will see the address of the loadbalancer under the last column of the Ingress.</p>

<h3 id="name-based-virtual-hosting">Name based virtual hosting</h3>

<p>Name-based virtual hosts use multiple host names for the same IP address.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>foo.bar.com --|                 |-&gt; foo.bar.com s1:80
              | 178.91.123.132  |
bar.foo.com --|                 |-&gt; bar.foo.com s2:80
</code></pre>
</div>

<p>The following Ingress tells the backing loadbalancer to route requests based on the <a href="https://tools.ietf.org/html/rfc7230#section-5.4">Host header</a>.</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">apiVersion</span><span class="pi">:</span> <span class="s">extensions/v1beta1</span>
<span class="s">kind</span><span class="pi">:</span> <span class="s">Ingress</span>
<span class="s">metadata</span><span class="pi">:</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">test</span>
<span class="s">spec</span><span class="pi">:</span>
  <span class="s">rules</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">host</span><span class="pi">:</span> <span class="s">foo.bar.com</span>
    <span class="s">http</span><span class="pi">:</span>
      <span class="s">paths</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">backend</span><span class="pi">:</span>
          <span class="s">serviceName</span><span class="pi">:</span> <span class="s">s1</span>
          <span class="s">servicePort</span><span class="pi">:</span> <span class="s">80</span>
  <span class="pi">-</span> <span class="s">host</span><span class="pi">:</span> <span class="s">bar.foo.com</span>
    <span class="s">http</span><span class="pi">:</span>
      <span class="s">paths</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">backend</span><span class="pi">:</span>
          <span class="s">serviceName</span><span class="pi">:</span> <span class="s">s2</span>
          <span class="s">servicePort</span><span class="pi">:</span> <span class="s">80</span>
</code></pre>
</div>

<p><strong>Default Backends</strong>: An Ingress with no rules, like the one shown in the previous section, sends all traffic to a single default backend. You can use the same technique to tell a loadbalancer where to find your website’s 404 page, by specifying a set of rules <em>and</em> a default backend. Traffic is routed to your default backend if none of the Hosts in your Ingress match the Host in the request header, and/or none of the paths match the url of the request.</p>

<h3 id="tls">TLS</h3>

<p>You can secure an Ingress by specifying a <a href="/docs/user-guide/secrets">secret</a> that contains a TLS private key and certificate. Currently the Ingress only supports a single TLS port, 443, and assumes TLS termination. If the TLS configuration section in an Ingress specifies different hosts, they will be multiplexed on the same port according to the hostname specified through the SNI TLS extension (provided the Ingress controller supports SNI). The TLS secret must contain keys named <code class="highlighter-rouge">tls.crt</code> and <code class="highlighter-rouge">tls.key</code> that contain the certificate and private key to use for TLS, eg:</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="s">data</span><span class="pi">:</span>
  <span class="s">tls.crt</span><span class="pi">:</span> <span class="s">base64 encoded cert</span>
  <span class="s">tls.key</span><span class="pi">:</span> <span class="s">base64 encoded key</span>
<span class="s">kind</span><span class="pi">:</span> <span class="s">Secret</span>
<span class="s">metadata</span><span class="pi">:</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">testsecret</span>
  <span class="s">namespace</span><span class="pi">:</span> <span class="s">default</span>
<span class="s">type</span><span class="pi">:</span> <span class="s">Opaque</span>
</code></pre>
</div>

<p>Referencing this secret in an Ingress will tell the Ingress controller to secure the channel from the client to the loadbalancer using TLS:</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">apiVersion</span><span class="pi">:</span> <span class="s">extensions/v1beta1</span>
<span class="s">kind</span><span class="pi">:</span> <span class="s">Ingress</span>
<span class="s">metadata</span><span class="pi">:</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">no-rules-map</span>
<span class="s">spec</span><span class="pi">:</span>
  <span class="s">tls</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">secretName</span><span class="pi">:</span> <span class="s">testsecret</span>
  <span class="s">backend</span><span class="pi">:</span>
    <span class="s">serviceName</span><span class="pi">:</span> <span class="s">s1</span>
    <span class="s">servicePort</span><span class="pi">:</span> <span class="s">80</span>
</code></pre>
</div>

<p>Note that there is a gap between TLS features supported by various Ingress controllers. Please refer to documentation on <a href="https://github.com/kubernetes/contrib/tree/master/ingress/controllers/nginx#https">nginx</a>, <a href="https://github.com/kubernetes/contrib/tree/master/ingress/controllers/gce#tls">GCE</a>, or any other platform specific Ingress controller to understand how TLS works in your environment.</p>

<h3 id="loadbalancing">Loadbalancing</h3>

<p>An Ingress controller is bootstrapped with some loadbalancing policy settings that it applies to all Ingress, such as the loadbalancing algorithm, backend weight scheme etc. More advanced loadbalancing concepts (eg: persistent sessions, dynamic weights) are not yet exposed through the Ingress. You can still get these features through the <a href="https://github.com/kubernetes/contrib/tree/master/service-loadbalancer">service loadbalancer</a>. With time, we plan to distill loadbalancing patterns that are applicable cross platform into the Ingress resource.</p>

<p>It’s also worth noting that even though health checks are not exposed directly through the Ingress, there exist parallel concepts in Kubernetes such as <a href="https://github.com/kubernetes/kubernetes/blob/release-1.0/docs/user-guide/production-pods.md#liveness-and-readiness-probes-aka-health-checks">readiness probes</a> which allow you to achieve the same end result. Please review the controller specific docs to see how they handle health checks (<a href="https://github.com/kubernetes/contrib/blob/master/ingress/controllers/nginx/README.md">nginx</a>, <a href="https://github.com/kubernetes/contrib/blob/master/ingress/controllers/gce/README.md#health-checks">GCE</a>).</p>

<h2 id="updating-an-ingress">Updating an Ingress</h2>

<p>Say you’d like to add a new Host to an existing Ingress, you can update it by editing the resource:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>kubectl get ing
NAME      RULE          BACKEND   ADDRESS
<span class="nb">test</span>      -                       178.91.123.132
          foo.bar.com
          /foo          s1:80
<span class="gp">$ </span>kubectl edit ing <span class="nb">test</span>
</code></pre>
</div>

<p>This should pop up an editor with the existing yaml, modify it to include the new Host.</p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">spec</span><span class="pi">:</span>
  <span class="s">rules</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">host</span><span class="pi">:</span> <span class="s">foo.bar.com</span>
    <span class="s">http</span><span class="pi">:</span>
      <span class="s">paths</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">backend</span><span class="pi">:</span>
          <span class="s">serviceName</span><span class="pi">:</span> <span class="s">s1</span>
          <span class="s">servicePort</span><span class="pi">:</span> <span class="s">80</span>
        <span class="s">path</span><span class="pi">:</span> <span class="s">/foo</span>
  <span class="pi">-</span> <span class="s">host</span><span class="pi">:</span> <span class="s">bar.baz.com</span>
    <span class="s">http</span><span class="pi">:</span>
      <span class="s">paths</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">backend</span><span class="pi">:</span>
          <span class="s">serviceName</span><span class="pi">:</span> <span class="s">s2</span>
          <span class="s">servicePort</span><span class="pi">:</span> <span class="s">80</span>
        <span class="s">path</span><span class="pi">:</span> <span class="s">/foo</span>
<span class="s">..</span>
</code></pre>
</div>

<p>saving it will update the resource in the API server, which should tell the Ingress controller to reconfigure the loadbalancer.</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>kubectl get ing
NAME      RULE          BACKEND   ADDRESS
<span class="nb">test</span>      -                       178.91.123.132
          foo.bar.com
          /foo          s1:80
          bar.baz.com
          /foo          s2:80
</code></pre>
</div>

<p>You can achieve the same by invoking <code class="highlighter-rouge">kubectl replace -f</code> on a modified Ingress yaml file.</p>

<h2 id="future-work">Future Work</h2>

<ul>
  <li>Various modes of HTTPS/TLS support (eg: SNI, re-encryption)</li>
  <li>Requesting an IP or Hostname via claims</li>
  <li>Combining L4 and L7 Ingress</li>
  <li>More Ingress controllers</li>
</ul>

<p>Please track the <a href="https://github.com/kubernetes/kubernetes/pull/12827">L7 and Ingress proposal</a> for more details on the evolution of the resource, and the <a href="https://github.com/kubernetes/contrib/tree/master/ingress">Ingress sub-repository</a> for more details on the evolution of various Ingress controllers.</p>

<h2 id="alternatives">Alternatives</h2>

<p>You can expose a Service in multiple ways that don’t directly involve the Ingress resource:</p>

<ul>
  <li>Use <a href="/docs/user-guide/services/#type-loadbalancer">Service.Type=LoadBalancer</a></li>
  <li>Use <a href="/docs/user-guide/services/#type-nodeport">Service.Type=NodePort</a></li>
  <li>Use a <a href="https://github.com/kubernetes/contrib/tree/master/for-demos/proxy-to-service">Port Proxy</a></li>
  <li>Deploy the <a href="https://github.com/kubernetes/contrib/tree/master/service-loadbalancer">Service loadbalancer</a>. This allows you to share a single IP among multiple Services and achieve more advanced loadbalancing through Service Annotations.</li>
</ul>

        <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/user-guide/ingress.md?pixel" alt="Analytics" /></a>
        <div id="pd_rating_holder_8345992"></div>
		<script type="text/javascript">
	        PDRTJS_settings_8345992 = {
		        "id" : "8345992",
		        "unique_id" : "/docs/user-guide/ingress/",
		        "title" : "Ingress Resources",
		        "permalink" : "http://kubernetes.github.io/docs/user-guide/ingress/"
	        };
	        (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
        </script>
	</div>
</section>

<footer>
	<main class="light-text">
		<nav>
			<a href="/docs/hellonode/">Get Started</a>
			<a href="/docs/">Documentation</a>
			<a href="http://blog.kubernetes.io/">Blog</a>
			<a href="/community/">Community</a>
		</nav>
		<div class="social">
			<div>
				<a href="https://twitter.com/kubernetesio" class="twitter"><span>twitter</span></a>
				<a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
				<a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
			</div>
			<div>
				<a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
				<a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
				<a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
			</div>
			<div>
				<span>I wish this page</span>
				<input type="text" id="wishField" name="wishField" placeholder="enter your wish">
			</div>
		</div>
		<div id="miceType" class="center">&copy; 2016 Kubernetes</div>
	</main>
</footer>


<button class="flyout-button" onclick="kub.toggleToc()"></button>

<style>
	.cse .gsc-control-cse, .gsc-control-cse, {
		padding: 0;
	}
	.gsc-control-cse table, .gsc-control-cse-en table {
		margin:0px !important;
	}

	.gsc-above-wrapper-area {
		border-bottom: 0;
	}
</style>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36037335-10', 'auto');
  ga('send', 'pageview');
</script>
<!-- Commenting out AnswerDash for now; we need to work on our list of questions/answers/design first
<!-- Start of AnswerDash script <script>var AnswerDash;!function(e,t,n,s,a){if(!t.getElementById(s)){var i,r=t.createElement(n),c=t.getElementsByTagName(n)[0];e[a]||(i=e[a]=function(){i.__oninit.push(arguments)},i.__oninit=[]),r.type="text/javascript",r.async=!0,r.src="https://p1.answerdash.com/answerdash.min.js?siteid=756",r.setAttribute("id",s),c.parentNode.insertBefore(r,c)}}(window,document,"script","answerdash-script","AnswerDash");</script> <!-- End of AnswerDash script -->
</body>
</html>
