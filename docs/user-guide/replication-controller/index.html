

<!Doctype html>
<html id="docs" class="Reference Documentation">


<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="canonical" href="http://kubernetes.io/docs/user-guide/replication-controller/" />
	<link rel="shortcut icon" type="image/png" href="/images/favicon.png">
	<link href='https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href='https://fonts.googleapis.com/css?family=Roboto+Mono' type='text/css'>
	<link rel="stylesheet" href="/css/styles.css"/>
        <link rel="stylesheet" href="/css/jquery-ui.min.css">
        <link rel="stylesheet" href="/css/sweetalert.css">
	<script src="/js/jquery-2.2.0.min.js"></script>
        <script src="/js/jquery-ui.min.js"></script>
	<script src="/js/script.js"></script>
        <script src="/js/sweetalert.min.js"></script>
	<title>Kubernetes - Replication Controller</title>
</head>
<body>
<div id="cellophane" onclick="kub.toggleMenu()"></div>
<header>
	<a href="/" class="logo"></a>
	<div class="nav-buttons" data-auto-burger="primary">
		<a href="/docs/" class="button" id="viewDocs" data-auto-burger-exclude>View Documentation</a>
		<a href="/docs/hellonode/" class="button" id="tryKubernetes" data-auto-burger-exclude>Try Kubernetes</a>
		<button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
	</div>

	<nav id="mainNav">
		<main data-auto-burger="primary">
			<div class="nav-box">
				<h3><a href="/docs/hellonode/">Get Started</a></h3>
				<p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>
			</div>
			<div class="nav-box">
				<h3><a href="/docs/">Documentation</a></h3>
				<p>Learn how to use Kubernetes with the use of walkthroughs, samples, and reference documentation. You can even <a href="/editdocs/" data-auto-burger-exclude>help contribute to the docs</a>!</p>
			</div>
			<div class="nav-box">
				<h3><a href="/community/">Community</a></h3>
				<p>If you need help, you can connect with other Kubernetes users and the Kubernetes authors, attend community events, and watch video presentations from around the web.</p>
			</div>
			<div class="nav-box">
				<h3><a href="http://blog.kubernetes.io">Blog</a></h3>
				<p>Read the latest news for Kubernetes and the containers space in general, and get technical how-tos hot off the presses.</p>
			</div>
		</main>
		<main data-auto-burger="primary">
			<div class="left">
				<h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
				<a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>View On Github</a>
			</div>

			<div class="right">
				<h5 class="github-invite">Explore the community</h5>
				<div class="social">
					<a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
					<a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
					<a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
					<a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
					<a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
					<a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
				</div>
			</div>
			<div class="clear" style="clear: both"></div>
		</main>
	</nav>
</header>


<!--  HERO  -->
<section id="hero" class="light-text">
	<h1>Reference Documentation</h1>
	<h5>Design docs, concept definitions, and references for APIs and CLIs.</h5>
	<div id="vendorStrip" class="light-text">
		<ul>
			<li><a href="/docs/" >GUIDES</a></li>
			<li><a href="/docs/reference" class="YAH">REFERENCE</a></li>
			<li><a href="/docs/samples" >SAMPLES</a></li>
			<li><a href="/docs/troubleshooting/" >SUPPORT</a></li>
		</ul>
		<div id="searchBox">
			<input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)">
		</div>
	</div>
</section>

<section id="encyclopedia">
	<div id="docsToc">
        <div class="pi-accordion">
        
    <a class="item" data-title="Reference Documentation" href="/docs/reference/"></a>
<div class="item" data-title="Kubernetes API">
  <div class="container">
    <a class="item" data-title="Kubernetes API Overview" href="/docs/api/"></a>
<div class="item" data-title="Accessing the API">
  <div class="container">
    <a class="item" data-title="Overview" href="/docs/admin/accessing-the-api/"></a>
    <a class="item" data-title="Authenticating" href="/docs/admin/authentication/"></a>
    <a class="item" data-title="Using Authorization Plugins" href="/docs/admin/authorization/"></a>
    <a class="item" data-title="Using Admission Controllers" href="/docs/admin/admission-controllers/"></a>
    <a class="item" data-title="Managing Service Accounts" href="/docs/admin/service-accounts-admin/"></a>
  </div>
</div>
    <a class="item" data-title="Kubernetes API Operations" href="/docs/api-reference/v1/operations/"></a>
    <a class="item" data-title="Kubernetes API Definitions" href="/docs/api-reference/v1/definitions/"></a>
    <a class="item" data-title="Kubernetes API Swagger Spec" href="/kubernetes/third_party/swagger-ui/"></a>
  </div>
</div>
<div class="item" data-title="Autoscaling API">
  <div class="container">
    <a class="item" data-title="Autoscaling API Operations" href="/docs/api-reference/autoscaling/v1/operations/"></a>
    <a class="item" data-title="Autoscaling API Definitions" href="/docs/api-reference/autoscaling/v1/definitions/"></a>
  </div>
</div>
<div class="item" data-title="Batch API">
  <div class="container">
    <a class="item" data-title="Batch API Operations" href="/docs/api-reference/batch/v1/operations/"></a>
    <a class="item" data-title="Batch API Definitions" href="/docs/api-reference/batch/v1/definitions/"></a>
  </div>
</div>
<div class="item" data-title="Extensions API">
  <div class="container">
    <a class="item" data-title="Extensions API Operations" href="/docs/api-reference/extensions/v1beta1/operations/"></a>
    <a class="item" data-title="Extensions API Definitions" href="/docs/api-reference/extensions/v1beta1/definitions/"></a>
  </div>
</div>
<div class="item" data-title="kubectl CLI">
  <div class="container">
    <a class="item" data-title="kubectl Overview" href="/docs/user-guide/kubectl-overview/"></a>
    <a class="item" data-title="kubectl for Docker Users" href="/docs/user-guide/docker-cli-to-kubectl/"></a>
    <a class="item" data-title="kubectl Usage Conventions" href="/docs/user-guide/kubectl-conventions/"></a>
    <a class="item" data-title="JSONpath Support" href="/docs/user-guide/jsonpath/"></a>
    <a class="item" data-title="kubectl Cheat Sheet" href="/docs/user-guide/kubectl-cheatsheet/"></a>
<div class="item" data-title="kubectl Commands">
  <div class="container">
    <a class="item" data-title="kubectl" href="/docs/user-guide/kubectl/kubectl/"></a>
    <a class="item" data-title="kubectl annotate" href="/docs/user-guide/kubectl/kubectl_annotate/"></a>
    <a class="item" data-title="kubectl api-versions" href="/docs/user-guide/kubectl/kubectl_api-versions/"></a>
    <a class="item" data-title="kubectl apply" href="/docs/user-guide/kubectl/kubectl_apply/"></a>
    <a class="item" data-title="kubectl attach" href="/docs/user-guide/kubectl/kubectl_attach/"></a>
    <a class="item" data-title="kubectl autoscale" href="/docs/user-guide/kubectl/kubectl_autoscale/"></a>
    <a class="item" data-title="kubectl cluster-info" href="/docs/user-guide/kubectl/kubectl_cluster-info/"></a>
    <a class="item" data-title="kubectl config" href="/docs/user-guide/kubectl/kubectl_config/"></a>
    <a class="item" data-title="kubectl config current-context" href="/docs/user-guide/kubectl/kubectl_config_current-context/"></a>
    <a class="item" data-title="kubectl config set-cluster" href="/docs/user-guide/kubectl/kubectl_config_set-cluster/"></a>
    <a class="item" data-title="kubectl config set-context" href="/docs/user-guide/kubectl/kubectl_config_set-context/"></a>
    <a class="item" data-title="kubectl config set-credentials" href="/docs/user-guide/kubectl/kubectl_config_set-credentials/"></a>
    <a class="item" data-title="kubectl config set" href="/docs/user-guide/kubectl/kubectl_config_set/"></a>
    <a class="item" data-title="kubectl config unset" href="/docs/user-guide/kubectl/kubectl_config_unset/"></a>
    <a class="item" data-title="kubectl config use-context" href="/docs/user-guide/kubectl/kubectl_config_use-context/"></a>
    <a class="item" data-title="kubectl config view" href="/docs/user-guide/kubectl/kubectl_config_view/"></a>
    <a class="item" data-title="kubectl convert" href="/docs/user-guide/kubectl/kubectl_convert/"></a>
    <a class="item" data-title="kubectl cordon" href="/docs/user-guide/kubectl/kubectl_cordon/"></a>
    <a class="item" data-title="kubectl create" href="/docs/user-guide/kubectl/kubectl_create/"></a>
    <a class="item" data-title="kubectl create configmap" href="/docs/user-guide/kubectl/kubectl_create_configmap/"></a>
    <a class="item" data-title="kubectl create namespace" href="/docs/user-guide/kubectl/kubectl_create_namespace/"></a>
    <a class="item" data-title="kubectl create secret docker-registry" href="/docs/user-guide/kubectl/kubectl_create_secret_docker-registry/"></a>
    <a class="item" data-title="kubectl create secret" href="/docs/user-guide/kubectl/kubectl_create_secret/"></a>
    <a class="item" data-title="kubectl create secret generic" href="/docs/user-guide/kubectl/kubectl_create_secret_generic/"></a>
    <a class="item" data-title="kubectl create serviceaccount" href="/docs/user-guide/kubectl/kubectl_create_serviceaccount/"></a>
    <a class="item" data-title="kubectl delete" href="/docs/user-guide/kubectl/kubectl_delete/"></a>
    <a class="item" data-title="kubectl describe" href="/docs/user-guide/kubectl/kubectl_describe/"></a>
    <a class="item" data-title="kubectl drain" href="/docs/user-guide/kubectl/kubectl_drain/"></a>
    <a class="item" data-title="kubectl edit" href="/docs/user-guide/kubectl/kubectl_edit/"></a>
    <a class="item" data-title="kubectl exec" href="/docs/user-guide/kubectl/kubectl_exec/"></a>
    <a class="item" data-title="kubectl explain" href="/docs/user-guide/kubectl/kubectl_explain/"></a>
    <a class="item" data-title="kubectl expose" href="/docs/user-guide/kubectl/kubectl_expose/"></a>
    <a class="item" data-title="kubectl get" href="/docs/user-guide/kubectl/kubectl_get/"></a>
    <a class="item" data-title="kubectl label" href="/docs/user-guide/kubectl/kubectl_label/"></a>
    <a class="item" data-title="kubectl logs" href="/docs/user-guide/kubectl/kubectl_logs/"></a>
    <a class="item" data-title="kubectl patch" href="/docs/user-guide/kubectl/kubectl_patch/"></a>
    <a class="item" data-title="kubectl port-forward" href="/docs/user-guide/kubectl/kubectl_port-forward/"></a>
    <a class="item" data-title="kubectl proxy" href="/docs/user-guide/kubectl/kubectl_proxy/"></a>
    <a class="item" data-title="kubectl replace" href="/docs/user-guide/kubectl/kubectl_replace/"></a>
    <a class="item" data-title="kubectl rolling-update" href="/docs/user-guide/kubectl/kubectl_rolling-update/"></a>
    <a class="item" data-title="kubectl rollout" href="/docs/user-guide/kubectl/kubectl_rollout/"></a>
    <a class="item" data-title="kubectl rollout history" href="/docs/user-guide/kubectl/kubectl_rollout_history/"></a>
    <a class="item" data-title="kubectl rollout pause" href="/docs/user-guide/kubectl/kubectl_rollout_pause/"></a>
    <a class="item" data-title="kubectl rollout resume" href="/docs/user-guide/kubectl/kubectl_rollout_resume/"></a>
    <a class="item" data-title="kubectl rollout undo" href="/docs/user-guide/kubectl/kubectl_rollout_undo/"></a>
    <a class="item" data-title="kubectl run" href="/docs/user-guide/kubectl/kubectl_run/"></a>
    <a class="item" data-title="kubectl scale" href="/docs/user-guide/kubectl/kubectl_scale/"></a>
    <a class="item" data-title="kubectl uncordon" href="/docs/user-guide/kubectl/kubectl_uncordon/"></a>
    <a class="item" data-title="kubectl version" href="/docs/user-guide/kubectl/kubectl_version/"></a>
<div class="item" data-title="Superseded and Deprecated Commands">
  <div class="container">
    <a class="item" data-title="kubectl namespace" href="/docs/user-guide/kubectl/kubectl_namespace/"></a>
    <a class="item" data-title="kubectl stop" href="/docs/user-guide/kubectl/kubectl_stop/"></a>
  </div>
</div>
  </div>
</div>
  </div>
</div>
<div class="item" data-title="Kubernetes Components">
  <div class="container">
    <a class="item" data-title="kube-apiserver" href="/docs/admin/kube-apiserver/"></a>
    <a class="item" data-title="kube-controller-manager" href="/docs/admin/kube-controller-manager/"></a>
    <a class="item" data-title="kube-proxy" href="/docs/admin/kube-proxy/"></a>
    <a class="item" data-title="kube-scheduler" href="/docs/admin/kube-scheduler/"></a>
    <a class="item" data-title="kubelet" href="/docs/admin/kubelet/"></a>
  </div>
</div>
<div class="item" data-title="Glossary">
  <div class="container">
    <a class="item" data-title="Annotations" href="/docs/user-guide/annotations/"></a>
    <a class="item" data-title="Daemon Sets" href="/docs/admin/daemons/"></a>
    <a class="item" data-title="Deployments" href="/docs/user-guide/deployments/"></a>
    <a class="item" data-title="Horizontal Pod Autoscaling" href="/docs/user-guide/horizontal-pod-autoscaling/"></a>
    <a class="item" data-title="Images" href="/docs/user-guide/images/"></a>
    <a class="item" data-title="Ingress Resources" href="/docs/user-guide/ingress/"></a>
    <a class="item" data-title="Jobs" href="/docs/user-guide/jobs/"></a>
    <a class="item" data-title="Labels and Selectors" href="/docs/user-guide/labels/"></a>
    <a class="item" data-title="Names" href="/docs/user-guide/identifiers/"></a>
    <a class="item" data-title="Namespaces" href="/docs/user-guide/namespaces/"></a>
    <a class="item" data-title="Network Policies" href="/docs/user-guide/networkpolicies/"></a>
    <a class="item" data-title="Nodes" href="/docs/admin/node/"></a>
    <a class="item" data-title="Persistent Volumes" href="/docs/user-guide/persistent-volumes/"></a>
    <a class="item" data-title="Pet Sets" href="/docs/user-guide/petset/"></a>
    <a class="item" data-title="Pods" href="/docs/user-guide/pods/"></a>
    <a class="item" data-title="Replica Sets" href="/docs/user-guide/replicasets/"></a>
    <a class="item" data-title="Replication Controller" href="/docs/user-guide/replication-controller/"></a>
    <a class="item" data-title="Resource Quotas" href="/docs/admin/resource-quota/"></a>
    <a class="item" data-title="Secrets" href="/docs/user-guide/secrets/"></a>
    <a class="item" data-title="Security Context" href="/docs/user-guide/security-context/"></a>
    <a class="item" data-title="Services" href="/docs/user-guide/services/"></a>
    <a class="item" data-title="Service Accounts" href="/docs/user-guide/service-accounts/"></a>
    <a class="item" data-title="Volumes" href="/docs/user-guide/volumes/"></a>
  </div>
</div>
<div class="item" data-title="Kubernetes Design Docs">
  <div class="container">
    <a class="item" data-title="Kubernetes Architecture" href="https://github.com/kubernetes/kubernetes/blob/release-1.3/docs/design/architecture.md" target='_blank'></a>
    <a class="item" data-title="Kubernetes Design Overview" href="https://github.com/kubernetes/kubernetes/blob/release-1.3/docs/design/" target='_blank'></a>
    <a class="item" data-title="Kubernetes Identity and Access Management" href="https://github.com/kubernetes/kubernetes/blob/release-1.3/docs/design/access.md" target='_blank'></a>
    <a class="item" data-title="Kubernetes OpenVSwitch GRE/VxLAN networking" href="/docs/admin/ovs-networking/"></a>
    <a class="item" data-title="Security Contexts" href="https://github.com/kubernetes/kubernetes/blob/release-1.3/docs/design/security_context.md" target='_blank'></a>
    <a class="item" data-title="Security in Kubernetes" href="https://github.com/kubernetes/kubernetes/blob/release-1.3/docs/design/security.md" target='_blank'></a>
  </div>
</div>
        </div> <!-- /pi-accordion -->
		<button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
	</div> <!-- /docsToc -->
	<div id="docsContent">
        <p><a href="/editdocs#docs/user-guide/replication-controller/index.md" id="editPageButton">Edit This Page</a></p>
    	<h1>Replication Controller</h1>
		<ul id="markdown-toc">
  <li><a href="#what-is-a-replication-controller" id="markdown-toc-what-is-a-replication-controller">What is a <em>replication controller</em>?</a></li>
  <li><a href="#running-an-example-replication-controller" id="markdown-toc-running-an-example-replication-controller">Running an example Replication Controller</a></li>
  <li><a href="#writing-a-replication-controller-spec" id="markdown-toc-writing-a-replication-controller-spec">Writing a Replication Controller Spec</a>    <ul>
      <li><a href="#pod-template" id="markdown-toc-pod-template">Pod Template</a></li>
      <li><a href="#labels-on-the-replication-controller" id="markdown-toc-labels-on-the-replication-controller">Labels on the Replication Controller</a></li>
      <li><a href="#pod-selector" id="markdown-toc-pod-selector">Pod Selector</a></li>
      <li><a href="#multiple-replicas" id="markdown-toc-multiple-replicas">Multiple Replicas</a></li>
    </ul>
  </li>
  <li><a href="#working-with-replication-controllers" id="markdown-toc-working-with-replication-controllers">Working with Replication Controllers</a>    <ul>
      <li><a href="#deleting-a-replication-controller-and-its-pods" id="markdown-toc-deleting-a-replication-controller-and-its-pods">Deleting a Replication Controller and its Pods</a></li>
      <li><a href="#deleting-just-a-replication-controller" id="markdown-toc-deleting-just-a-replication-controller">Deleting just a Replication Controller</a></li>
      <li><a href="#isolating-pods-from-a-replication-controller" id="markdown-toc-isolating-pods-from-a-replication-controller">Isolating pods from a Replication Controller</a></li>
    </ul>
  </li>
  <li><a href="#common-usage-patterns" id="markdown-toc-common-usage-patterns">Common usage patterns</a>    <ul>
      <li><a href="#rescheduling" id="markdown-toc-rescheduling">Rescheduling</a></li>
      <li><a href="#scaling" id="markdown-toc-scaling">Scaling</a></li>
      <li><a href="#rolling-updates" id="markdown-toc-rolling-updates">Rolling updates</a></li>
      <li><a href="#multiple-release-tracks" id="markdown-toc-multiple-release-tracks">Multiple release tracks</a></li>
      <li><a href="#using-replication-controllers-with-services" id="markdown-toc-using-replication-controllers-with-services">Using Replication Controllers with Services</a></li>
    </ul>
  </li>
  <li><a href="#writing-programs-for-replication" id="markdown-toc-writing-programs-for-replication">Writing programs for Replication</a></li>
  <li><a href="#responsibilities-of-the-replication-controller" id="markdown-toc-responsibilities-of-the-replication-controller">Responsibilities of the replication controller</a></li>
  <li><a href="#api-object" id="markdown-toc-api-object">API Object</a></li>
  <li><a href="#alternatives-to-replication-controller" id="markdown-toc-alternatives-to-replication-controller">Alternatives to Replication Controller</a>    <ul>
      <li><a href="#replicaset" id="markdown-toc-replicaset">ReplicaSet</a></li>
      <li><a href="#deployment-recommended" id="markdown-toc-deployment-recommended">Deployment (Recommended)</a></li>
      <li><a href="#bare-pods" id="markdown-toc-bare-pods">Bare Pods</a></li>
      <li><a href="#job" id="markdown-toc-job">Job</a></li>
      <li><a href="#daemonset" id="markdown-toc-daemonset">DaemonSet</a></li>
    </ul>
  </li>
  <li><a href="#for-more-information" id="markdown-toc-for-more-information">For more information</a></li>
</ul>

<h2 id="what-is-a-replication-controller">What is a <em>replication controller</em>?</h2>

<p>A <em>replication controller</em> ensures that a specified number of pod “replicas” are running at any one
time. In other words, a replication controller makes sure that a pod or homogeneous set of pods are
always up and available.
If there are too many pods, it will kill some. If there are too few, the
replication controller will start more. Unlike manually created pods, the pods maintained by a
replication controller are automatically replaced if they fail, get deleted, or are terminated.
For example, your pods get re-created on a node after disruptive maintenance such as a kernel upgrade.
For this reason, we recommend that you use a replication controller even if your application requires
only a single pod. You can think of a replication controller as something similar to a process supervisor,
but rather than individual processes on a single node, the replication controller supervises multiple pods
across multiple nodes.</p>

<p>Replication Controller is often abbreviated to “rc” or “rcs” in discussion, and as a shortcut in
kubectl commands.</p>

<p>A simple case is to create 1 Replication Controller object in order to reliably run one instance of
a Pod indefinitely.  A more complex use case is to run several identical replicas of a replicated
service, such as web servers.</p>

<h2 id="running-an-example-replication-controller">Running an example Replication Controller</h2>

<p>Here is an example Replication Controller config.  It runs 3 copies of the nginx web server.</p>

<table class="includecode"><thead><tr><th><a href="https://raw.githubusercontent.com/kubernetes/kubernetes.github.io/release-1.3/docs/user-guide/replication.yaml" download="replication.yaml"><code>replication.yaml</code></a><img src="/images/copycode.svg" style="max-height:24px" onclick="copyCode('replication.yaml')" title="Copy replication.yaml to clipboard" /></th></tr></thead>
<tr><td>
<div id="replication.yaml" class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="s">kind</span><span class="pi">:</span> <span class="s">ReplicationController</span>
<span class="s">metadata</span><span class="pi">:</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">nginx</span>
<span class="s">spec</span><span class="pi">:</span>
  <span class="s">replicas</span><span class="pi">:</span> <span class="s">3</span>
  <span class="s">selector</span><span class="pi">:</span>
    <span class="s">app</span><span class="pi">:</span> <span class="s">nginx</span>
  <span class="s">template</span><span class="pi">:</span>
    <span class="s">metadata</span><span class="pi">:</span>
      <span class="s">name</span><span class="pi">:</span> <span class="s">nginx</span>
      <span class="s">labels</span><span class="pi">:</span>
        <span class="s">app</span><span class="pi">:</span> <span class="s">nginx</span>
    <span class="s">spec</span><span class="pi">:</span>
      <span class="s">containers</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">name</span><span class="pi">:</span> <span class="s">nginx</span>
        <span class="s">image</span><span class="pi">:</span> <span class="s">nginx</span>
        <span class="s">ports</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">containerPort</span><span class="pi">:</span> <span class="s">80</span>
</code></pre>
</div>
</td></tr></table>

<p>Run the example job by downloading the example file and then running this command:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>kubectl create -f ./replication.yaml
replicationcontrollers/nginx
</code></pre>
</div>

<p>Check on the status of the replication controller using this command:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>kubectl describe replicationcontrollers/nginx
Name:		nginx
Namespace:	default
Image<span class="o">(</span>s<span class="o">)</span>:	nginx
Selector:	<span class="nv">app</span><span class="o">=</span>nginx
Labels:		<span class="nv">app</span><span class="o">=</span>nginx
Replicas:	3 current / 3 desired
Pods Status:	0 Running / 3 Waiting / 0 Succeeded / 0 Failed
Events:
  FirstSeen				LastSeen			Count	From
SubobjectPath	Reason			Message
  Thu, 24 Sep 2015 10:38:20 -0700	Thu, 24 Sep 2015 10:38:20 -0700	1
<span class="o">{</span>replication-controller <span class="o">}</span>			SuccessfulCreate	Created pod: nginx-qrm3m
  Thu, 24 Sep 2015 10:38:20 -0700	Thu, 24 Sep 2015 10:38:20 -0700	1
<span class="o">{</span>replication-controller <span class="o">}</span>			SuccessfulCreate	Created pod: nginx-3ntk0
  Thu, 24 Sep 2015 10:38:20 -0700	Thu, 24 Sep 2015 10:38:20 -0700	1
<span class="o">{</span>replication-controller <span class="o">}</span>			SuccessfulCreate	Created pod: nginx-4ok8v
</code></pre>
</div>

<p>Here, 3 pods have been made, but none are running yet, perhaps because the image is being pulled.
A little later, the same command may show:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>Pods Status:	3 Running / 0 Waiting / 0 Succeeded / 0 Failed
</code></pre>
</div>

<p>To list all the pods that belong to the rc in a machine readable form, you can use a command like this:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span><span class="nv">pods</span><span class="o">=</span><span class="k">$(</span>kubectl get pods --selector<span class="o">=</span><span class="nv">app</span><span class="o">=</span>nginx --output<span class="o">=</span><span class="nv">jsonpath</span><span class="o">={</span>.items..metadata.name<span class="o">}</span><span class="k">)</span>
<span class="nb">echo</span> <span class="nv">$pods</span>
nginx-3ntk0 nginx-4ok8v nginx-qrm3m
</code></pre>
</div>

<p>Here, the selector is the same as the selector for the replication controller (seen in the
<code class="highlighter-rouge">kubectl describe</code> output, and in a different form in <code class="highlighter-rouge">replication.yaml</code>.  The <code class="highlighter-rouge">--output=jsonpath</code> option
specifies an expression that just gets the name from each pod in the returned list.</p>

<h2 id="writing-a-replication-controller-spec">Writing a Replication Controller Spec</h2>

<p>As with all other Kubernetes config, a Job needs <code class="highlighter-rouge">apiVersion</code>, <code class="highlighter-rouge">kind</code>, and <code class="highlighter-rouge">metadata</code> fields.  For
general information about working with config files, see <a href="/docs/user-guide/simple-yaml/">here</a>,
<a href="/docs/user-guide/configuring-containers/">here</a>, and <a href="/docs/user-guide/working-with-resources/">here</a>.</p>

<p>A Replication Controller also needs a <a href="https://github.com/kubernetes/kubernetes/tree/master/docs/devel/api-conventions.md#spec-and-status"><code class="highlighter-rouge">.spec</code> section</a>.</p>

<h3 id="pod-template">Pod Template</h3>

<p>The <code class="highlighter-rouge">.spec.template</code> is the only required field of the <code class="highlighter-rouge">.spec</code>.</p>

<p>The <code class="highlighter-rouge">.spec.template</code> is a <a href="#pod-template">pod template</a>.  It has exactly
the same schema as a <a href="/docs/user-guide/pods/">pod</a>, except it is nested and does not have an <code class="highlighter-rouge">apiVersion</code> or
<code class="highlighter-rouge">kind</code>.</p>

<p>In addition to required fields for a Pod, a pod template in a Replication Controller must specify appropriate
labels (i.e. don’t overlap with other controllers, see <a href="#pod-selector">pod selector</a>) and an appropriate restart policy.</p>

<p>Only a <a href="/docs/user-guide/pod-states/"><code class="highlighter-rouge">.spec.template.spec.restartPolicy</code></a> equal to <code class="highlighter-rouge">Always</code> is allowed, which is the default
if not specified.</p>

<p>For local container restarts, replication controllers delegate to an agent on the node,
for example the <a href="/docs/admin/kubelet/">Kubelet</a> or Docker.</p>

<h3 id="labels-on-the-replication-controller">Labels on the Replication Controller</h3>

<p>The replication controller can itself have labels (<code class="highlighter-rouge">.metadata.labels</code>).  Typically, you
would set these the same as the <code class="highlighter-rouge">.spec.template.metadata.labels</code>; if <code class="highlighter-rouge">.metadata.labels</code> is not specified
then it is defaulted to  <code class="highlighter-rouge">.spec.template.metadata.labels</code>.  However, they are allowed to be
different, and the <code class="highlighter-rouge">.metadata.labels</code> do not affec the behavior of the replication controller.</p>

<h3 id="pod-selector">Pod Selector</h3>

<p>The <code class="highlighter-rouge">.spec.selector</code> field is a <a href="/docs/user-guide/labels/#label-selectors">label selector</a>.  A replication
controller manages all the pods with labels which match the selector.  It does not distinguish
between pods which it created or deleted versus pods which some other person or process created or
deleted.  This allows the replication controller to be replaced without affecting the running pods.</p>

<p>If specified, the <code class="highlighter-rouge">.spec.template.metadata.labels</code> must be equal to the <code class="highlighter-rouge">.spec.selector</code>, or it will
be rejected by the API.  If <code class="highlighter-rouge">.spec.selector</code> is unspecified, it will be defaulted to
<code class="highlighter-rouge">.spec.template.metadata.labels</code>.</p>

<p>Also you should not normally create any pods whose labels match this selector, either directly, via
another ReplicationController or via another controller such as Job.  Otherwise, the
ReplicationController will think that those pods were created by it.  Kubernetes will not stop you
from doing this.</p>

<p>If you do end up with multiple controllers that have overlapping selectors, you
will have to manage the deletion yourself (see <a href="#updating-a-replication-controller">below</a>).</p>

<h3 id="multiple-replicas">Multiple Replicas</h3>

<p>You can specify how many pods should run concurrently by setting <code class="highlighter-rouge">.spec.replicas</code> to the number
of pods you would like to have running concurrently.  The number running at any time may be higher
or lower, such as if the replicas was just increased or decreased, or if a pod is gracefully
shutdown, and a replacement starts early.</p>

<p>If you do not specify <code class="highlighter-rouge">.spec.replicas</code>, then it defaults to 1.</p>

<h2 id="working-with-replication-controllers">Working with Replication Controllers</h2>

<h3 id="deleting-a-replication-controller-and-its-pods">Deleting a Replication Controller and its Pods</h3>

<p>To delete a replication controller and all its pods, use <a href="/docs/user-guide/kubectl/kubectl_delete/"><code class="highlighter-rouge">kubectl
delete</code></a>.  Kubectl will scale the replication controller to zero and wait
for it to delete each pod before deleting the replication controller itself.  If this kubectl
command is interrupted, it can be restarted.</p>

<p>When using the REST API or go client library, you need to do the steps explicitly (scale replicas to
0, wait for pod deletions, then delete the replication controller).</p>

<h3 id="deleting-just-a-replication-controller">Deleting just a Replication Controller</h3>

<p>You can delete a replication controller without affecting any of its pods.</p>

<p>Using kubectl, specify the <code class="highlighter-rouge">--cascade=false</code> option to <a href="/docs/user-guide/kubectl/kubectl_delete/"><code class="highlighter-rouge">kubectl delete</code></a>.</p>

<p>When using the REST API or go client library, simply delete the replication controller object.</p>

<p>Once the original is deleted, you can create a new replication controller to replace it.  As long
as the old and new <code class="highlighter-rouge">.spec.selector</code> are the same, then the new one will adopt the old pods.
However, it will not make any effort to make existing pods match a new, different pod template.
To update pods to a new spec in a controlled way, use a <a href="#rolling-updates">rolling update</a>.</p>

<h3 id="isolating-pods-from-a-replication-controller">Isolating pods from a Replication Controller</h3>

<p>Pods may be removed from a replication controller’s target set by changing their labels. This technique may be used to remove pods from service for debugging, data recovery, etc. Pods that are removed in this way will be replaced automatically (assuming that the number of replicas is not also changed).</p>

<h2 id="common-usage-patterns">Common usage patterns</h2>

<h3 id="rescheduling">Rescheduling</h3>

<p>As mentioned above, whether you have 1 pod you want to keep running, or 1000, a replication controller will ensure that the specified number of pods exists, even in the event of node failure or pod termination (e.g., due to an action by another control agent).</p>

<h3 id="scaling">Scaling</h3>

<p>The replication controller makes it easy to scale the number of replicas up or down, either manually or by an auto-scaling control agent, by simply updating the <code class="highlighter-rouge">replicas</code> field.</p>

<h3 id="rolling-updates">Rolling updates</h3>

<p>The replication controller is designed to facilitate rolling updates to a service by replacing pods one-by-one.</p>

<p>As explained in <a href="http://issue.k8s.io/1353">#1353</a>, the recommended approach is to create a new replication controller with 1 replica, scale the new (+1) and old (-1) controllers one by one, and then delete the old controller after it reaches 0 replicas. This predictably updates the set of pods regardless of unexpected failures.</p>

<p>Ideally, the rolling update controller would take application readiness into account, and would ensure that a sufficient number of pods were productively serving at any given time.</p>

<p>The two replication controllers would need to create pods with at least one differentiating label, such as the image tag of the primary container of the pod, since it is typically image updates that motivate rolling updates.</p>

<p>Rolling update is implemented in the client tool
<a href="/docs/user-guide/kubectl/kubectl_rolling-update"><code class="highlighter-rouge">kubectl rolling-update</code></a>. Visit <a href="/docs/user-guide/rolling-updates/"><code class="highlighter-rouge">kubectl rolling-update</code> tutorial</a> for more concrete examples.</p>

<h3 id="multiple-release-tracks">Multiple release tracks</h3>

<p>In addition to running multiple releases of an application while a rolling update is in progress, it’s common to run multiple releases for an extended period of time, or even continuously, using multiple release tracks. The tracks would be differentiated by labels.</p>

<p>For instance, a service might target all pods with <code class="highlighter-rouge">tier in (frontend), environment in (prod)</code>.  Now say you have 10 replicated pods that make up this tier.  But you want to be able to ‘canary’ a new version of this component.  You could set up a replication controller with <code class="highlighter-rouge">replicas</code> set to 9 for the bulk of the replicas, with labels <code class="highlighter-rouge">tier=frontend, environment=prod, track=stable</code>, and another replication controller with <code class="highlighter-rouge">replicas</code> set to 1 for the canary, with labels <code class="highlighter-rouge">tier=frontend, environment=prod, track=canary</code>.  Now the service is covering both the canary and non-canary pods.  But you can mess with the replication controllers separately to test things out, monitor the results, etc.</p>

<h3 id="using-replication-controllers-with-services">Using Replication Controllers with Services</h3>

<p>Multiple replication controllers can sit behind a single service, so that, for example, some traffic
goes to the old version, and some goes to the new version.</p>

<p>A replication controller will never terminate on its own, but it isn’t expected to be as long-lived as services. Services may be composed of pods controlled by multiple replication controllers, and it is expected that many replication controllers may be created and destroyed over the lifetime of a service (for instance, to perform an update of pods that run the service). Both services themselves and their clients should remain oblivious to the replication controllers that maintain the pods of the services.</p>

<h2 id="writing-programs-for-replication">Writing programs for Replication</h2>

<p>Pods created by a replication controller are intended to be fungible and semantically identical, though their configurations may become heterogeneous over time. This is an obvious fit for replicated stateless servers, but replication controllers can also be used to maintain availability of master-elected, sharded, and worker-pool applications. Such applications should use dynamic work assignment mechanisms, such as the <a href="https://coreos.com/docs/distributed-configuration/etcd-modules/">etcd lock module</a> or <a href="https://www.rabbitmq.com/tutorials/tutorial-two-python.html">RabbitMQ work queues</a>, as opposed to static/one-time customization of the configuration of each pod, which is considered an anti-pattern. Any pod customization performed, such as vertical auto-sizing of resources (e.g., cpu or memory), should be performed by another online controller process, not unlike the replication controller itself.</p>

<h2 id="responsibilities-of-the-replication-controller">Responsibilities of the replication controller</h2>

<p>The replication controller simply ensures that the desired number of pods matches its label selector and are operational. Currently, only terminated pods are excluded from its count. In the future, <a href="http://issue.k8s.io/620">readiness</a> and other information available from the system may be taken into account, we may add more controls over the replacement policy, and we plan to emit events that could be used by external clients to implement arbitrarily sophisticated replacement and/or scale-down policies.</p>

<p>The replication controller is forever constrained to this narrow responsibility. It itself will not perform readiness nor liveness probes. Rather than performing auto-scaling, it is intended to be controlled by an external auto-scaler (as discussed in <a href="http://issue.k8s.io/492">#492</a>), which would change its <code class="highlighter-rouge">replicas</code> field. We will not add scheduling policies (e.g., <a href="http://issue.k8s.io/367#issuecomment-48428019">spreading</a>) to the replication controller. Nor should it verify that the pods controlled match the currently specified template, as that would obstruct auto-sizing and other automated processes. Similarly, completion deadlines, ordering dependencies, configuration expansion, and other features belong elsewhere. We even plan to factor out the mechanism for bulk pod creation (<a href="http://issue.k8s.io/170">#170</a>).</p>

<p>The replication controller is intended to be a composable building-block primitive. We expect higher-level APIs and/or tools to be built on top of it and other complementary primitives for user convenience in the future. The “macro” operations currently supported by kubectl (run, stop, scale, rolling-update) are proof-of-concept examples of this. For instance, we could imagine something like <a href="http://techblog.netflix.com/2012/06/asgard-web-based-cloud-management-and.html">Asgard</a> managing replication controllers, auto-scalers, services, scheduling policies, canaries, etc.</p>

<h2 id="api-object">API Object</h2>

<p>Replication controller is a top-level resource in the kubernetes REST API. More details about the
API object can be found at: <a href="/docs/api-reference/v1/definitions/#_v1_replicationcontroller">ReplicationController API
object</a>.</p>

<h2 id="alternatives-to-replication-controller">Alternatives to Replication Controller</h2>

<h3 id="replicaset">ReplicaSet</h3>

<p><a href="/docs/user-guide/replicasets/"><code class="highlighter-rouge">ReplicaSet</code></a> is the next-generation Replication Controller that supports the new <a href="/docs/user-guide/labels/#set-based-requirement">set-based label selector</a>.
It’s mainly used by <a href="/docs/user-guide/deployments/"><code class="highlighter-rouge">Deployment</code></a> as a mechanism to orchestrate pod creation, deletion and updates.
Note that we recommend using Deployments instead of directly using Replica Sets, unless you require custom update orchestration or don’t require updates at all.</p>

<h3 id="deployment-recommended">Deployment (Recommended)</h3>

<p><a href="/docs/user-guide/deployments/"><code class="highlighter-rouge">Deployment</code></a> is a higher-level API object that updates its underlying Replica Sets and their Pods
in a similar fashion as <code class="highlighter-rouge">kubectl rolling-update</code>. Deployments are recommended if you want this rolling update functionality, 
because unlike <code class="highlighter-rouge">kubectl rolling-update</code>, they are declarative, server-side, and have additional features.</p>

<h3 id="bare-pods">Bare Pods</h3>

<p>Unlike in the case where a user directly created pods, a replication controller replaces pods that are deleted or terminated for any reason, such as in the case of node failure or disruptive node maintenance, such as a kernel upgrade. For this reason, we recommend that you use a replication controller even if your application requires only a single pod. Think of it similarly to a process supervisor, only it supervises multiple pods across multiple nodes instead of individual processes on a single node.  A replication controller delegates local container restarts to some agent on the node (e.g., Kubelet or Docker).</p>

<h3 id="job">Job</h3>

<p>Use a <a href="/docs/user-guide/jobs/"><code class="highlighter-rouge">Job</code></a> instead of a replication controller for pods that are expected to terminate on their own
(i.e. batch jobs).</p>

<h3 id="daemonset">DaemonSet</h3>

<p>Use a <a href="/docs/admin/daemons/"><code class="highlighter-rouge">DaemonSet</code></a> instead of a replication controller for pods that provide a
machine-level function, such as machine monitoring or machine logging.  These pods have a lifetime is tied
to machine lifetime: the pod needs to be running on the machine before other pods start, and are
safe to terminate when the machine is otherwise ready to be rebooted/shutdown.</p>

<h2 id="for-more-information">For more information</h2>

<p>Read <a href="/docs/user-guide/replication-controller/operations/">Replication Controller Operations</a>.</p>

        <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/user-guide/replication-controller/index.md?pixel" alt="Analytics" /></a>
        <div id="pd_rating_holder_8345992"></div>
		<script type="text/javascript">
	        PDRTJS_settings_8345992 = {
		        "id" : "8345992",
		        "unique_id" : "/docs/user-guide/replication-controller/",
		        "title" : "Replication Controller",
		        "permalink" : "http://kubernetes.github.io/docs/user-guide/replication-controller/"
	        };
	        (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
        </script>
	</div>
</section>

<footer>
	<main class="light-text">
		<nav>
			<a href="/docs/hellonode/">Get Started</a>
			<a href="/docs/">Documentation</a>
			<a href="http://blog.kubernetes.io/">Blog</a>
			<a href="/community/">Community</a>
		</nav>
		<div class="social">
			<div>
				<a href="https://twitter.com/kubernetesio" class="twitter"><span>twitter</span></a>
				<a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
				<a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
			</div>
			<div>
				<a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
				<a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
				<a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
			</div>
			<div>
				<span>I wish this page</span>
				<input type="text" id="wishField" name="wishField" placeholder="enter your wish">
			</div>
		</div>
		<div id="miceType" class="center">&copy; 2016 Kubernetes</div>
	</main>
</footer>


<button class="flyout-button" onclick="kub.toggleToc()"></button>

<style>
	.cse .gsc-control-cse, .gsc-control-cse, {
		padding: 0;
	}
	.gsc-control-cse table, .gsc-control-cse-en table {
		margin:0px !important;
	}

	.gsc-above-wrapper-area {
		border-bottom: 0;
	}
</style>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36037335-10', 'auto');
  ga('send', 'pageview');
</script>
<!-- Commenting out AnswerDash for now; we need to work on our list of questions/answers/design first
<!-- Start of AnswerDash script <script>var AnswerDash;!function(e,t,n,s,a){if(!t.getElementById(s)){var i,r=t.createElement(n),c=t.getElementsByTagName(n)[0];e[a]||(i=e[a]=function(){i.__oninit.push(arguments)},i.__oninit=[]),r.type="text/javascript",r.async=!0,r.src="https://p1.answerdash.com/answerdash.min.js?siteid=756",r.setAttribute("id",s),c.parentNode.insertBefore(r,c)}}(window,document,"script","answerdash-script","AnswerDash");</script> <!-- End of AnswerDash script -->
</body>
</html>
